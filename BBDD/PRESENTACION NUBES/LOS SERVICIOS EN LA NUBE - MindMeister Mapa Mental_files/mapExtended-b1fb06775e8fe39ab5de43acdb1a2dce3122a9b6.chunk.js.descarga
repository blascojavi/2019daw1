/*! For license information please see mapExtended-b1fb06775e8fe39ab5de43acdb1a2dce3122a9b6.chunk.js.LICENSE */
(window.webpackJsonp=window.webpackJsonp||[]).push([[201,2,124,213,218,222],{"+c4W":function(e,t,n){var o=n("711d"),i=n("4/ic"),r=n("9ggG"),s=n("9Nap");e.exports=function(e){return r(e)?o(s(e)):i(e)}},"/9aa":function(e,t,n){function o(e){return(o="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var i=n("NykK"),r=n("ExA7"),s="[object Symbol]";e.exports=function(e){return"symbol"==o(e)||r(e)&&i(e)==s}},"/Fw/":function(e,t,n){e.exports=n.p+"ce89a0f6a13a86dfe2875097a1c0a403.png"},"0JQy":function(e,t){var n="[\\ud800-\\udfff]",o="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",i="\\ud83c[\\udffb-\\udfff]",r="[^\\ud800-\\udfff]",s="(?:\\ud83c[\\udde6-\\uddff]){2}",a="[\\ud800-\\udbff][\\udc00-\\udfff]",l="(?:"+o+"|"+i+")"+"?",c="[\\ufe0e\\ufe0f]?"+l+("(?:\\u200d(?:"+[r,s,a].join("|")+")[\\ufe0e\\ufe0f]?"+l+")*"),u="(?:"+[r+o+"?",o,s,a,n].join("|")+")",f=RegExp(i+"(?="+i+")|"+u+c,"g");e.exports=function(e){return e.match(f)||[]}},"0ZTe":function(e,t,n){var o=n("wy8a"),i=n("quyA"),r=n("Em2t"),s=n("dt0z");e.exports=function(e){return function(t){t=s(t);var n=i(t)?r(t):void 0,a=n?n[0]:t.charAt(0),l=n?o(n,1).join(""):t.slice(1);return a[e]()+l}}},"0qNx":function(e,t,n){"use strict";(function(e,o){var i=n("17x9"),r=n.n(i);function s(e){return(s="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var f="above",p="inside",h="below",d="invisible",m={threshold:r.a.number,onEnter:r.a.func,onLeave:r.a.func,onPositionChange:r.a.func,fireOnRapidScroll:r.a.bool,scrollableAncestor:r.a.any},v=function(t){function n(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(t=function(e,t){return!t||"object"!==s(t)&&"function"!==typeof t?c(e):t}(this,l(n).call(this,e)))._handleScroll=t._handleScroll.bind(c(t)),t}var i,r,d;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(n,t),i=n,(r=[{key:"UNSAFE_componentWillMount",value:function(){if(this.props.scrollableParent)throw new Error("The `scrollableParent` prop has changed name to `scrollableAncestor`.")}},{key:"componentDidMount",value:function(){n.getWindow()&&(this.scrollableAncestor=this._findScrollableAncestor(),this.scrollableAncestor.addEventListener("scroll",this._handleScroll))}},{key:"componentDidUpdate",value:function(){n.getWindow()&&this._handleScroll(null)}},{key:"componentWillUnmount",value:function(){n.getWindow()&&(this.scrollableAncestor&&this.scrollableAncestor.removeEventListener("scroll",this._handleScroll),window.removeEventListener("resize",this._handleScroll))}},{key:"_findScrollableAncestor",value:function(){if(this.props.scrollableAncestor)return this.props.scrollableAncestor;for(var e=o.findDOMNode(this);e.parentNode;)if((e=e.parentNode)!==document&&e!==document.documentElement){var t=window.getComputedStyle(e),n=t.getPropertyValue("overflow-y")||t.getPropertyValue("overflow");if("auto"===n||"scroll"===n)return e}return window}},{key:"_handleScroll",value:function(e){var t=this._currentPosition(),n=this._previousPosition||null;if(this._previousPosition=t,n!==t){var o={currentPosition:t,previousPosition:n,event:e};this.props.onPositionChange.call(this,o),t===p?this.props.onEnter.call(this,o):n===p&&this.props.onLeave.call(this,o);var i=n===h&&t===f,r=n===f&&t===h;this.props.fireOnRapidScroll&&(i||r)&&(this.props.onEnter.call(this,{currentPosition:t,previousPosition:n,event:e}),this.props.onLeave.call(this,{currentPosition:t,previousPosition:p,event:e}))}}},{key:"_currentPosition",value:function(){var e,t,i=o.findDOMNode(this).getBoundingClientRect().top;this.scrollableAncestor===window?(e=window.innerHeight,t=0):(e=this.scrollableAncestor.offsetHeight,t=o.findDOMNode(this.scrollableAncestor).getBoundingClientRect().top);var r=e*this.props.threshold,s=t+e;return 0===e?n.invisible:t<=i+r&&i-r<=s?n.inside:s<i-r?n.below:i+r<t?n.above:n.invisible}},{key:"render",value:function(){return e.createElement("span",{style:{fontSize:0}})}}])&&a(i.prototype,r),d&&a(i,d),n}(e.Component);v.propTypes=m,v.above=f,v.below=h,v.inside=p,v.invisible=d,v.getWindow=function(){if("undefined"!==typeof window)return window},v.defaultProps={threshold:0,onEnter:function(){},onLeave:function(){},onPositionChange:function(){},fireOnRapidScroll:!0},v.displayName="Waypoint",t.a=v}).call(this,n("q1tI"),n("i8i4"))},"16Al":function(e,t,n){"use strict";var o=n("WbBG");function i(){}function r(){}r.resetWarningCache=i,e.exports=function(){function e(e,t,n,i,r,s){if(s!==o){var a=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw a.name="Invariant Violation",a}}function t(){return e}e.isRequired=e;var n={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:r,resetWarningCache:i};return n.PropTypes=n,n}},"17x9":function(e,t,n){e.exports=n("16Al")()},"1Gbl":function(e,t,n){"use strict";(function(e){n("MGzD");var o=n("UrGD"),i=n("lLo4"),r=n("X7v8"),s=n("x6O/");function a(e){return(a="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var p=function(t){function n(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t=function(e,t){return!t||"object"!==a(t)&&"function"!==typeof t?u(e):t}(this,c(n).call(this,e)),s.default.getOlderMessages(t.props.userID),t.state={open:!1},t.markAsRead=t.markAsRead.bind(u(t)),t.setOpen=t.setOpen.bind(u(t)),t.setClosed=t.setClosed.bind(u(t)),t.update=t.update.bind(u(t)),t}var p,h,d;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(n,t),p=n,(h=[{key:"markAsRead",value:function(){s.default.markAsRead(this.props.userID)}},{key:"setOpen",value:function(){this.setState({open:!0}),this.markAsRead()}},{key:"setClosed",value:function(){this.setState({open:!1})}},{key:"update",value:function(){s.default.getUnreadMessages(this.props.userID).length>0&&this.state.open&&(this.markAsRead(),this.widget.onNewMessage()),this.forceUpdate()}},{key:"componentDidMount",value:function(){App.subscribe(CustomEvents.CHAT_UPDATE+"_"+this.props.userID,this.update)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.props.userID!==e.userID&&(s.default.getOlderMessages(e.userID),App.unsubscribe(CustomEvents.CHAT_UPDATE+"_"+this.props.userID,this.update),App.subscribe(CustomEvents.CHAT_UPDATE+"_"+e.userID,this.update))}},{key:"componentWillUnmount",value:function(){App.unsubscribe(CustomEvents.CHAT_UPDATE+"_"+this.props.userID,this.update),s.default.getOlderMessages(this.props.userID)}},{key:"render",value:function(){var t=this,n=s.default.getChat(this.props.userID),a=s.default.getUnreadMessages(this.props.userID).length;return e.createElement(i.a,{position:"above",canAutoPosition:!1,className:"p-0",onShow:this.setOpen,onClose:this.setClosed,disabled:!this.props.enabled,opener:e.createElement(r.a,{unread:a,userId:this.props.userID,className:"mh-4",enabled:this.props.enabled})},e.createElement(o.a,{ref:function(e){return t.widget=e},messages:n.messages,userID:this.props.userID}))}}])&&l(p.prototype,h),d&&l(p,d),n}(e.Component);t.a=p}).call(this,n("q1tI"))},"2Dbh":function(e,t,n){"use strict";var o=n("Ddwv"),i=n.n(o);function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var a=function(e){e.preventDefault(),e.stopPropagation(),MM.ui.dialogs.dialogBrowserFeatureSupport({chrome:{version:43},firefox:{version:41},safari:{version:10},opera:{version:30},ie:{}})};t.a=function(e,t){t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(n,!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({rel:I18n.t("js.copied")},t);var n=new i.a(e,t);return n.on("success",(function(e){e.clearSelection();var n=e.trigger.textContent;t.target?n!==t.rel&&(e.trigger.textContent=t.rel,setTimeout((function(){e.trigger.textContent=n}),1e3)):t.onSuccess&&t.onSuccess()})),n.on("error",(function(e){if(t.target){var n=e.trigger,o=MM.ua.isPlatform("Macintosh")?"&#8984;":"CTRL",i=n.textContent,r="Press "+o+"-C to copy";i!==r&&(n.innerHTML=r,Event.observeOnce(t.target(),"blur",(function(){n.textContent=i})))}else t.text()&&function(e){var t=MM.ua.isPlatform("Macintosh")?"&#8984;":"CTRL",n="copy-input-"+(new Date).getTime(),o="copy-hint-"+(new Date).getTime();Dialog.alert("<h2>"+I18n.t("js.copying_not_supported")+"</h2><p>"+I18n.t("js.your_browser_does_not_support_this_feature")+" "+I18n.t("js.please_select_the_field_below_and_use_s_for_copying",{v0:"<kbd>"+t+"</kbd> + <kbd>C</kbd>"})+'</p><div column><p><input type="text" id="'+n+'" class="w-100%" onclick="this.select();" readonly value="'+e+'" /></p><p class="fs-s c-grey500">'+I18n.t("js.hint")+": "+I18n.t("js.click_here_for_supported_browsers",{v0:'<a href="#" id="'+o+'">',v1:"</a>"})+"</p></div>",{buttonClass:"button default",okLabel:I18n.t("js.done_lower").capitalize(),windowParameters:{width:400,onShow:function(){mm$(n).select(),mm$(o).onclick=a}}})}(t.text())})),n}},"2L+8":function(e,t,n){"use strict";(function(e){function o(e){return(o="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function r(e){return(r=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}n.d(t,"a",(function(){return l}));var l=function(t){function n(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(t=function(e,t){return!t||"object"!==o(t)&&"function"!==typeof t?s(e):t}(this,r(n).call(this,e)))._handleClick=t._handleClick.bind(s(t)),t._handleMouseDown=t._handleMouseDown.bind(s(t)),t}var l,c,u;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(n,t),l=n,(c=[{key:"_handleClick",value:function(e){this.props.onClick&&(e.preventDefault(),e.stopPropagation(),this.props.onClick(e))}},{key:"_handleMouseDown",value:function(e){this.props.onMouseDown&&(e.preventDefault(),e.stopPropagation(),this.props.onMouseDown(e))}},{key:"render",value:function(){return e.createElement("div",{id:this.props.id,style:this.props.style,className:this.props.className,title:this.props.title,onClick:this._handleClick,onMouseDown:this._handleMouseDown,dangerouslySetInnerHTML:{__html:MM.ui.icon(this.props.opts)}})}}])&&i(l.prototype,c),u&&i(l,u),n}(e.Component)}).call(this,n("q1tI"))},"39z+":function(e,t,n){"use strict";function o(e){return(o="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return s}));var i=Class.create({initialize:function(e,t){this.options=Object.extend({showEffect:Effect.Appear,hideEffect:Effect.Fade,closeOnSelect:!0,autoClose:!0,autoPositioning:!0,observeEvent:"click",offset:[0,0],useEffects:!0,propagateEvents:!1,noKeymap:!1},t),this.parent=this.options.parent||$("popover_"+e),this.arrow=new Element("span",{class:"arrow"}),this.parent.insert(this.arrow),this.opener=this.options.opener||$("btn_"+e),this.field=$("fld_"+e),hasClassName(this.parent,"loading")&&(this.loadingSpinner=MM.ui.LoadingSpinner(48),this.parent.insert(this.loadingSpinner)),i.all.push(this),this.options.useEffects&&(this.parent.style.opacity=0),this.keymap=new MM.utils.KeyMap(document,"keymap_"+this.parent.id,[{key:MM.utils.KeyEvent.ESC,fn:this.close.bind(this)}]),this.keymap.disable(),this.opener&&"none"!=this.options.observeEvent&&(this.openerListener=this.togglePopover.bindAsEventListener(this),this.opener.observe(this.options.observeEvent,this.openerListener))},togglePopover:function(e){this.parent.visible()?this.close(e):this.show(e)},show:function(e){clearTimeout(this.closeTimeout);var t=!0;if(this.options.onBeforeShow){var n=this.options.onBeforeShow(e);t="undefined"===typeof n||n}if(t){if(this.opener){if(this.opener.className.indexOf("disabled")>-1)return;this.opener.addClassName("active")}this.field&&this.field.addClassName("selected"),this.parent.show(),e&&e.stop&&e.stop(),this.options.autoClose&&(i.closeOpenPopover(e,this),i.opened.push(this)),this.options.onShow&&this.options.onShow(),this.focusCanvasOnClose=!1,this.options.noKeymap||("undefined"!==typeof canvas&&canvas&&canvas.hasFocus&&(canvas.removeFocus(),this.focusCanvasOnClose=!0),this.keymap.enable()),document.observe("click",this.clickListener),"mouseover"==this.options.observeEvent&&this.opener.observe("mouseout",this.openerListener),UI.Registry.add(this),UI.Registry.notify(this,"show"),this.options.useEffects&&(this.parent.style.opacity=1)}},close:function(e){var t=this;this.opener&&this.opener.className.indexOf("tk_label")<0&&this.opener.removeClassName("active"),this.field&&this.field.removeClassName("selected"),this.keymap&&this.keymap.disable(),i.remove(this,this.focusCanvasOnClose),this.options.useEffects?(this.parent.style.opacity=0,this.closeTimeout=setTimeout((function(){return t.doClose()}),300)):this.doClose(),e&&e.stop&&e.stop(),this.options.onClose&&this.options.onClose(),document.stopObserving("click",this.clickListener),UI.Registry.notify(this,"hide"),UI.Registry.remove(this)},doClose:function(){this.parent.hide(),this.parent._clearAbove&&this.parent.removeClassName("above"),this.options.onHide&&this.options.onHide()},dispose:function(){"none"!=this.options.observeEvent&&(this.opener.stopObserving("mouseout",this.openerListener),this.opener.stopObserving("click",this.openerListener)),document.stopObserving("click",this.clickListener)},register:function(){this.opener.observe(this.options.observeEvent,this.openerListener),"mouseover"==this.options.observeEvent&&this.opener.observe("mouseout",this.openerListener)},onResize:function(){this.sizeAndPosition()},sizeAndPosition:function(e){MM.ui.positionPopover(this,{correction:e})},hasDataHandler:function(e){if(this.isInPopover(e))return"false"===getDataSet(e,"handler")||this.hasDataHandler(e.parentNode)},isInPopover:function(e){for(;e.parentNode&&e.id!=this.parent.id;)e=e.parentNode;return e.id==this.parent.id},isOpener:function(e){if(!this.opener)return!1;for(;e.parentNode&&e!=this.opener;)e=e.parentNode;return e.id==this.opener.id},onDocumentClick:function(e){var t=Event.element(e);if("path"!=t.tagName&&"shape"!=t.tagName)if((this.isInPopover(t)||this.isOpener(t))&&("input"!=t.tagName.toLowerCase()||t.type&&"text"==t.type)){if(!this.hasDataHandler(t)){this.handler&&e.stop();var n=null;if(this.popover)n=this.popover.isPopoverEntry(t);else if(this.popovers){n=null;for(var o=this.popovers.length;o>0&&!n;)o--,n=this.popovers[o].isPopoverEntry(t)}return n?(this.options.closeOnSelect&&this.close(e),n):null}this.close()}else this.close()},destroy:function(){this.dispose(),this.keymap&&(this.keymap.disable(),this.keymap=null),this.arrow.remove(),i.all.remove(this)}});i.opened=[],i.closeOpenPopover=function(e,t){var n=i.getLastOpened();n&&(n._close?n._close():n.isInPopover(t.parent)||n.close(e))},i.getLastOpened=function(){return i.opened[i.opened.length-1]},i.all=[],i.remove=function(e,t){i.opened=i.opened.without(e),t&&"undefined"!==typeof canvas&&canvas&&0===i.opened.length&&canvas.addFocus()},i.get=function(e){return i.all.detect((function(t){return t.parent.id=="popover_"+e}))};var r=Class.create(i,{initialize:function($super,e,t,n){$super(e,n),this.handler=t,this.popover=new a(this.parent,this.handler,this.options),n&&n.multiselect&&(this.popover.multiselect=!0),this.clickListener=this.onDocumentClick.bindAsEventListener(this),this.keymap.addBinding([{key:MM.utils.KeyEvent.ENTER,fn:this.onKeySelect.bindAsEventListener(this)},{key:MM.utils.KeyEvent.UP,fn:this.onKeyNavigate.bind(this,-1)},{key:MM.utils.KeyEvent.DOWN,fn:this.onKeyNavigate.bind(this,1)}])},addElements:function(e){this.loadingSpinner&&this.loadingSpinner.remove(),this.popover.addElements(e)},removeElements:function(){this.popover.removeElements(),this.index=-1},loadElements:function(e,t){this.popover.loadElements(e,t)},getElements:function(){return this.popover.elements},onDocumentClick:function($super,e){var t=$super(e);t&&!this.options.propagateEvents&&this.popover.onElementClicked(t,e)&&e&&e.stop()},show:function($super,e){$super(e),this.clearKeySelection()},close:function($super,e){$super(e)},onKeySelect:function(e){if(-1!=this.index&&this.handler){var t=this.getElements()[this.index].firstChild;if(!t||hasClassName(t,"disabled"))return;this.handler(t.id,e),this.options.closeOnSelect&&this.close(e)}e&&Event.stop(e)},onKeyNavigate:function(e){var t=this.getElements().findAll((function(e){return _Element.visible(e)}));t[this.index]&&(removeClassName(t[this.index],"selected"),removeClassName(t[this.index],"key-selected")),this.index+=e,this.index<0?this.index=t.length-1:this.index>t.length-1&&(this.index=0),t[this.index]&&(hasClassName(t[this.index],"js-noselect")?this.onKeyNavigate(e):(addClassName(t[this.index],"selected"),addClassName(t[this.index],"key-selected"),this.popover.scrollToElement(t[this.index])))},clearKeySelection:function(){this.getElements().each((function(e){hasClassName(e,"key-selected")&&(removeClassName(e,"selected"),removeClassName(e,"key-selected"))})),this.index=-1}}),s=(Class.create(r,{initialize:function($super,e,t,n){this.onSelectElement=t,$super(e,this.onSelect.bind(this),n)},onSelect:function(e){this.onSelectElement&&this.onSelectElement(e),this.select(e)},select:function(e){var t=$(e).clone(!0);t.id="",(this.opener.select("span").length>0?this.opener.select("span")[0]:this.opener).update(t)}}),Class.create(i,{initialize:function($super,e,t){$super(e,t),this.clickListener=this.onDocumentClick.bindAsEventListener(this),this.widgetContainer=new Element("div"),this.parent.appendChild(this.widgetContainer)},onDocumentClick:function(e){if(i.getLastOpened()===this){var t=Event.element(e);Element.ancestors(t).include(this.parent)&&!e.closePopover||this.close()}}})),a=Class.create({multiselect:!1,initialize:function(e,t,n){this.parent=e,this.handler=t,this.options=n,this.elements=[]},loadElements:function(e,t){new Ajax.Request(e,{onSuccess:function(e){var n=e.responseText.evalJSON();this.addElements(n),this.parent.removeClassName("loading"),t&&t()}.bind(this)})},parseElements:function(){this.list=this.parent.select("ul")[0],this.listContainer=this.list.parentNode,this.elements=this.list.select("li")},addElements:function(e){this.listContainer=this.listContainer||new Element("div"),this.list=this.list||new Element("ul"),this.listContainer.appendChild(this.list),this.parent.appendChild(this.listContainer);for(var t=0,n=e.length;t<n;t++)this.addElement(e[t]);this.parent.hasClassName("submenus")&&this.bindSubItems(),this.setupItemTooltips()},addElement:function(e){var t=new Element("li");Object.isElement(e)?t.appendChild(e):t.update(e),this.elements.push(t),this.list.appendChild(t),hasClassName(t.firstDescendant(),"js-noselect")&&addClassName(t,"js-noselect")},moveElement:function(e){this.parent.insert(e,{bottom:this.parent}),e.show()},removeElements:function(){this.list&&(this.list.remove(),this.list=null,this.listContainer.remove(),this.listContainer=null,this.elements=[],this.tooltips&&(MM.ui.ToolTips.destroyTouchSafe(this.tooltips),this.tooltips=null))},removeElement:function(e){for(var t=0;t<this.list.childElements().length&&this.list.childElements()[t].firstDescendant().id!=e;)t++;t<this.list.childElements().length&&this.list.childElements()[t].remove()},onElementClicked:function(e,t){return!!hasClassName(e,"disabled")||"object"==o(e)&&"input"!==e.tagName.toLowerCase()&&(this.parent.hasClassName("menu")||(this.multiselect?-1!=e.parentNode.className.indexOf("selected")?removeClassName(e.parentNode,"selected"):addClassName(e.parentNode,"selected"):(this.elements.each((function(e){removeClassName(e,"selected")})),addClassName(e.parentNode,"selected"))),this.handler&&this.handler(e.id,t),!0)},setTitle:function(e,t){var n=new Element("div",{class:"header "+(t||"")});t&&(n.className=t+" ib"),n.update(e),this.parent.insert({top:n})},setTextContent:function(e){var t=new Element("p");t.update(e),this.parent.appendChild(t)},isPopoverEntry:function(e){if(this.elements.length>0){for(;e.parentNode&&"LI"!=e.parentNode.tagName;)e=e.parentNode;return e.parentNode&&(-1!=this.elements.indexOf(e.parentNode)||this.isSubItemEntry(e.parentNode))?e:null}if(Element.ancestors(e).include(this.parent))return e},isSubItemEntry:function(e){return e.parentNode.hasClassName("popover")},bindSubItems:function(){this.parent.select("li > a").each(function(e){e.observe("mouseover",this.onHoverItem.bind(this,e))}.bind(this))},onHoverItem:function(e){if(-1==e.className.indexOf("disabled")&&(this.parent.select("ul.submenu").each((function(t){t.descendantOf(e)||e.descendantOf(t)||t.hide()})),hasClassName(e,"subitem"))){var t=e.getWidth(),n=e.down(".submenu");n.setStyle({top:"-1px",left:t-2+"px"}).show(!0),Element.cumulativeOffset(n)[0]+n.getWidth()>MM.ui.page.width&&n.setStyle({left:2-n.getWidth()+"px"})}},scrollToElement:function(e){e.offsetTop+e.getHeight()>this.list.getHeight()?this.list.scrollTop=e.offsetTop+e.getHeight()-this.list.getHeight():e.offsetTop<this.list.scrollTop&&(this.list.scrollTop=e.offsetTop)},setupItemTooltips:function(){if(this.options.tooltips){var e=Object.extend({el:this.list},this.options.tooltips);this.tooltips=MM.ui.ToolTips.touchSafe(e)}}})},"4/ic":function(e,t,n){var o=n("ZWtO");e.exports=function(e){return function(t){return o(t,e)}}},"44Ds":function(e,t,n){var o=n("e4Nc"),i="Expected a function";function r(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError(i);var n=function n(){var o=arguments,i=t?t.apply(this,o):o[0],r=n.cache;if(r.has(i))return r.get(i);var s=e.apply(this,o);return n.cache=r.set(i,s)||r,s};return n.cache=new(r.Cache||o),n}r.Cache=o,e.exports=r},"4AML":function(e,t,n){"use strict";n.r(t);var o=n("PYYe"),i=n.n(o),r=n("TxdS"),s=n("CJ9X"),a={init:function(){MM.ua.isMobile||(this._pasteGhost||this.__createPasteGhost(),this.setupPastingAreaListener=this.setupPastingArea.bind(this),this.onCopyHandlerListener=this.onCopyHandler.bind(this),this.onCutHandlerListener=this.onCutHandler.bind(this),this.onPasteHandlerListener=this.onPasteHandler.bind(this))},enable:function(){MM.ua.isMobile||(document.observe("keydown",this.setupPastingAreaListener),document.observe("copy",this.onCopyHandlerListener),document.observe("cut",this.onCutHandlerListener),document.observe("paste",this.onPasteHandlerListener))},disable:function(){MM.ua.isMobile||(document.stopObserving("keydown",this.setupPastingAreaListener),document.stopObserving("copy",this.onCopyHandlerListener),document.stopObserving("cut",this.onCutHandlerListener),document.stopObserving("paste",this.onPasteHandlerListener))},setupPastingArea:function(e){var t=e.target.tagName;!canvas.hasFocus||!canvas.selected||canvas.selected.dcontent.isEditing()||["LABEL","INPUT"].indexOf(t)>=0||(this._pasteGhost.focus(),this._pasteGhost.innerHTML=" ",window.getSelection().selectAllChildren(this._pasteGhost))},onCopyHandler:function(e){canvas.hasFocus&&canvas.selected&&!canvas.selected.dcontent.isEditing()&&(this.onCopy(e),e.stop())},onCutHandler:function(e){canvas.hasFocus&&canvas.selected&&!canvas.selected.dcontent.isEditing()&&(this.onCut(e),e.stop())},onPasteHandler:function(e){var t=this;if(canvas.hasFocus&&canvas.selected&&!canvas.selected.dcontent.isEditing()){var n=e.clipboardData||window.clipboardData,o=n.items;if(n.types&&n.types.indexOf&&n.types.indexOf("public.tiff")>=0&&n.types.indexOf("public.url")>=0)return e.stop(),Message.show(I18n.t("js.feature_not_supported_in_this_browser",{browsers:"Google Chrome, Firefox, Opera "+I18n.t("js.or")+" Internet Explorer"}),Message.INFO);if(o){for(var i=0,r=o.length;i<r;i++){var s=o[i];if(s.type.indexOf("image")>=0){this.__onBeforePasteImage(s.getAsFile());break}if("text/plain"===s.type){this.onPaste(e);break}}e.stop()}else setTimeout((function(){t._pasteGhost.select("p").length>0&&function(e){for(var t=e.select("p"),n="",o=0,i=t.length;o<i;o++)n+=t[o].textContent+"\n";e.innerHTML=n}(t._pasteGhost);var n=t._pasteGhost.childNodes[0];if(n)switch(n.nodeName){case"IMG":case MM.ua.isBrowser("Safari")?"A":"":var o=n.src||n.href;if(e.stop(),o.indexOf("webkit-fake-url")>=0)return Message.show(I18n.t("js.feature_not_supported_in_this_browser",{browsers:"Google Chrome, Firefox, Opera "+I18n.t("js.or")+" Internet Explorer"}),Message.INFO);t.__pasteImageFromBase64(o)||t.__checkPastedImageUrl(o);break;default:t.onPaste(e),e.stop()}}),0)}},onCut:function(e){if(!canvas.selected)return Message.show(I18n.t("js.must_select_something_first"),Message.NOTICE);var t=canvas.allSelected.without(canvas.root);if(0===t.length)return Message.show(I18n.t("js.cant_cut_root_node"),Message.NOTICE);this.__resetCutTopics(),this.cut=t.map((function(e){return e.node.id})),this.setClipboardData(e,this.__createClipboardDataString(t)),t.each((function(e){new Effect.Opacity(e.dcontainer.el,{from:1,to:.5})}))},onCopy:function(e){if(!canvas.selected)return Message.show(I18n.t("js.must_select_something_first"),Message.NOTICE);this.__resetCutTopics(),this.setClipboardData(e,this.__createClipboardDataString(canvas.allSelected))},onPaste:function(e){if(!canvas.selected)return Message.show(I18n.t("js.must_select_destination"),Message.NOTICE),!1;var t=this.getClipboardData(e);if(t.empty())return Message.show(I18n.t("js.pasted_invalid_content"),Message.WARNING),!1;if(this.isPastingTopics(t))this.onPasteTopics(t);else{if(sideBar&&sideBar.videos){var n=Object(s.checkLink)(t);if(n.video&&n.source)return void sideBar.videos.createVideoFromLink(n,function(e){Tree.utils.setVideo(e,canvas.allSelected.map((function(e){return e.node}))),canvas.highlightTopics()}.bind(this))}if(this.__pasteImageFromBase64(t))return;if(t.toLink()!==t)return void this.__checkPastedImageUrl(t);canvas.onAdd(),App.trigger(CustomEvents.SIMULATE_TOPIC_PASTED,{clipboardData:t})}},isPastingTopics:function(e){return/mm_id:\s+(-)?\d+/.test(e)},onPasteTopics:function(e){var t=!1,n=[];if(e.replace(/^(x|c)(.*)/,function(e,n,o){return t="x"===n,o.replace(/mm_id:\s+/g,"")}.bind(this)).split(",").map((function(e){e=parseInt(e),isNaN(e)||n.push(e)})),this.cut=t&&n.length>0?n:null,0===n.length)return Message.show(t?I18n.t("js.node_cut_unavailable"):I18n.t("js.node_copied_unavailable"),Message.NOTICE),!1;this.pasteTopics(n)},pasteTopics:function(e){var t=!e.any((function(e){return!tree.root.getVisibleChild(e)})),n=canvas.selected.node;if(!t)return this.cut&&Message.show(I18n.t("js.please_note_manually_delete_topics_in_original_map"),Message.NOTICE),ServerConnection.copyExternal(n.id,e);var o=e.map((function(e){return tree.root.getChild(e)}));if(this.cut){var i=[];o.each((function(e){new Effect.Opacity(e._listener.dcontainer.el,{from:.5,to:1}),n.isChildOrSelf(e)?Message.show(I18n.t("js.cant_paste_in_same_tree"),Message.WARNING):n.equals(e.parent)?Message.show(I18n.t("js.ambiguos_action"),Message.WARNING):i.push(e)})),Tree.utils.moveNodes(i,n,n.isRoot()?0:n.children.length)}else this.doPasteTopics(o)},doPasteTopics:function(e){var t=canvas.allSelected.map((function(e){return e.node.id>=0?e.node:e.node.parent}));Tree.utils.copyNodes(e,t),App.trigger(CustomEvents.TOPICS_COPIED,{callback:function(){var e=tree.root.getChild(tree.uncommitedId+1);e&&e._listener.select()}})},onPasteImage:function(e){if(this.tmpCopiedImg){var t={images:[],files:[]};switch(e){case"image":t.images.push(this.tmpCopiedImg);break;case"attachment":t.files.push(this.tmpCopiedImg)}canvas.onFileDrop(canvas.selected.node,t),this.tmpCopiedImg=null}},onPasteStyle:function(){if(this._copied)if(this._copied.length>1)Message.show(I18n.t("js.please_copy_only_one_topic"),Message.NOTICE);else{var e=tree.root.getChild(this._copied[0]);if(e){var t=canvas.allSelected.map((function(e){return e.node}));Tree.utils.setFullStyle(e.currentStyle(),t)}else Message.show(I18n.t("js.node_copied_unavailable"),Message.NOTICE)}},getClipboardData:function(e){var t="";return e.clipboardData&&(t=e.clipboardData.getData("text/plain")),(t.empty()?this._pasteGhost.innerHTML.replace(/<br>/g,"\n").unescapeHTML():t).trim()},getPlainClipboardData:function(e){var t="";return e.clipboardData?t=e.clipboardData.getData("text/plain"):window.clipboardData&&(t=window.clipboardData.getData("Text")),t},setClipboardData:function(e,t){e.clipboardData?e.clipboardData.setData("text/plain",t):window.clipboardData&&window.clipboardData.setData("Text",t)},simulatePaste:function(e){var t=document.createTextNode(e),n=window.getSelection(),o=n.getRangeAt(0);o.deleteContents(),o.insertNode(t),o.setStartAfter(t),n.removeAllRanges(),n.addRange(o)},execCommand:function(e,t){if(!(["copy","cut"].indexOf(e)<0)){t=t||{};var n=!1;try{n=document.execCommand(e)}catch(o){}finally{!n&&t.onError&&t.onError()}}},__createPasteGhost:function(){this._pasteGhost=new Element("div",{id:"paste_ghost"}),this._pasteGhost.contentEditable=!0,document.body.appendChild(this._pasteGhost)},__createClipboardDataString:function(e){this._copied=[];var t=[];return e.each(function(e){var n=e.node.id;this._copied.push(n),t.push("mm_id: "+n)}.bind(this)),(this.cut?"x":"c")+t.join(",")},__resetCutTopics:function(){this.cut&&(this.cut.each((function(e){var t=tree.root.getVisibleChild(e);t&&t._listener.dcontainer.el.getStyle("opacity")<1&&new Effect.Opacity(t._listener.dcontainer.el,{from:.5,to:1})})),this.cut=null)},__pasteImageFromBase64:function(e){if(/^data:image\/(png|jpg|jpeg|gif);base64,/.test(e)){for(var t=e.split(","),n=atob(t[1]),o=t[0].split(";")[0].split(":")[1],i=new ArrayBuffer(n.length),r=new Uint8Array(i),s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return this.__onBeforePasteImage(new Blob([i],{type:o})),!0}},__checkPastedImageUrl:function(e){var t=function(t){if(sideBar&&sideBar.images&&t){var o=new Element("canvas");o.width=n.width,o.height=n.height,o.getContext("2d").drawImage(n,0,0,n.width,n.height),this.__pasteImageFromBase64(o.toDataURL("image/png"))}else Tree.utils.setProperty("link",e,canvas.allSelected.map((function(e){return e.node}))),canvas.highlightTopics(),sideBar&&sideBar.links&&sideBar.links.onSelectNode()}.bind(this),n=new Image;n.onerror=n.onabort=t.bind(this,!1),n.onload=t.bind(this,!0),n.src="/images/download_url?url=".concat(i()(e))},__onBeforePasteImage:function(e){e&&(e.name||(e.name="image.".concat(e.type?e.type.split("/")[1]:"png")),this.tmpCopiedImg=e,r.default.showCustom([new Element("a",{href:"#",id:"btn_menu_copy_as_image"}).update(I18n.t("js.paste_as_image")),new Element("a",{href:"#",id:"btn_menu_copy_as_attachment"}).update(I18n.t("js.paste_as_attachment"))],{opener:canvas.selected.dcontent.el}))}};t.default=a},"4qC0":function(e,t,n){var o=n("NykK"),i=n("Z0cm"),r=n("ExA7"),s="[object String]";e.exports=function(e){return"string"==typeof e||!i(e)&&r(e)&&o(e)==s}},"4sDh":function(e,t,n){var o=n("4uTw"),i=n("03A+"),r=n("Z0cm"),s=n("wJg7"),a=n("shjB"),l=n("9Nap");e.exports=function(e,t,n){for(var c=-1,u=(t=o(t,e)).length,f=!1;++c<u;){var p=l(t[c]);if(!(f=null!=e&&n(e,p)))break;e=e[p]}return f||++c!=u?f:!!(u=null==e?0:e.length)&&a(u)&&s(p,u)&&(r(e)||i(e))}},"4uTw":function(e,t,n){var o=n("Z0cm"),i=n("9ggG"),r=n("GNiM"),s=n("dt0z");e.exports=function(e,t){return o(e)?e:i(e,t)?[e]:r(s(e))}},"5qmN":function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return h}));n("XWJH");var o=n("S2r9");function i(e){return(i="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function a(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var c,u,f,p=[MM.utils.validateEmail],h=function(t){function n(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(t=function(e,t){return!t||"object"!==i(t)&&"function"!==typeof t?a(e):t}(this,s(n).call(this,e))).state={hasError:!1},t.focus=t.focus.bind(a(t)),t.blur=t.blur.bind(a(t)),t.onDelete=t.onDelete.bind(a(t)),t.updateElement=t.updateElement.bind(a(t)),t.onShow=t.onShow.bind(a(t)),t}var c,u,f;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(n,t),c=n,(u=[{key:"getValue",value:function(e){return this.tokensList.getValue(e)}},{key:"focus",value:function(){this.tokenInput.focus(),this.keymap.enable()}},{key:"blur",value:function(){this.tokenize(),this.keymap.disable()}},{key:"verifyInput",value:function(e,t){var n=!0;return p.forEach((function(t){t(e)||(n=!1)})),t&&this.setState({hasError:!n}),n}},{key:"tokenize",value:function(e){var t=this;this.setState({hasError:!1});var n=this.tokenInput.value.strip().replace(/^,/g,"").strip();0!==n.length&&n.split(",").forEach((function(n){n=n.strip(),t.verifyInput(n,e)&&t.addToken(n,n)}))}},{key:"addToken",value:function(e,t,n){var o={label:e,value:t,type:n};this.tokensList.addToken(o),this.tokenInput.value="",this.tokenInput.placeholder=""}},{key:"getTokenCount",value:function(){return this.tokensList.getCount()}},{key:"clear",value:function(){this.tokensList.clear()}},{key:"removeToken",value:function(e){this.tokensList.removeToken(e)}},{key:"onDelete",value:function(e){if(0===e.target.value.length&&this.tokensList.getCount()>0){var t=this.tokensList.state.tokens[this.tokensList.getCount()-1];this.tokensList.removeToken(t)}}},{key:"onShow",value:function(e,t){Position.clone(this.wrapper,t,{setHeight:!1,offsetTop:this.wrapper.offsetHeight}),Effect.Appear(t,{duration:.15})}},{key:"updateElement",value:function(e){var t;e.select(".type").length>0&&(t=Element.collectTextNodes(e.select(".type")[0]));var n=Element.collectTextNodes(e.select(".label")[0]),o=Element.collectTextNodes(e.select(".value")[0]);this.addToken(n,o,t),this.tokenInput.value="",this.setState({hasError:!1})}},{key:"_setupAutoComplete",value:function(){new Ajax.Autocompleter(this.tokenInput,this.userList,"sharing/autocomplete",{minChars:2,frequency:.5,tokens:[",","\\n"],updateElement:this.updateElement,onShow:this.onShow})}},{key:"componentDidMount",value:function(){this.keymap=new MM.utils.KeyMap(document,"tokenizer_keymap",[]),this.keymap.disable();var e=MM.utils.KeyEvent;this.keymap.addBinding([{key:[e.DELETE,e.BACKSPACE],fn:this.onDelete,withEvent:!0,stopEvent:!1},{key:[e.RETURN,188],fn:this.tokenize.bind(this,!0)},{key:e.SPACE,fn:this.tokenize.bind(this,!1),stopEvent:!1}]),this.props.autoComplete&&this._setupAutoComplete()}},{key:"render",value:function(){var t=this,n=this.state.hasError?e.createElement("span",{className:"formError"},I18n.t("js.email_invalid")):null,i=this.props.autoComplete?e.createElement("div",{ref:function(e){return t.userList=e},className:"popover menu autocomplete bs-medium"}):null,r=this.tokensList&&this.getTokenCount()>0?"":this.props.placeholder;return e.createElement("div",null,e.createElement("div",{ref:function(e){return t.wrapper=e},className:"tokenizer",onClick:this.focus},e.createElement(o.a,{ref:function(e){return t.tokensList=e},onRemoveToken:this.focus}),e.createElement("input",{ref:function(e){return t.tokenInput=e},name:"query",type:"text",autoComplete:"off",placeholder:r,onBlur:this.blur}),i),n)}}])&&r(c.prototype,u),f&&r(c,f),n}(e.Component);f={autoComplete:!0},(u="defaultProps")in(c=h)?Object.defineProperty(c,u,{value:f,enumerable:!0,configurable:!0,writable:!0}):c[u]=f}).call(this,n("q1tI"))},"6acW":function(e,t,n){var o=n("dt0z"),i=n("gQMU");e.exports=function(e){return i(o(e).toLowerCase())}},"6r2b":function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return m}));var o=n("Y+p1"),i=n.n(o),r=n("ERGR"),s=n("rW35");function a(e){return(a="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function c(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function u(e,t){return!t||"object"!==a(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var d={left:{left:0,transform:"translateX(-100%)"},right:{right:0,transform:"translateX(100%)"}},m=function(t){function n(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(t=u(this,f(n).call(this,e))).state={orientation:e.orientation},t}var o,a,m;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(n,t),o=n,(a=[{key:"shouldComponentUpdate",value:function(e,t){return!i()(this.state,t)}},{key:"componentDidMount",value:function(){var e=this.container.getBoundingClientRect(),t=document.body.getBoundingClientRect(),n=UI.Registry.viewportOffset,o=this.state.orientation;e.left+e.width<t.width-n.right?o="right":e.left-e.width>n.left&&(o="left"),this.setState({orientation:o})}},{key:"render",value:function(){var t=this,n=this.props,o=n.padding,i=n.selectable,a=n.items,c=this.state.orientation,u=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(n,!0).forEach((function(t){h(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({top:-o},d[c]);return e.createElement("div",{ref:function(e){return t.container=e},className:"bg-white popover sections rad-5 p-a pv-".concat(o),style:u},e.createElement(s.a,null,e.createElement(r.a,{selectable:i,items:a})))}}])&&c(o.prototype,a),m&&c(o,m),n}(e.Component);h(m,"defaultProps",{orientation:"right",padding:15})}).call(this,n("q1tI"))},"711d":function(e,t){e.exports=function(e){return function(t){return null==t?void 0:t[e]}}},"9Nap":function(e,t,n){var o=n("/9aa"),i=1/0;e.exports=function(e){if("string"==typeof e||o(e))return e;var t=e+"";return"0"==t&&1/e==-i?"-0":t}},"9ggG":function(e,t,n){function o(e){return(o="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var i=n("Z0cm"),r=n("/9aa"),s=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,a=/^\w*$/;e.exports=function(e,t){if(i(e))return!1;var n=o(e);return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!r(e))||(a.test(e)||!s.test(e)||null!=t&&e in Object(t))}},AGWK:function(e,t,n){"use strict";(function(e){var n=function(t){var n=t.className,o=t.size,i=t.opts;return e.createElement("div",{className:n,dangerouslySetInnerHTML:{__html:MM.ui.LoadingSpinner(o,i).outerHTML}})};n.defaultProps={className:""},t.a=n}).call(this,n("q1tI"))},AJqD:function(e,t,n){"use strict";(function(e){var o=n("Y+p1"),i=n.n(o),r=n("lLo4");function s(e){return(s="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){if(null==e)return{};var n,o,i=function(e,t){if(null==e)return{};var n,o,i={},r=Object.keys(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function l(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function f(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function p(e,t){return!t||"object"!==s(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var m=function(t){function n(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(t=p(this,h(n).call(this,e))).state=t._initState(t.props),t}var o,s,m;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(n,t),o=n,(s=[{key:"_initState",value:function(e){var t=this._getAllItems(e.children);return{selected:e.selected||t[0],items:t}}},{key:"_getItems",value:function(){var e=this;return this.state.items.map((function(t){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(n,!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},t,{onClick:e._onSelect.bind(e,t),selected:e.props.showSelectedState&&t.value===e.state.selected.value})}))}},{key:"_onSelect",value:function(e,t){e&&!i()(this.state.selected,e)&&(this.setState({selected:e}),this.props.onChange(e))}},{key:"_getAllItems",value:function(t){var n=this,o=[];return e.Children.forEach(t,(function(e){e.props&&(o=[].concat(l(o),l(e.props.items||[]),l(n._getAllItems(e.props.children))))})),o}},{key:"UNSAFE_componentWillMount",value:function(){var e=this.state.selected;this.props.onChange(e)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=this._initState(e);this.setState(t)}},{key:"renderChildren",value:function(t){var n=this;return e.Children.map(t,(function(t){var o={};return t.props.items&&(o={items:n._getItems()}),o.children=n.renderChildren(t.props.children),e.cloneElement(t,o)}))}},{key:"render",value:function(){var t=this.state.selected,n=this.renderChildren(this.props.children),o=(t.className,a(t,["className"])),i=e.cloneElement(this.props.opener,o);return e.createElement("div",{className:"h-flex-row"},e.createElement(r.a,{position:this.props.position,className:"sections "+this.props.className,opener:i,canAutoPosition:this.props.canAutoPosition},n))}}])&&f(o.prototype,s),m&&f(o,m),n}(e.Component);m.defaultProps={position:"bottom",className:"",canAutoPosition:!1,showSelectedState:!0,onChange:function(){}},t.a=m}).call(this,n("q1tI"))},AP2z:function(e,t,n){var o=n("nmnc"),i=Object.prototype,r=i.hasOwnProperty,s=i.toString,a=o?o.toStringTag:void 0;e.exports=function(e){var t=r.call(e,a),n=e[a];try{e[a]=void 0;var o=!0}catch(l){}var i=s.call(e);return o&&(t?e[a]=n:delete e[a]),i}},Aw6l:function(e,t,n){"use strict";(function(e){function n(e){return(n="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function i(e,t){return!t||"object"!==n(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function r(e){return(r=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var a=function(t){function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),i(this,r(n).apply(this,arguments))}var a,l,c;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(n,t),a=n,(l=[{key:"_initTooltip",value:function(){this.tooltip=MM.ui.ToolTips.touchSafe({el:this.el})}},{key:"componentDidMount",value:function(){this._initTooltip()}},{key:"componentDidUpdate",value:function(){this._initTooltip()}},{key:"componentWillUnmount",value:function(){MM.ui.ToolTips.destroyTouchSafe(this.tooltip)}},{key:"render",value:function(){var t=this,n=this.props.user.getAvatar(this.props.className,this.props.fullSize,this.props.tooltip);return e.createElement("div",{ref:function(e){return t.el=e},dangerouslySetInnerHTML:{__html:n}})}}])&&o(a.prototype,l),c&&o(a,c),n}(e.Component);t.a=a}).call(this,n("q1tI"))},BIRy:function(e,t,n){(e.exports=n("JPst")(!0)).push([e.i,'@font-face{font-family:\'Avenir\';font-weight:300;src:local("Avenir Light"),local("Avenir-Light"),url("/fonts/Avenir/Light.woff2") format("woff2"),url("/fonts/Avenir/Light.woff") format("woff")}@font-face{font-family:\'Avenir\';font-weight:400;src:local("Avenir Book"),local("Avenir-Book"),url("/fonts/Avenir/Book.woff2") format("woff2"),url("/fonts/Avenir/Book.woff") format("woff")}@font-face{font-family:\'Avenir\';font-weight:500;src:local("Avenir Medium"),local("Avenir-Medium"),url("/fonts/Avenir/Medium.woff2") format("woff2"),url("/fonts/Avenir/Medium.woff") format("woff")}@font-face{font-family:\'Avenir\';font-weight:700;src:local("Avenir Heavy"),local("Avenir-Heavy"),url("/fonts/Avenir/Heavy.woff2") format("woff2"),url("/fonts/Avenir/Heavy.woff") format("woff")}@font-face{font-family:\'Avenir\';font-weight:900;src:local("Avenir Black"),local("Avenir-Black"),url("/fonts/Avenir/Black.woff2") format("woff2"),url("/fonts/Avenir/Black.woff") format("woff")}@font-face{font-family:\'Avenir Next\';font-weight:300;src:local("Avenir Next Light"),local("AvenirNext-Light"),url("/fonts/AvenirNext/Light.woff2") format("woff2"),url("/fonts/AvenirNext/Light.woff") format("woff")}@font-face{font-family:\'Avenir Next\';font-weight:400;src:local("Avenir Next Regular"),local("AvenirNext-Regular"),url("/fonts/AvenirNext/Regular.woff2") format("woff2"),url("/fonts/AvenirNext/Regular.woff") format("woff")}@font-face{font-family:\'Avenir Next\';font-weight:500;src:local("Avenir Next Medium"),local("AvenirNext-Medium"),url("/fonts/AvenirNext/Medium.woff2") format("woff2"),url("/fonts/AvenirNext/Medium.woff") format("woff")}@font-face{font-family:\'Avenir Next\';font-weight:700;src:local("Avenir Next Demi Bold"),local("AvenirNext-DemiBold"),url("/fonts/AvenirNext/Demi.woff2") format("woff2"),url("/fonts/AvenirNext/Demi.woff") format("woff")}@font-face{font-family:\'Avenir Next\';font-weight:900;src:local("Avenir Next Bold"),local("AvenirNext-Bold"),url("/fonts/AvenirNext/Bold.woff2") format("woff2"),url("/fonts/AvenirNext/Bold.woff") format("woff")}.tokenizer{cursor:text;border:1px solid #DCE2E6;padding:0 12px;border-radius:7px;min-height:36px;height:auto;display:flex;align-items:center;overflow-x:auto}.tokenizer .token{display:flex;align-items:center;flex-shrink:0;overflow:hidden;margin:2px 5px 2px 0;padding:2px 7px;color:white;cursor:default;font-size:15px;line-height:20px;white-space:nowrap;background-color:#0af;border-radius:3px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.tokenizer .token.selected{background-color:#0099e6}.tokenizer .token.alt{background-color:#A179F2}.tokenizer .token.alt.selected{background-color:#9162f0}.tokenizer input{min-height:24px;line-height:24px;min-width:50px;flex-grow:1;border:0;overflow:hidden;padding:0 !important;display:inline-block;border-radius:0}.tokenizer .remove{opacity:0.5;padding:0}.tokenizer .remove:hover{opacity:1}\n',"",{version:3,sources:["/home/mindmeister/server/mymind/releases/20200115114804/app/assets/stylesheets/meisterlabs/0-settings/_fonts.scss","/home/mindmeister/server/mymind/releases/20200115114804/webpack/css/ui/components/generic/tokenizer.scss","/home/mindmeister/server/mymind/releases/20200115114804/app/assets/stylesheets/meisterlabs/0-settings/_colors.scss","/home/mindmeister/server/mymind/releases/20200115114804/app/assets/stylesheets/meisterlabs/0-settings/_globals.scss"],names:[],mappings:"AAEA,WACE,oBAAqB,CACrB,eAAgB,CAChB,+IAIgD,CAGlD,WACE,oBAAqB,CACrB,eAAgB,CAChB,2IAI+C,CAGjD,WACE,oBAAqB,CACrB,eAAgB,CAChB,mJAIiD,CAGnD,WACE,oBAAqB,CACrB,eAAgB,CAChB,+IAIgD,CAGlD,WACE,oBAAqB,CACrB,eAAgB,CAChB,+IAIgD,CAKlD,WACE,yBAA0B,CAC1B,eAAgB,CAChB,gKAIoD,CAGtD,WACE,yBAA0B,CAC1B,eAAgB,CAChB,wKAIsD,CAGxD,WACE,yBAA0B,CAC1B,eAAgB,CAChB,oKAIqD,CAGvD,WACE,yBAA0B,CAC1B,eAAgB,CAChB,qKAImD,CAGrD,WACE,yBAA0B,CAC1B,eAAgB,CAChB,4JAImD,CCnGrD,WACE,WAAY,CACZ,wBCC8B,CDA9B,cAAe,CACf,iBE6BgB,CF5BhB,eAAgB,CAChB,WAAY,CACZ,YAAa,CACb,kBAAmB,CACnB,eAAgB,CATlB,kBAYI,YAAa,CACb,kBAAmB,CACnB,aAAc,CACd,eAAgB,CAChB,oBAAqB,CACrB,eAAgB,CAChB,WAAY,CACZ,cAAe,CACf,cAAe,CACf,gBAAiB,CACjB,kBAAmB,CACnB,qBCN6B,CDO7B,iBEQc,CFPd,wBAAa,CAAb,qBAAa,CAAb,oBAAa,CAAb,gBAAiB,CAzBrB,2BA4BM,wBAAmC,CA5BzC,sBAgCM,wBCZ2B,CDpBjC,+BAmCQ,wBAAqC,CAnC7C,iBAyCI,eAAgB,CAChB,gBAAiB,CACjB,cAAe,CACf,WAAY,CACZ,QAAS,CACT,eAAgB,CAChB,oBAAqB,CACrB,oBAAqB,CACrB,eAAgB,CAjDpB,mBAqDI,WAAY,CACZ,SAAU,CAtDd,yBAyDM,SAAU",file:"tokenizer.scss",sourcesContent:["/* Font Definitions */\n\n@font-face {\n  font-family: 'Avenir';\n  font-weight: 300;\n  src:\n    local('Avenir Light'),\n    local('Avenir-Light'),\n    url('/fonts/Avenir/Light.woff2') format('woff2'),\n    url('/fonts/Avenir/Light.woff') format('woff');\n}\n\n@font-face {\n  font-family: 'Avenir';\n  font-weight: 400;\n  src:\n    local('Avenir Book'),\n    local('Avenir-Book'),\n    url('/fonts/Avenir/Book.woff2') format('woff2'),\n    url('/fonts/Avenir/Book.woff') format('woff');\n}\n\n@font-face {\n  font-family: 'Avenir';\n  font-weight: 500;\n  src:\n    local('Avenir Medium'),\n    local('Avenir-Medium'),\n    url('/fonts/Avenir/Medium.woff2') format('woff2'),\n    url('/fonts/Avenir/Medium.woff') format('woff');\n}\n\n@font-face {\n  font-family: 'Avenir';\n  font-weight: 700;\n  src:\n    local('Avenir Heavy'),\n    local('Avenir-Heavy'),\n    url('/fonts/Avenir/Heavy.woff2') format('woff2'),\n    url('/fonts/Avenir/Heavy.woff') format('woff');\n}\n\n@font-face {\n  font-family: 'Avenir';\n  font-weight: 900;\n  src:\n    local('Avenir Black'),\n    local('Avenir-Black'),\n    url('/fonts/Avenir/Black.woff2') format('woff2'),\n    url('/fonts/Avenir/Black.woff') format('woff');\n}\n\n/* Avenir Next */\n\n@font-face {\n  font-family: 'Avenir Next';\n  font-weight: 300;\n  src:\n    local('Avenir Next Light'),\n    local('AvenirNext-Light'),\n    url('/fonts/AvenirNext/Light.woff2') format('woff2'),\n    url('/fonts/AvenirNext/Light.woff') format('woff');\n}\n\n@font-face {\n  font-family: 'Avenir Next';\n  font-weight: 400;\n  src:\n    local('Avenir Next Regular'),\n    local('AvenirNext-Regular'),\n    url('/fonts/AvenirNext/Regular.woff2') format('woff2'),\n    url('/fonts/AvenirNext/Regular.woff') format('woff');\n}\n\n@font-face {\n  font-family: 'Avenir Next';\n  font-weight: 500;\n  src:\n    local('Avenir Next Medium'),\n    local('AvenirNext-Medium'),\n    url('/fonts/AvenirNext/Medium.woff2') format('woff2'),\n    url('/fonts/AvenirNext/Medium.woff') format('woff');\n}\n\n@font-face {\n  font-family: 'Avenir Next';\n  font-weight: 700;\n  src:\n    local('Avenir Next Demi Bold'),\n    local('AvenirNext-DemiBold'),\n    url('/fonts/AvenirNext/Demi.woff2') format('woff2'),\n    url('/fonts/AvenirNext/Demi.woff') format('woff');\n}\n\n@font-face {\n  font-family: 'Avenir Next';\n  font-weight: 900;\n  src:\n    local('Avenir Next Bold'),\n    local('AvenirNext-Bold'),\n    url('/fonts/AvenirNext/Bold.woff2') format('woff2'),\n    url('/fonts/AvenirNext/Bold.woff') format('woff');\n}\n",'@import "meisterlabs/includes";\n\n.tokenizer {\n  cursor: text;\n  border: 1px solid $grey300;\n  padding: 0 12px;\n  border-radius: $br-medium;\n  min-height: 36px;\n  height: auto;\n  display: flex;\n  align-items: center;\n  overflow-x: auto;\n\n  .token {\n    display: flex;\n    align-items: center;\n    flex-shrink: 0;\n    overflow: hidden;\n    margin: 2px 5px 2px 0;\n    padding: 2px 7px;\n    color: white;\n    cursor: default;\n    font-size: 15px;\n    line-height: 20px;\n    white-space: nowrap;\n    background-color: $blue;\n    border-radius: $br-small;\n    user-select: none;\n\n    &.selected {\n      background-color: darken($blue, 5%);\n    }\n\n    &.alt {\n      background-color: $purple;\n\n      &.selected {\n        background-color: darken($purple, 5%);\n      }\n    }\n  }\n\n  input {\n    min-height: 24px;\n    line-height: 24px;\n    min-width: 50px;\n    flex-grow: 1;\n    border: 0;\n    overflow: hidden;\n    padding: 0 !important;\n    display: inline-block;\n    border-radius: 0;\n  }\n\n  .remove {\n    opacity: 0.5;\n    padding: 0;\n\n    &:hover {\n      opacity: 1;\n    }\n  }\n}\n',"/* Grey Tones (Font Colors) */\n\n$grey900               : #333C40;\n$grey700               : #3D474D;\n$grey500               : #8A9499;\n$grey300               : #DCE2E6;\n$grey200               : #EDF1F2;\n$grey100               : #F7F9FA;\n\n$grey                  : $grey700; /* keep this to avoid scss undefined errors until MM19 */\n\n/* Other Colors */\n\n$red                    : #FF4019;\n$orange                 : #FFAA00;\n$yellow                 : #FFD426;\n$banana                 : #FFF2B3;\n$green                  : #3DCC3D;\n$turquoise              : #2BD9D9;\n$blue                   : #00AAFF;\n$navy                   : #4070FF;\n$sky                    : #E6F7FF; /* used for selected items with light blue bg*/\n$purple                 : #A179F2;\n$brown                  : #806040;\n$grass                  : #96DB0B;\n$pink                   : #F7578C;\n\n","/* Global Settings */\n\n$page-width      : 940px;\n$fonts-brand     : 'Avenir', 'Avenir Next', 'Segoe UI', Helvetica, Arial, sans-serif;\n\n/* Font Sizes */\n\n$fs-xsmall       : 11px;\n$fs-small        : 13px;\n$fs-medium       : 15px;\n$fs-large        : 17px;\n$fs-xlarge       : 21px;\n$fs-xxlarge      : 34px;\n\n/* Font Weights */\n\n$fw-black      : 900;\n$fw-bold       : 700;\n$fw-medium     : 500;\n$fw-regular    : 400;\n$fw-light      : 300;\n\n/* Line Heights */\n\n$lh-small      : 120%;\n$lh-normal     : 140%;\n$lh-large      : 160%;\n\n/* Border Colors */\n\n$bc-normal     : $grey200;\n\n/* Border Radii */\n\n$br-small    : 3px;\n$br-medium   : 7px;\n$br-large    : 10px;\n$br-xlarge   : 15px;\n$br-xxlarge  : 20px;\n\n/* Box Shadows */\n\n$bs-small    : 0 0 0 1px rgba(0,0,0,0.07), 0 2px 5px -1px rgba(0,0,0,0.07);\n$bs-medium   : 0 0 0 1px rgba(0,0,0,0.07), 0 5px 10px -5px rgba(0,0,0,0.15);\n$bs-large    : 0 0 0 1px rgba(0,0,0,0.07), 0 10px 30px -10px rgba(0,0,0,0.15);\n\n"]}])},CJ9X:function(e,t,n){"use strict";function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],o=!0,i=!1,r=void 0;try{for(var s,a=e[Symbol.iterator]();!(o=(s=a.next()).done)&&(n.push(s.value),!t||n.length!==t);o=!0);}catch(l){i=!0,r=l}finally{try{o||null==a.return||a.return()}finally{if(i)throw r}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}n.r(t),n.d(t,"checkLink",(function(){return i})),n.d(t,"embeddedURLs",(function(){return r}));var i=function(e){var t,n,i=null,r=null;if((i=e.match(/(?:https?:\/\/(?:www\.)?|www\.|m\.|^)youtu(?:be\.com\/(?:.+)?(?:(?:watch(?:\?|\.+&))?v[\/=]|\/)|\.be\/)([a-zA-Z0-9_-]{11}).*/))&&11===i[1].length){r="youtube";var s=Object.toQueryString((t={start:0},(n=e.match(/([#&?](start|t|end)=\d+)/g))&&n.each((function(e){var n=o(e.match(/(\w+)=(\d+)/),3),i=n[1],r=n[2];"t"===i&&(i="start"),t[i]=r})),t));i="".concat(i[1],"?").concat(s)}else if(i=e.match(/(?:https?:\/\/(?:www\.)?|www\.|^).*vimeo.*(?:videos|video|channels(?:\/[a-zA-Z0-9]*)?|\.com)\/([\d]+)/))r="vimeo",i=i[1];else if(i=e.match(/(?:https?:\/\/(?:www\.)?|www\.|^).*dailymotion.com\/(?:embed\/)?(?:(?:video|hub)\/([^_]+))?[^#]*(?:#video=([^_&]+))?/)){r="dailymotion";for(var a=i.length-1;a>0&&void 0===i[a];a--);i=i[a]}else ServerData.isLoggedIn&&ServerData.user.unilogin&&(i=e.match(/(?:https?:\/\/(?:www\.)?|www\.|^).*(?:skoletube\.dk\/video\/)[\d]+\/([a-zA-Z0-9]{20})/))&&(r="skoletube",i=i[i.length-1]);return{video:i,source:r,url:e}},r={youtube:"//www.youtube.com/embed/",vimeo:"//player.vimeo.com/video/",dailymotion:"//www.dailymotion.com/embed/video/",skoletube:"//www.skoletube.dk/e/"}},CMye:function(e,t,n){var o=n("GoyQ");e.exports=function(e){return e===e&&!o(e)}},Ddwv:function(e,t,n){var o,i,r;function s(e){return(s="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}i=[e,n("YDNs"),n("wOJ8"),n("TiCD")],void 0===(r="function"===typeof(o=function(e,t,n,o){"use strict";var i=l(t),r=l(n),a=l(o);function l(e){return e&&e.__esModule?e:{default:e}}var c="function"===typeof Symbol&&"symbol"===s(Symbol.iterator)?function(e){return s(e)}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":s(e)},u=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),f=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var o=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==s(t)&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return o.resolveOptions(n),o.listenClick(e),o}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+s(t));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),u(t,[{key:"resolveOptions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.action="function"===typeof e.action?e.action:this.defaultAction,this.target="function"===typeof e.target?e.target:this.defaultTarget,this.text="function"===typeof e.text?e.text:this.defaultText,this.container="object"===c(e.container)?e.container:document.body}},{key:"listenClick",value:function(e){var t=this;this.listener=(0,a.default)(e,"click",(function(e){return t.onClick(e)}))}},{key:"onClick",value:function(e){var t=e.delegateTarget||e.currentTarget;this.clipboardAction&&(this.clipboardAction=null),this.clipboardAction=new i.default({action:this.action(t),target:this.target(t),text:this.text(t),container:this.container,trigger:t,emitter:this})}},{key:"defaultAction",value:function(e){return p("action",e)}},{key:"defaultTarget",value:function(e){var t=p("target",e);if(t)return document.querySelector(t)}},{key:"defaultText",value:function(e){return p("text",e)}},{key:"destroy",value:function(){this.listener.destroy(),this.clipboardAction&&(this.clipboardAction.destroy(),this.clipboardAction=null)}}],[{key:"isSupported",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["copy","cut"],t="string"===typeof e?[e]:e,n=!!document.queryCommandSupported;return t.forEach((function(e){n=n&&!!document.queryCommandSupported(e)})),n}}]),t}(r.default);function p(e,t){var n="data-clipboard-"+e;if(t.hasAttribute(n))return t.getAttribute(n)}e.exports=f})?o.apply(t,i):o)||(e.exports=r)},DuKA:function(e,t,n){"use strict";(function(e){var o=n("5qmN"),i=n("WfvK"),r=n("AJqD"),s=n("2L+8"),a=n("ERGR");function l(e){return(l="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var h=function(t){function n(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(t=function(e,t){return!t||"object"!==l(t)&&"function"!==typeof t?f(e):t}(this,u(n).call(this,e))).state={viewOnly:e.viewOnly},t._onChange=t._onChange.bind(f(t)),t}var h,d,m;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(n,t),h=n,(d=[{key:"getMembers",value:function(e){return this.tokenizer.getValue(e)}},{key:"getTokenCount",value:function(){return this.tokenizer.getTokenCount()}},{key:"isViewOnly",value:function(){return"canView"===this.state.value}},{key:"clearTokens",value:function(){this.tokenizer.clear()}},{key:"getTokenizer",value:function(){return this.tokenizer}},{key:"_onChange",value:function(e){this.setState({value:e.value})}},{key:"renderTokenizerHeader",value:function(){var t=this;if(this.props.hideTokenizerHeader)return null;var n=e.createElement(i.a,{icon:e.createElement(s.a,{opts:{name:this.isViewOnly()?"eye":"pen",size:16,color:"grey500",parentClasses:"mr-5px"}}),className:"access-label fs-m mt-5"}),o=[{label:I18n.t("js.can_edit"),value:"canEdit"},{label:I18n.t("js.can_view"),value:"canView"}];return e.createElement("div",{className:"h-flex-row mb-5"},e.createElement("p",{className:"fw-medium fs-l lh-1.5 c-light mb-0 mr-auto"},I18n.t("js.invite_people")),e.createElement(r.a,{onChange:this._onChange,selected:o.find((function(e){return e.value===t.state.value})),showSelectedState:!1,opener:n},e.createElement(a.a,{items:o})))}},{key:"render",value:function(){var t=this;return e.createElement("div",{className:this.props.className},this.renderTokenizerHeader(),e.createElement(o.a,{ref:function(e){return t.tokenizer=e},placeholder:this.props.placeholder,autoComplete:this.props.autoComplete}))}}])&&c(h.prototype,d),m&&c(h,m),n}(e.Component);h.defaultProps={className:"",placeholder:""},t.a=h}).call(this,n("q1tI"))},Dw6Z:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return u}));var o=n("qinL"),i=n("1Gbl");function r(e){return(r="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function a(e){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var u=function(t){function n(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(t=function(e,t){return!t||"object"!==r(t)&&"function"!==typeof t?l(e):t}(this,a(n).call(this,e)))._openDialog=t._openDialog.bind(l(t)),t}var u,f,p;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(n,t),u=n,(f=[{key:"sortUsers",value:function(e){return e.sort((function(e,t){return e.isOnline()===t.isOnline()?0:e.isOnline()?-1:1}))}},{key:"usersExcludingSelfAndAnonymus",value:function(e){var t=this;return e.filter((function(e){return e.id!==t.props.selfUser.id&&(!e.anonymous||e.isOnline())}))}},{key:"_openDialog",value:function(){if(!this.props.selfUser.anonymous)return MM.ui.dialogs.dialogSharing(this.props.mapId);MM.ui.dialogs.dialogLogin(this.props.selfUser)}},{key:"render",value:function(){var t=this.props,n=t.users,r=t.currentUsers,s=t.selfUser,a=t.visibleUsersCount,l=t.renderLink,c=this.usersExcludingSelfAndAnonymus(n),u=this.usersExcludingSelfAndAnonymus(r);if(0===c.length&&0===u.length)return null;var f=this.sortUsers(c),p=f.slice(0,a),h=!s.anonymous||2===s.permission,d=l?{onClick:this._openDialog,className:"c-blue td-underline h-cp lh-120%"}:{};return e.createElement("div",{className:"h-flex-row"},e.createElement("div",{className:"h-flex-column mr-10"},e.createElement("span",{className:"fs-xs c-light"},I18n.t("js.shared_with")),e.createElement("span",d,I18n.t("js.count_people",{count:c.length}))),e.createElement("div",{className:"h-flex-row mr-10"},p.map((function(t,n){return e.createElement(i.a,{key:t.id,userID:t.id,enabled:h})})),f.length>p.length?e.createElement(o.a,{users:f.slice(p.length,f.length),enabled:h}):null))}}])&&s(u.prototype,f),p&&s(u,p),n}(e.Component)}).call(this,n("q1tI"))},ERGR:function(e,t,n){"use strict";(function(e){var o=n("eQkx"),i=n("Pqld");function r(e){return(r="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function a(e){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var u=function(t){function n(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(t=function(e,t){return!t||"object"!==r(t)&&"function"!==typeof t?l(e):t}(this,a(n).call(this,e))).state={items:e.items},t.onMouseLeave=t.onMouseLeave.bind(l(t)),t.onMouseEnter=t.onMouseEnter.bind(l(t)),t.unselectAll=t.unselectAll.bind(l(t)),t.updateSelection=t.updateSelection.bind(l(t)),t}var u,f,p;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(n,t),u=n,(f=[{key:"onMouseLeave",value:function(){this.props.onMouseLeave?this.props.onMouseLeave(-1):this.updateSelection(-1)}},{key:"onMouseEnter",value:function(e){this.props.onMouseEnter?this.props.onMouseEnter(e):this.updateSelection(e)}},{key:"unselectAll",value:function(){var e=this.state.items;return e[this.index]&&(e[this.index].highlighted=!1),e}},{key:"updateSelection",value:function(e){var t=this.unselectAll();this.index=e,t[this.index]&&(t[this.index].highlighted=!0),this.setState({allItems:t})}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.setState({items:e.items})}},{key:"render",value:function(){var t=this,n=this.props.indexStart||0;return e.createElement("div",{className:"widget-container list-widget ".concat(this.props.className)},this.props.header?e.createElement(i.a,this.props.header):null,this.state.items.map((function(i,r){return e.createElement(o.a,{key:r,icon:i.icon,label:i.label,className:i.className,isDisabled:i.isDisabled,style:i.style,onClick:i.onClick,closePopover:t.props.closePopoverOnItemClick,subMenu:i.subMenu,selected:i.selected,highlighted:i.highlighted,onMouseEnter:t.onMouseEnter,onMouseLeave:t.onMouseLeave,enableParentKeyMap:t.props.enableParentKeyMap,disableParentKeyMap:t.props.disableParentKeyMap,index:n+r,backgroundColor:i.backgroundColor})})))}}])&&s(u.prototype,f),p&&s(u,p),n}(e.Component);u.defaultProps={className:"",closePopoverOnItemClick:!0},t.a=u}).call(this,n("q1tI"))},Em2t:function(e,t,n){var o=n("bahg"),i=n("quyA"),r=n("0JQy");e.exports=function(e){return i(e)?r(e):o(e)}},ExA7:function(e,t){function n(e){return(n="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}e.exports=function(e){return null!=e&&"object"==n(e)}},F6Ed:function(e,t,n){"use strict";n.r(t);var o=n("Z7WR"),i=function(){var e=3,t={x:0,y:0},n=15,i={},r=null,s=null,a=[{name:o.default.CHILD_ADDED,hint:I18n.t("js.hint_insert_sibling",{v0:"<kbd>",v1:"</kbd>"})},{name:o.default.EDIT_MODE_ENTERED,hint:I18n.t("js.hint_press_shift_enter_new_line",{v0:"<kbd>",v1:"</kbd>",v2:"<kbd>",v3:"</kbd>"})},{name:o.default.FILE_UPLOAD,hint:I18n.t("js.hint_drop_files_on_topic"),icon:!0},{name:o.default.NOTE_CHANGED,hint:I18n.t("js.hint_did_you_know_you_can_also_comment_vote")+' <a href="#" onclick="mm$(\'vote_count\').click(); return false;">'+I18n.t("js.try_it")+"</a>",icon:!0},{name:o.default.SIBLING_ADDED,hint:I18n.t("js.hint_insert_subtopic",{v0:"<kbd>",v1:"</kbd>"})},{name:o.default.TASK_ADDED,hint:I18n.t("js.hint_meistertask",{v0:'<a href="#" onclick="mm$(\'btn_togglemeistertask\').click(); return false">',v1:"</a>"}),icon:!0},{name:o.default.UNDO,hint:I18n.t("js.hint_history_mode",{v0:'<a href="#" onclick="mm$(\'btn_togglehistory\').click(); return false">',v1:"</a>"}),icon:!0},{name:o.default.WEB_IMAGE_ADDED,hint:I18n.t("js.hint_wunderbild"),icon:!0}];function l(t){t.stop();var n,o,l=App.getCustomEventName(t);s&&s.name===l||function(e){if(!e||e&&!i.container)return void(s=null);(s=a.find((function(t){return t.name===e}))).icon?removeClassName(i.icon,"h-hidden"):addClassName(i.icon,"h-hidden"),i.hint.innerHTML=s.hint}(l),o=s,(n=parseInt(MM.utils.getCookie(c(o.name))||0))>=e?s=null:function(e,t){"number"===typeof t&&MM.utils.setCookie(c(e.name),t,31)}(s,n+1),s&&(clearTimeout(r),removeClassName(i.container,"h-hidden"),setTimeout((function(){addClassName(i.container,"active")}),0),r=setTimeout((function(){removeClassName(i.container,"active"),setTimeout((function(){addClassName(i.container,"h-hidden")}),300)}),5e3))}function c(e){return"hints_"+e.toLowerCase()}return{init:function(){t={x:n,y:UI.Registry.viewportOffset.bottom},(i={container:new Element("div",{className:"hints h-hidden bg-white o-0 z-1000 rad-5 ph-16 pv-8 p-a al-15 ab-"+(t.y+n)}),icon:new Element("span",{className:"lightbulb h-block w-20px h-20px mr-5"}),hint:new Element("span",{className:"va-middle"})}).container.insert(new Element("row",{className:"va-middle"}).insert(new Element("cell").insert(i.icon)).insert(new Element("cell").insert(i.hint))),document.body.appendChild(i.container),a.each((function(e){App.subscribe(e.name,l)})),this.visible=!0,UI.Registry.add(this)},onResize:function(){t.y!==UI.Registry.viewportOffset.bottom&&(removeClassName(i.container,"ab-"+(t.y+n)),t.y=UI.Registry.viewportOffset.bottom,addClassName(i.container,"ab-"+(t.y+n)))},destroy:function(){this.visible&&(a.each((function(e){App.unsubscribe(e.name,l)})),i.container.remove(),i={},s=null,UI.Registry.remove(this))}}}();t.default=i},FW34:function(e,t,n){"use strict";(function(e){var o=n("2L+8");function i(e){return(i="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function a(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var c=function(t){function n(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(t=function(e,t){return!t||"object"!==i(t)&&"function"!==typeof t?a(e):t}(this,s(n).call(this,e))).state={selected:!1},t.onClick=t.onClick.bind(a(t)),t.handleDelete=t.handleDelete.bind(a(t)),t}var c,u,f;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(n,t),c=n,(u=[{key:"select",value:function(){this.setState({selected:!0}),this.keymap.enable(),Event.observe(document,"click",this.onClick)}},{key:"unselect",value:function(){this.setState({selected:!1}),this.keymap.disable(),Event.stopObserving(document,"click",this.onClick)}},{key:"handleDelete",value:function(){var e=this;setTimeout((function(){return e.props.onDelete({label:e.props.label,value:e.props.value})}),0)}},{key:"onClick",value:function(e){e.preventDefault(),e.stopPropagation(),this.state.selected?this.unselect():this.select()}},{key:"componentDidMount",value:function(){var e=MM.utils.KeyEvent;this.keymap=new MM.utils.KeyMap(document,"tokenizer_keymap",[{key:[e.DELETE,e.BACKSPACE],fn:this.handleDelete,stopEvent:!0}]),this.keymap.disable()}},{key:"componentWillUnmount",value:function(){this.unselect()}},{key:"render",value:function(){var t=(this.state.selected?"selected ":"")+"token";return e.createElement("div",{className:"".concat(t," h-flex-row tooltip"),title:this.props.value,tabIndex:"-1",onClick:this.onClick},e.createElement("span",{className:"mr-7"},this.props.label),e.createElement(o.a,{className:"remove",opts:{name:"close",size:8,color:"white"},onClick:this.handleDelete}))}}])&&r(c.prototype,u),f&&r(c,f),n}(e.Component);t.a=c}).call(this,n("q1tI"))},Fjee:function(e,t,n){"use strict";(function(e){var o=n("4qC0"),i=n.n(o),r=n("2L+8"),s=n("PjTj");function a(e){return(a="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var d=function(t){function n(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(t=function(e,t){return!t||"object"!==a(t)&&"function"!==typeof t?u(e):t}(this,c(n).call(this,e))).state={value:t.props.value,focused:t.props.autoFocus},t.onFocus=t.onFocus.bind(u(t)),t.onBlur=t.onBlur.bind(u(t)),t.onChange=t.onChange.bind(u(t)),t.clear=t.clear.bind(u(t)),t}var o,p,h;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(n,t),o=n,(p=[{key:"onFocus",value:function(){this.props.onFocus&&this.props.onFocus(),this.setState({focused:!0})}},{key:"onBlur",value:function(){this.props.onBlur&&this.props.onBlur(),this.setState({focused:!1})}},{key:"onChange",value:function(e,t){this.setState({value:t}),this.props.onChange(e,t)}},{key:"clear",value:function(e){e.nativeEvent.stopImmediatePropagation(),this.props.onChange(null,""),this.setState({focused:!0,value:""})}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=e.value;i()(t)&&this.state.value!==t&&this.setState({value:t})}},{key:"render",value:function(){var t=this.props,n=t.className,o=t.iconColor,i=t.renderIcon,a=this.state,l=a.value,c=a.focused,u=c?"bc-blue":"bc-grey300",f=l?e.createElement(r.a,{opts:{name:"close",size:10,color:"grey300",parentClasses:"mr-8"},onMouseDown:this.clear}):null;return e.createElement("div",{className:"".concat(n," h-flex-row justify-sb b-1 rad-7px ").concat(u)},e.createElement("div",{className:"h-flex-row h-flex-grow mr-8"},i({color:o}),e.createElement(s.a,{type:"text",autoFocus:c,placeholder:I18n.t("js.search"),onFocus:this.onFocus,onBlur:this.onBlur,onChange:this.onChange,className:"width-100% b-0 p-0",value:l})),f)}}])&&l(o.prototype,p),h&&l(o,h),n}(e.Component);h(d,"defaultProps",{renderIcon:function(t){return t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(n,!0).forEach((function(t){h(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({name:"search",size:14,classes:"h-a-center",parentClasses:"p-r ml-8 mr-4",consize:16},t),e.createElement(r.a,{opts:t})}}),t.a=d}).call(this,n("q1tI"))},Fw71:function(e,t,n){"use strict";(function(e){var o=n("i1gT");t.a=function(t){var n=t.messages,i=t.height,r=t.resendMessage;return e.createElement("div",{className:"pt-16 h-flex-column"},n.map((function(t,n){return e.createElement(o.a,{key:n,message:t,height:i,resendMessage:r})})))}}).call(this,n("q1tI"))},G7PK:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return p}));var o=n("Pqld");function i(e){return(i="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(n,!0).forEach((function(t){f(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function a(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var p=function(t){function n(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(t=function(e,t){return!t||"object"!==i(t)&&"function"!==typeof t?c(e):t}(this,l(n).call(this,e))).state={on:e.on,link:e.link},t._handleCheckboxClick=t._handleCheckboxClick.bind(c(t)),t._handleGenerateClick=t._handleGenerateClick.bind(c(t)),t}var r,f,p;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(n,t),r=n,(f=[{key:"_handleCheckboxClick",value:function(e){e.preventDefault(),e.stopPropagation(),this._sync({on:!this.state.on})}},{key:"_handleGenerateClick",value:function(e){e.preventDefault(),e.stopPropagation(),this.state.on&&this._sync({reset:!0})}},{key:"_initClipboardButton",value:function(){var e=this;this.clipboardButton&&(this.clipboardButton.destroy(),this.clipboardButton=null),this.state.on&&MM.utils.loadModule("partials/clipboard",(function(t){e.clipboardButton=t.default(e.shareButton,{target:function(){return e.shareLinkInput}})}))}},{key:"_sync",value:function(e){var t=this,n=this.props,o=n.mapId,i=n.onChange;new Ajax.Request("/sharing/link_share.json",{parameters:s({},e,{id:o}),onSuccess:function(e){var n=e.responseJSON,o=n.shareToken,r=n.url,s=!!o;i(s,r,o),t.setState({on:s,link:r})},onFailure:function(){Message.show(I18n.t("js.your_request_was_not_done"),Message.ERROR)}})}},{key:"componentDidMount",value:function(){this._initClipboardButton()}},{key:"componentDidUpdate",value:function(){this._initClipboardButton()}},{key:"render",value:function(){var t,n,i,r,s,a,l,c=this,u=this.state,f=u.on,p=u.link;return e.createElement("div",{className:"widget-container invitation-widget "+this.props.className},(r={readOnly:this.props.readOnly,checked:f,onChange:this._handleCheckboxClick},s=r.readOnly,a=r.checked,l=r.onChange,s?e.createElement(o.a,{className:"mt-10 mb-5",title:I18n.t("js.link_to_share")}):e.createElement(o.a,{elementLeft:e.createElement("input",{type:"checkbox",id:"share_link",checked:a,onChange:l,style:{verticalAlign:"text-top"}}),className:"mt-10 mb-5",title:e.createElement("label",{htmlFor:"share_link",className:"h-cp"},I18n.t("js.link_to_share"))})),e.createElement("div",{className:"h-flex-column mt-5"},e.createElement("div",{className:"h-flex-row mb-5"},e.createElement("input",{ref:function(e){return c.shareLinkInput=e},className:"minw-200 w-100% mr-10",type:"text",readOnly:!0,value:f?p:""}),e.createElement("a",{href:"#",ref:function(e){return c.shareButton=e},className:"td-underline ws-nowrap".concat(f?"":" disabled"),onClick:function(e){return e.preventDefault()}},I18n.t("js.copy_link"))),(t={isHidden:this.props.readOnly||!f,onClick:this._handleGenerateClick},n=t.isHidden,i=t.onClick,n?null:e.createElement("a",{href:"#",className:"fs-s c-grey300 td-underline",onClick:i},I18n.t("js.generate_new_url")))))}}])&&a(r.prototype,f),p&&a(r,p),n}(e.Component);f(p,"defaultProps",{className:"",onChange:function(){}})}).call(this,n("q1tI"))},GDhZ:function(e,t,n){var o=n("wF/u"),i=n("mwIZ"),r=n("hgQt"),s=n("9ggG"),a=n("CMye"),l=n("IOzZ"),c=n("9Nap"),u=1,f=2;e.exports=function(e,t){return s(e)&&a(t)?l(c(e),t):function(n){var s=i(n,e);return void 0===s&&s===t?r(n,e):o(t,s,u|f)}}},GNiM:function(e,t,n){var o=n("I01J"),i=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,r=/\\(\\)?/g,s=o((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(i,(function(e,n,o,i){t.push(o?i.replace(r,"$1"):n||e)})),t}));e.exports=s},Gkdu:function(e,t,n){"use strict";n.r(t),function(e,o){var i=n("Dw6Z"),r=n("2L+8"),s=n("aZjR"),a=n("M1jG"),l=n("6acW"),c=n.n(l),u=n("iXwB"),f={visibleUsers:0,bars:{history:{height:168,permissions:"write",path:"ui/history/history"},slideshow:{height:150,permissions:"write",path:"ui/presentation/slideshow"},print:{height:77,permissions:"read",path:"ui/print/print"},meistertask:{height:150,permissions:"write",path:"utils/meistertask/meistertask"}},init:function(){this.el=$("map_footer"),this.els={bar:$("footerbar"),collaborators:$("collaborators-list"),collaboratorsContainer:$("collaboration-container")},this.enable(),Element.bindOnClick("btn_present",Presentation.togglePresenter.bind(Presentation)),Element.bindOnClick("btn_export",this._onExportClick.bind(this)),this.setViewportOffset(),UI.Registry.add(this),UI.Registry.notify(this,"show"),MM.ui.ToolTips.touchSafe({el:this.el}),this.els.collaborators&&this.els.collaboratorsContainer&&(this._renderSharingButton(),App.config.msTeamsTabLink&&(Object(u.initMsTeamsTabLink)(App.config.map_id,App.config.msTeamsTabLink.status,this._onMsTeamsStatusChange.bind(this)),mm$("btn-msteams-tab-link")&&this._renderMsTeamsTabButton())),this.calculateVisibleUsers(),App.subscribe(CustomEvents.COLLABORATORS_UPDATED,this._renderUsers.bind(this))},_onExportClick:function(){users.selfUser.anonymous?MM.ui.dialogs.dialogLogin(users.selfUser):MM.ui.dialogs.dialogExportMap(App.config.map_id,null,{onShow:function(){return App.trigger(CustomEvents.EXPORT_DLG_OPENED)},onClose:function(){return App.trigger(CustomEvents.EXPORT_DLG_CLOSED)}})},_onPrintClick:function(){users.selfUser.anonymous?MM.ui.dialogs.dialogLogin(users.selfUser):this.toggleBar("print")},_renderSharingButton:function(){var t=this;e.render(o.createElement(s.a,{currentUser:users.selfUser,mapId:App.config.map_id,isPublicMap:App.config.isPublic,onShow:function(){return App.trigger(CustomEvents.SHARING_POPOVER_OPENED)},onClose:function(){return App.trigger(CustomEvents.SHARING_POPOVER_CLOSED)},onInvite:function(e){var t=e.users;App.config.shareMode<App.SHARED&&t.length>1&&App.toSharedMode()},onPublish:function(){App.config.isPublic=!0,t._renderSharingButton()},msTeamsTabLink:App.config.msTeamsTabLink,onMsTeamsStatusChange:function(e,n){return t._onMsTeamsStatusChange(e,n)}}),mm$("btn-share-container"))},_renderUsers:function(){if("phantomjs"!==App.config.environment&&this.els.collaborators)if(MM.ua.isPhone||MM.ua.isTablet)e.render(o.createElement("div",{className:"h-flex-row p-r mr-10"},o.createElement(r.a,{opts:{name:"service-android",size:32,parentClasses:"rad-100%"}}),o.createElement(r.a,{opts:{name:"service-ios",size:32,parentClasses:"rad-100% bc-grey300 b-1 p-a h-v-center al-24"}}),o.createElement("p",{className:"fs-s pl-30",dangerouslySetInnerHTML:{__html:I18n.t("js.app_teaser_map_view_html")}})),this.els.collaborators);else{var t=users.collaborators();e.render(o.createElement(i.a,{mapId:App.config.map_id,renderLink:"embedded_full"!==App.config.viewMode,users:t,currentUsers:users.currentUsers,selfUser:users.selfUser,visibleUsersCount:Math.min(this.visibleUsers,t.length)}),this.els.collaborators)}},_renderMsTeamsTabButton:function(){var t=this,n=App.config,i=n.map_id,r=n.msTeamsTabLink;e.render(o.createElement(a.a,{mapId:i,onMsTeamsStatusChange:function(e,n){return t._onMsTeamsStatusChange(e,n)},status:r.status,tabUrl:r.url,readOnly:r.readOnly}),mm$("btn-msteams-tab-link"))},_onMsTeamsStatusChange:function(e,t){App.config.msTeamsTabLink={status:e,url:t},mm$("btn-msteams-tab-link")?this._renderMsTeamsTabButton():this._renderSharingButton()},setViewportOffset:function(){this.viewportSpace={bottom:this.el.offsetHeight+(this.activeBar?this.els.bar.offsetHeight:0)}},calculateVisibleUsers:function(){if(this.els.collaboratorsContainer){var e=this.els.collaboratorsContainer.clientWidth-280,t=Math.floor(e/32);this.visibleUsers=Math.min(t,5)}},onResize:function(){this.setViewportOffset();var e=this.visibleUsers;this.calculateVisibleUsers(),this.visibleUsers!==e&&this._renderUsers()},show:function(e){var t=this,n=(e?500:0)+"ms";CSS.set(this.el,{bottom:"0px",transitionDuration:n}),this.hiddenBar&&(this.showBar(this.hiddenBar),this.hiddenBar=null),setTimeout((function(){return UI.Registry.notify(t,"show")}),e?500:10)},hide:function(e){var t=e?"500ms":"0ms";CSS.set(this.el,{bottom:-this.el.getHeight()+"px",transitionDuration:t}),this.activeBar&&(this.hiddenBar=this.activeBar,this.hideBar(this.activeBar)),UI.Registry.notify(this,"hide")},enable:function(){Object.keys(this.bars).each(function(e){var t=e+"Listener",n=$("btn_toggle"+e);if(!this.hasOwnProperty(t)){var o=this["_on"+c()(e)+"Click"];this[t]=o?o.bind(this):this.toggleBar.bind(this,e)}n&&("write"===this.bars[e].permissions&&App.config.editable||"read"===this.bars[e].permissions?(n.observe("click",this[t]),MM.ui.enableButton(n)):(n.stopObserving("click",this[t]),n.title=I18n.t("js.you_are_in_view_only_mode"),MM.ui.disableButton(n)))}.bind(this))},disable:function(){Object.keys(this.bars).each(function(e){mm$("btn_toggle"+e)&&$("btn_toggle"+e).stopObserving("click",this[e+"Listener"])}.bind(this))},toggleBar:function(e){return!!this.els.bar&&("write"!==this.bars[e].permissions||App.config.editable?(this.activeBar===e?this.hideBar(e):this.showBar(e),!1):(App.ui.Message.show(I18n.t("js.you_are_in_view_only_mode"),Message.NOTICE),!1))},showBar:function(e){if(this.els.bar){this.activeBar&&(this.hideBar(this.activeBar,!0),this.els.bar.innerHTML=""),this.actions.hasOwnProperty("onBeforeShow"+e.capitalize())&&this.actions["onBeforeShow"+e.capitalize()](),addClassName(mm$("btn_toggle"+e),"active");var t=function(){new Ajax.Request("/toolbar/"+e,{parameters:{id:App.config.map_id},evalScripts:!0,asynchronous:!0,onComplete:function(t){var n=t.responseJSON;n?(this.hideBar(e),removeClassName(mm$("btn_toggle"+e),"active"),MM.ui.enableButton("btn_toggle"+e),n.error?Message.show(n.error,Message.ERROR):n.info&&Message.show(n.info,Message.INFO)):("meistertask"===e&&this._prepareBar(e),this.activeBar&&this._doShowBar(e))}.bind(this)})}.bind(this),o=this.bars[e].path;n("fgbg")("./".concat(o)).then((function(){return t()})),"meistertask"!==e&&(this._prepareBar(e),Amplitude.logEvent("toolbar_"+e)),App.hideAnonymousHint()}},_prepareBar:function(e){this.activeBar=e,this.els.bar.style.bottom="",this.els.bar.morph("height:"+this.bars[e].height+"px",{afterFinish:function(){UI.Registry.onResize(),this.onShowBarComplete(e),this.actions.hasOwnProperty("onShow"+e.capitalize())&&this.actions["onShow"+e.capitalize()]()}.bind(this)})},_doShowBar:function(e){this.actions.hasOwnProperty("doStart"+e.capitalize())?this.actions["doStart"+e.capitalize()]():this.enable(),MM.utils.siteLocation.setLoc(e),this.els.bar.select(".js-close-footerbar")[0].onclick=this.toggleBar.bind(this,e),MM.ui.enableButton("btn_toggle"+e)},onShowBarComplete:function(e){this.els.bar.addClassName("active"),"info"==e&&(this.els.bar.style.height="auto")},hideBar:function(e,t){this.els.bar&&(MM.utils.siteLocation.reset(),this.activeBar=null,removeClassName(this.els.bar,"active"),t?this._doHideBar(e):this.els.bar.morph("height: 0;",{afterFinish:this._doHideBar.bind(this,e)}),removeClassName(mm$("btn_toggle"+e),"active"),App.showAnonymousHint())},_doHideBar:function(e){this.els.bar.style.bottom="0",UI.Registry.onResize(),this.actions.hasOwnProperty("doStop"+e.capitalize())&&this.actions["doStop"+e.capitalize()](),new Ajax.Request("/toolbar/hide",{parameters:{id:App.config.map_id},evalScripts:!0,asynchronous:!0}),MM.ui.enableButton("btn_toggle"+e)}};f.Meistertask={updateIcon:function(e){var t=mm$("btn_togglemeistertask");t&&(e?(removeClassName(t,"icon-path"),t.setAttribute("data-icon","products-meistertask-icon")):(addClassName(t,"icon-path"),t.setAttribute("data-icon","mt-checkmark")),MM.ui.svgIcons(t))}},f.actions={onBeforeShowPrint:function(){App.config.currentlyEditable=!1,UI.Registry.toggleMode("view")},doStartPrint:function(){App.ui.Print.init()},doStopPrint:function(){App.config.editable&&(App.config.currentlyEditable=!0,UI.Registry.toggleMode("edit")),App.ui.Print.exit()},doStartMeistertask:function(){App.trigger(CustomEvents.MEISTERTASK_BAR_OPENED)},doStopMeistertask:function(){MM.utils.Meistertask.exit();var e=GeneralPopover.get("mt_project_footer");e&&e.destroy()},onBeforeShowHistory:function(){App.config.showRevisions=!0,App.config.currentlyEditable=!1,UI.Registry.toggleMode("view"),App.showMapLoading()},doStartHistory:function(){RevisionBrowser.start(this.startHistoryView,!1,!0),App.trigger(CustomEvents.HISTORY_MODE_STARTED)},doStopHistory:function(){App.showMapLoading(),"undefined"!==typeof RevisionsSlider&&RevisionsSlider.highlightNodes(!1),"undefined"!==typeof RevisionBrowser&&RevisionBrowser.stop(),App.config.editable&&(App.config.currentlyEditable=!0,UI.Registry.toggleMode("edit")),mm$("canvas_container").style.opacity=1,App.config.showRevisions=!1,App.hideMapLoading(),App.trigger(CustomEvents.HISTORY_MODE_CLOSED)},doStartSlideshow:function(e){Presentation.Slideshow.prepare(e)},doStopSlideshow:function(){Presentation.on||Presentation.Slideshow.exit()},historyRevert:function(){var e=RevisionBrowser.revision+1;ServerConnection.historyRevert(e)},startHistoryView:function(){mm$("canvas_container").style.opacity=.7,App.hideMapLoading()}},t.default=f}.call(this,n("i8i4"),n("q1tI"))},GlCk:function(e,t,n){"use strict";(function(e){var o=n("Fjee");function i(e){return(i="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function s(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function a(e){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var u=function(t){function n(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);var o=(t=function(e,t){return!t||"object"!==i(t)&&"function"!==typeof t?l(e):t}(this,a(n).call(this,e)))._getAllItems(e.children);return t.state={allItems:o,items:o},t.filter=t.filter.bind(l(t)),t}var u,f,p;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(n,t),u=n,(f=[{key:"_getAllItems",value:function(t){var n=this,o=[];return e.Children.forEach(t,(function(e){e.props&&(o=[].concat(r(o),r(e.props.items||[]),r(n._getAllItems(e.props.children))))})),o}},{key:"renderChildren",value:function(t){var n=this;return e.Children.map(t,(function(t){var o={};return t.props.items&&(o={items:n.state.items}),o.children=n.renderChildren(t.props.children),e.cloneElement(t,o)}))}},{key:"filter",value:function(e,t){var n=this.filterItems(this.state.allItems,t);this.setState({items:n})}},{key:"filterItems",value:function(e,t){var n=this;return(t=t.toLowerCase())&&(e=e.filter((function(e){return e[n.props.filterableAttribute].toLowerCase().indexOf(t)>=0}))),e}},{key:"render",value:function(){var t=this.renderChildren(this.props.children);return e.createElement("div",null,e.createElement(o.a,{placeholder:this.props.placeholder,autoFocus:this.props.autofocus,className:this.props.inputClassName,onChange:this.filter,iconColor:this.props.iconColor}),t)}}])&&s(u.prototype,f),p&&s(u,p),n}(e.Component);u.defaultProps={placeholder:I18n.t("js.search"),iconColor:"grey300"},t.a=u}).call(this,n("q1tI"))},GuLx:function(e,t){window.IdeaVote=Class.create({initialize:function(e){this.idea_id=e.idea_id,this.user=users.findByID(e.user_id,!0),this.vote=e.vote,this.voted_at=e.voted_at?new Date(e.voted_at):new Date},equals:function(e){return this.idea_id===e.idea_id&&this.user.id===e.user.id},toJSON:function(){return{idea_id:this.idea_id,user_id:this.user.id,vote:this.vote,voted_at:this.voted_at}}}),IdeaVote.nodesWithVotes=[],IdeaVote.maxVotes=0,Object.extend(IdeaVote,{NONE:0,UP:1,DOWN:-1,get:function(e,t){return e.votes.find((function(e){return e.user.id===t}))},getByVote:function(e,t){for(var n=e.votes.length,o=[];n>0;){var i=e.votes[--n];i.vote===t&&o.push(i)}return o},updateMaxVoteCount:function(){var e=0;IdeaVote.nodesWithVotes.each((function(t){t&&t.votes.length>e&&(e=t.votes.length)})),IdeaVote.maxVotes=e},updateAll:function(e){e.votes.length>IdeaVote.maxVotes?IdeaVote.maxVotes=e.votes.length:IdeaVote.updateMaxVoteCount(),IdeaVote.nodesWithVotes.each((function(t){t&&t._listener&&t!==e&&t._listener.__onSetProperty("votes",!0)}))}}),IdeaVote.getChangeUser=function(e,t){var n=users.findByID(e.user_id,!0);if("undefined"===typeof n&&t){var o=users.findByID(t.id,!0);"undefined"===typeof o&&(o=new User(t),users.allUsers.push(o),o.setDisplayName(users.allUsers)),n=o}return n}},HKtW:function(e,t,n){"use strict";(function(e){var o=n("Y1fO");function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var s=function(t){var n=t.className,s=t.elementsInRow,a=t.emojis,l=t.onSelect,c=a.map((function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(n,!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e,{onClick:function(){l(e.name)}})}));return e.createElement(o.a,{className:n,elementsInRow:s,items:c})};s.defaultProps={className:"",elementsInRow:9,emojis:[],onSelect:function(){}},t.a=s}).call(this,n("q1tI"))},I01J:function(e,t,n){var o=n("44Ds"),i=500;e.exports=function(e){var t=o(e,(function(e){return n.size===i&&n.clear(),e})),n=t.cache;return t}},I3AD:function(e,t,n){(e.exports=n("JPst")(!0)).push([e.i,'@font-face{font-family:\'Avenir\';font-weight:300;src:local("Avenir Light"),local("Avenir-Light"),url("/fonts/Avenir/Light.woff2") format("woff2"),url("/fonts/Avenir/Light.woff") format("woff")}@font-face{font-family:\'Avenir\';font-weight:400;src:local("Avenir Book"),local("Avenir-Book"),url("/fonts/Avenir/Book.woff2") format("woff2"),url("/fonts/Avenir/Book.woff") format("woff")}@font-face{font-family:\'Avenir\';font-weight:500;src:local("Avenir Medium"),local("Avenir-Medium"),url("/fonts/Avenir/Medium.woff2") format("woff2"),url("/fonts/Avenir/Medium.woff") format("woff")}@font-face{font-family:\'Avenir\';font-weight:700;src:local("Avenir Heavy"),local("Avenir-Heavy"),url("/fonts/Avenir/Heavy.woff2") format("woff2"),url("/fonts/Avenir/Heavy.woff") format("woff")}@font-face{font-family:\'Avenir\';font-weight:900;src:local("Avenir Black"),local("Avenir-Black"),url("/fonts/Avenir/Black.woff2") format("woff2"),url("/fonts/Avenir/Black.woff") format("woff")}@font-face{font-family:\'Avenir Next\';font-weight:300;src:local("Avenir Next Light"),local("AvenirNext-Light"),url("/fonts/AvenirNext/Light.woff2") format("woff2"),url("/fonts/AvenirNext/Light.woff") format("woff")}@font-face{font-family:\'Avenir Next\';font-weight:400;src:local("Avenir Next Regular"),local("AvenirNext-Regular"),url("/fonts/AvenirNext/Regular.woff2") format("woff2"),url("/fonts/AvenirNext/Regular.woff") format("woff")}@font-face{font-family:\'Avenir Next\';font-weight:500;src:local("Avenir Next Medium"),local("AvenirNext-Medium"),url("/fonts/AvenirNext/Medium.woff2") format("woff2"),url("/fonts/AvenirNext/Medium.woff") format("woff")}@font-face{font-family:\'Avenir Next\';font-weight:700;src:local("Avenir Next Demi Bold"),local("AvenirNext-DemiBold"),url("/fonts/AvenirNext/Demi.woff2") format("woff2"),url("/fonts/AvenirNext/Demi.woff") format("woff")}@font-face{font-family:\'Avenir Next\';font-weight:900;src:local("Avenir Next Bold"),local("AvenirNext-Bold"),url("/fonts/AvenirNext/Bold.woff2") format("woff2"),url("/fonts/AvenirNext/Bold.woff") format("woff")}.chat{width:320px;overflow:hidden}.chat .bubble{word-wrap:break-word;max-width:250px;position:relative;padding:5px 15px;border-radius:15px;margin-bottom:5px;display:inline-block}.chat .bubble p{word-break:break-word}.chat .bubble p a{text-decoration:underline}.chat .bubble img{width:20px;height:20px;display:inline-block;vertical-align:text-bottom}.chat .from-me{align-self:flex-end}.chat .from-me .bubble{color:white;background:#0af}.chat .from-me .bubble:before{content:"";position:absolute;z-index:-1;bottom:-2px;right:-5px;height:15px;width:20px;background-color:#0af;border-bottom-left-radius:15px}.chat .from-me .bubble:after{content:"";position:absolute;z-index:1;bottom:-4px;right:-56px;width:26px;height:15px;background:white;border-bottom-left-radius:5px;transform:translate(-30px, -2px)}.chat .from-me .bubble a{color:white}.chat .from-them .bubble{color:#3D474D;background:#F7F9FA}.chat .from-them .bubble:before{content:"";position:absolute;z-index:2;bottom:-2px;left:-7px;height:15px;width:20px;background-color:#F7F9FA;border-bottom-right-radius:15px}.chat .from-them .bubble:after{content:"";position:absolute;z-index:3;bottom:-2px;left:-26px;width:26px;height:15px;background:white;border-bottom-right-radius:5px}#chat_messages img{width:24px;height:24px;display:inline-block}\n',"",{version:3,sources:["/home/mindmeister/server/mymind/releases/20200115114804/app/assets/stylesheets/meisterlabs/0-settings/_fonts.scss","/home/mindmeister/server/mymind/releases/20200115114804/webpack/css/ui/components/chat.scss","/home/mindmeister/server/mymind/releases/20200115114804/app/assets/stylesheets/meisterlabs/0-settings/_colors.scss"],names:[],mappings:"AAEA,WACE,oBAAqB,CACrB,eAAgB,CAChB,+IAIgD,CAGlD,WACE,oBAAqB,CACrB,eAAgB,CAChB,2IAI+C,CAGjD,WACE,oBAAqB,CACrB,eAAgB,CAChB,mJAIiD,CAGnD,WACE,oBAAqB,CACrB,eAAgB,CAChB,+IAIgD,CAGlD,WACE,oBAAqB,CACrB,eAAgB,CAChB,+IAIgD,CAKlD,WACE,yBAA0B,CAC1B,eAAgB,CAChB,gKAIoD,CAGtD,WACE,yBAA0B,CAC1B,eAAgB,CAChB,wKAIsD,CAGxD,WACE,yBAA0B,CAC1B,eAAgB,CAChB,oKAIqD,CAGvD,WACE,yBAA0B,CAC1B,eAAgB,CAChB,qKAImD,CAGrD,WACE,yBAA0B,CAC1B,eAAgB,CAChB,4JAImD,CClGrD,MACE,WAAY,CACZ,eAAgB,CAFlB,cAKI,oBAAqB,CACrB,eAAgB,CAChB,iBAAkB,CAClB,gBAAiB,CACjB,kBAAmB,CACnB,iBAAkB,CAClB,oBAAqB,CAXzB,gBAcM,qBAAsB,CAd5B,kBAiBQ,yBAA0B,CAjBlC,kBAsBM,UAAW,CACX,WAAY,CACZ,oBAAqB,CACrB,0BAA2B,CAzBjC,eA8BI,mBAAoB,CA9BxB,uBAiCM,WAAY,CACZ,eClB2B,CDhBjC,8BAqCQ,UAAW,CACX,iBAAkB,CAClB,UAAW,CACX,WAAY,CACZ,UAAW,CACX,WAAY,CACZ,UAAW,CACX,qBC5ByB,CD6BzB,8BAA+B,CA7CvC,6BAiDQ,UAAW,CACX,iBAAkB,CAClB,SAAU,CACV,WAAY,CACZ,WAAY,CACZ,UAAW,CACX,WAAY,CACZ,gBAAiB,CACjB,6BAA8B,CAC9B,gCAAgC,CA1DxC,yBA8DQ,WAAY,CA9DpB,yBAoEI,aCpE4B,CDqE5B,kBCjE4B,CDJhC,gCAwEM,UAAW,CACX,iBAAkB,CAClB,SAAU,CACV,WAAY,CACZ,SAAU,CACV,WAAY,CACZ,UAAW,CACX,wBC3E0B,CD4E1B,+BAAgC,CAhFtC,+BAoFM,UAAW,CACX,iBAAkB,CAClB,SAAU,CACV,WAAY,CACZ,UAAW,CACX,UAAW,CACX,WAAY,CACZ,gBAAiB,CACjB,8BAA+B,CAChC,mBAKH,UAAW,CACX,WAAY,CACZ,oBAAqB",file:"chat.scss",sourcesContent:["/* Font Definitions */\n\n@font-face {\n  font-family: 'Avenir';\n  font-weight: 300;\n  src:\n    local('Avenir Light'),\n    local('Avenir-Light'),\n    url('/fonts/Avenir/Light.woff2') format('woff2'),\n    url('/fonts/Avenir/Light.woff') format('woff');\n}\n\n@font-face {\n  font-family: 'Avenir';\n  font-weight: 400;\n  src:\n    local('Avenir Book'),\n    local('Avenir-Book'),\n    url('/fonts/Avenir/Book.woff2') format('woff2'),\n    url('/fonts/Avenir/Book.woff') format('woff');\n}\n\n@font-face {\n  font-family: 'Avenir';\n  font-weight: 500;\n  src:\n    local('Avenir Medium'),\n    local('Avenir-Medium'),\n    url('/fonts/Avenir/Medium.woff2') format('woff2'),\n    url('/fonts/Avenir/Medium.woff') format('woff');\n}\n\n@font-face {\n  font-family: 'Avenir';\n  font-weight: 700;\n  src:\n    local('Avenir Heavy'),\n    local('Avenir-Heavy'),\n    url('/fonts/Avenir/Heavy.woff2') format('woff2'),\n    url('/fonts/Avenir/Heavy.woff') format('woff');\n}\n\n@font-face {\n  font-family: 'Avenir';\n  font-weight: 900;\n  src:\n    local('Avenir Black'),\n    local('Avenir-Black'),\n    url('/fonts/Avenir/Black.woff2') format('woff2'),\n    url('/fonts/Avenir/Black.woff') format('woff');\n}\n\n/* Avenir Next */\n\n@font-face {\n  font-family: 'Avenir Next';\n  font-weight: 300;\n  src:\n    local('Avenir Next Light'),\n    local('AvenirNext-Light'),\n    url('/fonts/AvenirNext/Light.woff2') format('woff2'),\n    url('/fonts/AvenirNext/Light.woff') format('woff');\n}\n\n@font-face {\n  font-family: 'Avenir Next';\n  font-weight: 400;\n  src:\n    local('Avenir Next Regular'),\n    local('AvenirNext-Regular'),\n    url('/fonts/AvenirNext/Regular.woff2') format('woff2'),\n    url('/fonts/AvenirNext/Regular.woff') format('woff');\n}\n\n@font-face {\n  font-family: 'Avenir Next';\n  font-weight: 500;\n  src:\n    local('Avenir Next Medium'),\n    local('AvenirNext-Medium'),\n    url('/fonts/AvenirNext/Medium.woff2') format('woff2'),\n    url('/fonts/AvenirNext/Medium.woff') format('woff');\n}\n\n@font-face {\n  font-family: 'Avenir Next';\n  font-weight: 700;\n  src:\n    local('Avenir Next Demi Bold'),\n    local('AvenirNext-DemiBold'),\n    url('/fonts/AvenirNext/Demi.woff2') format('woff2'),\n    url('/fonts/AvenirNext/Demi.woff') format('woff');\n}\n\n@font-face {\n  font-family: 'Avenir Next';\n  font-weight: 900;\n  src:\n    local('Avenir Next Bold'),\n    local('AvenirNext-Bold'),\n    url('/fonts/AvenirNext/Bold.woff2') format('woff2'),\n    url('/fonts/AvenirNext/Bold.woff') format('woff');\n}\n",'/* Chat Window Styles */\n@import "meisterlabs/includes";\n\n.chat {\n  width: 320px;\n  overflow: hidden;\n\n  .bubble {\n    word-wrap: break-word;\n    max-width: 250px;\n    position: relative;\n    padding: 5px 15px;\n    border-radius: 15px;\n    margin-bottom: 5px;\n    display: inline-block;\n\n    p {\n      word-break: break-word;\n\n      a {\n        text-decoration: underline;\n      }\n    }\n\n    img {\n      width: 20px;\n      height: 20px;\n      display: inline-block;\n      vertical-align: text-bottom;\n    }\n  }\n\n  .from-me {\n    align-self: flex-end;\n\n    .bubble {\n      color: white;\n      background: $blue;\n\n      &:before {\n        content: "";\n        position: absolute;\n        z-index: -1;\n        bottom: -2px;\n        right: -5px;\n        height: 15px;\n        width: 20px;\n        background-color: $blue;\n        border-bottom-left-radius: 15px;\n      }\n\n      &:after {\n        content: "";\n        position: absolute;\n        z-index: 1;\n        bottom: -4px;\n        right: -56px;\n        width: 26px;\n        height: 15px;\n        background: white;\n        border-bottom-left-radius: 5px;\n        transform:translate(-30px, -2px);\n      }\n\n      a {\n        color: white;\n      }\n    }\n  }\n\n  .from-them .bubble {\n    color: $grey;\n    background: $grey100;\n\n    &:before {\n      content: "";\n      position: absolute;\n      z-index: 2;\n      bottom: -2px;\n      left: -7px;\n      height: 15px;\n      width: 20px;\n      background-color: $grey100;\n      border-bottom-right-radius: 15px;\n    }\n\n    &:after {\n      content: "";\n      position: absolute;\n      z-index: 3;\n      bottom: -2px;\n      left: -26px;\n      width: 26px;\n      height: 15px;\n      background: white;\n      border-bottom-right-radius: 5px;\n    }\n  }\n}\n\n#chat_messages img {\n  width: 24px;\n  height: 24px;\n  display: inline-block;\n}\n',"/* Grey Tones (Font Colors) */\n\n$grey900               : #333C40;\n$grey700               : #3D474D;\n$grey500               : #8A9499;\n$grey300               : #DCE2E6;\n$grey200               : #EDF1F2;\n$grey100               : #F7F9FA;\n\n$grey                  : $grey700; /* keep this to avoid scss undefined errors until MM19 */\n\n/* Other Colors */\n\n$red                    : #FF4019;\n$orange                 : #FFAA00;\n$yellow                 : #FFD426;\n$banana                 : #FFF2B3;\n$green                  : #3DCC3D;\n$turquoise              : #2BD9D9;\n$blue                   : #00AAFF;\n$navy                   : #4070FF;\n$sky                    : #E6F7FF; /* used for selected items with light blue bg*/\n$purple                 : #A179F2;\n$brown                  : #806040;\n$grass                  : #96DB0B;\n$pink                   : #F7578C;\n\n"]}])},IOzZ:function(e,t){e.exports=function(e,t){return function(n){return null!=n&&(n[e]===t&&(void 0!==t||e in Object(n)))}}},J4oq:function(e,t,n){"use strict";n.r(t);var o=n("aOY9"),i=Class.create({id:null,AvailableProperties:["shape","fill_color","fill_opacity","stroke_color","stroke_width","stroke_style","stroke_opacity"],initialize:function(e){"undefined"!==typeof e&&e.idea_id&&(this.node=tree.root.getChild(e.idea_id)),this.style=new BoundaryStyle(e),this.view=new o.default(this)},__onSetProperties:function(e,t){return this.style.update(e),this.view.redraw(!0),!0},destroy:function(){this.view.destroy()},paint:function(){this.view.drawBoundary()},toJSON:function(){return this.style.toJSON()}});i.SHAPE_BOX=0,i.SHAPE_BOX_ROUND=1,i.SHAPE_CONE=2,i.SHAPE_CONE_ROUND=3,i.SHAPE_CLOUD=4,i.STROKE_SOLID=0,i.STROKE_DASHED=1,i.STROKE_DOTTED=2,t.default=i},JPst:function(e,t,n){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=function(e,t){var n=e[1]||"",o=e[3];if(!o)return n;if(t&&"function"===typeof btoa){var i=(s=o,a=btoa(unescape(encodeURIComponent(JSON.stringify(s)))),l="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(a),"/*# ".concat(l," */")),r=o.sources.map((function(e){return"/*# sourceURL=".concat(o.sourceRoot).concat(e," */")}));return[n].concat(r).concat([i]).join("\n")}var s,a,l;return[n].join("\n")}(t,e);return t[2]?"@media ".concat(t[2],"{").concat(n,"}"):n})).join("")},t.i=function(e,n){"string"===typeof e&&(e=[[null,e,""]]);for(var o={},i=0;i<this.length;i++){var r=this[i][0];null!=r&&(o[r]=!0)}for(var s=0;s<e.length;s++){var a=e[s];null!=a[0]&&o[a[0]]||(n&&!a[2]?a[2]=n:n&&(a[2]="(".concat(a[2],") and (").concat(n,")")),t.push(a))}},t}},Juji:function(e,t){e.exports=function(e,t){return null!=e&&t in Object(e)}},KfNM:function(e,t){var n=Object.prototype.toString;e.exports=function(e){return n.call(e)}},KwMD:function(e,t){e.exports=function(e,t,n,o){for(var i=e.length,r=n+(o?1:-1);o?r--:++r<i;)if(t(e[r],r,e))return r;return-1}},KxBF:function(e,t){e.exports=function(e,t,n){var o=-1,i=e.length;t<0&&(t=-t>i?0:i+t),(n=n>i?i:n)<0&&(n+=i),i=t>n?0:n-t>>>0,t>>>=0;for(var r=Array(i);++o<i;)r[o]=e[o+t];return r}},Kz5y:function(e,t,n){function o(e){return(o="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var i=n("WFqU"),r="object"==("undefined"===typeof self?"undefined":o(self))&&self&&self.Object===Object&&self,s=i||r||Function("return this")();e.exports=s},LboF:function(e,t,n){"use strict";var o,i={},r=function(){return"undefined"===typeof o&&(o=Boolean(window&&document&&document.all&&!window.atob)),o},s=function(){var e={};return function(t){if("undefined"===typeof e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(o){n=null}e[t]=n}return e[t]}}();function a(e,t){for(var n=[],o={},i=0;i<e.length;i++){var r=e[i],s=t.base?r[0]+t.base:r[0],a={css:r[1],media:r[2],sourceMap:r[3]};o[s]?o[s].parts.push(a):n.push(o[s]={id:s,parts:[a]})}return n}function l(e,t){for(var n=0;n<e.length;n++){var o=e[n],r=i[o.id],s=0;if(r){for(r.refs++;s<r.parts.length;s++)r.parts[s](o.parts[s]);for(;s<o.parts.length;s++)r.parts.push(v(o.parts[s],t))}else{for(var a=[];s<o.parts.length;s++)a.push(v(o.parts[s],t));i[o.id]={id:o.id,refs:1,parts:a}}}}function c(e){var t=document.createElement("style");if("undefined"===typeof e.attributes.nonce){var o=n.nc;o&&(e.attributes.nonce=o)}if(Object.keys(e.attributes).forEach((function(n){t.setAttribute(n,e.attributes[n])})),"function"===typeof e.insert)e.insert(t);else{var i=s(e.insert||"head");if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");i.appendChild(t)}return t}var u,f=(u=[],function(e,t){return u[e]=t,u.filter(Boolean).join("\n")});function p(e,t,n,o){var i=n?"":o.css;if(e.styleSheet)e.styleSheet.cssText=f(t,i);else{var r=document.createTextNode(i),s=e.childNodes;s[t]&&e.removeChild(s[t]),s.length?e.insertBefore(r,s[t]):e.appendChild(r)}}function h(e,t,n){var o=n.css,i=n.media,r=n.sourceMap;if(i&&e.setAttribute("media",i),r&&btoa&&(o+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(r))))," */")),e.styleSheet)e.styleSheet.cssText=o;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(o))}}var d=null,m=0;function v(e,t){var n,o,i;if(t.singleton){var r=m++;n=d||(d=c(t)),o=p.bind(null,n,r,!1),i=p.bind(null,n,r,!0)}else n=c(t),o=h.bind(null,n,t),i=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(n)};return o(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;o(e=t)}else i()}}e.exports=function(e,t){(t=t||{}).attributes="object"===typeof t.attributes?t.attributes:{},t.singleton||"boolean"===typeof t.singleton||(t.singleton=r());var n=a(e,t);return l(n,t),function(e){for(var o=[],r=0;r<n.length;r++){var s=n[r],c=i[s.id];c&&(c.refs--,o.push(c))}e&&l(a(e,t),t);for(var u=0;u<o.length;u++){var f=o[u];if(0===f.refs){for(var p=0;p<f.parts.length;p++)f.parts[p]();delete i[f.id]}}}}},M1jG:function(e,t,n){"use strict";(function(e){var o,i=n("2L+8"),r=n("WfvK"),s=n("lLo4"),a=n("ERGR"),l=n("iXwB");function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var u=(c(o={},l.STATUS.CREATING,I18n.t("js.ms_teams_tab.creating_team")),c(o,l.STATUS.LOADING,I18n.t("js.ms_teams_tab.try_in_teams")),c(o,l.STATUS.DISCONNECTED,I18n.t("js.ms_teams_tab.try_in_teams")),c(o,l.STATUS.CONNECTED,I18n.t("js.ms_teams_tab.open_in_teams")),o),f=function(){return e.createElement(i.a,{opts:{name:"msteams",size:20,parentClasses:"mr-8px"}})};t.a=function(t){var n=t.mapId,o=t.onMsTeamsStatusChange,i=t.status,c=t.tabUrl,p=t.readOnly;switch(i){case l.STATUS.DISCONNECTED:return function(t){var n=t.mapId,o=t.onStatusChange;return e.createElement("div",{className:"h-flex-row h-cp",onClick:function(){Amplitude.logEvent("try_teams_footer"),Object(l.onMsTeamsShare)(n,o)}},f(),e.createElement("span",{className:"c-blue td-underline"},u[l.STATUS.DISCONNECTED]))}({mapId:n,onStatusChange:o});case l.STATUS.LOADING:return e.createElement("div",{className:"h-flex-row disabled"},f(),e.createElement("span",{className:"c-grey500"},u[l.STATUS.LOADING]),e.createElement("div",{className:"loading-spinner-16 s-20 ml-8px"}));case l.STATUS.CREATING:return function(t){var n=t.mapId,o=t.onStatusChange,i=[{label:I18n.t("js.cancel"),onClick:function(){return Object(l.cancelCreatingMsTeamsTab)(n,o)}}];return e.createElement(s.a,{position:"above",canAutoPosition:!1,className:"sections",opener:e.createElement(r.a,{icon:f(),className:"disabled",label:u[l.STATUS.CREATING]})},e.createElement(a.a,{items:i}))}({mapId:n,onStatusChange:o});case l.STATUS.CONNECTED:return p?function(t){var n=t.mapId,o=t.tabUrl;return e.createElement("div",{className:"h-flex-row h-cp",onClick:function(){Amplitude.logEvent("open_in_teams"),Object(l.openMsTeamsTab)(n,o)}},f(),e.createElement("span",{className:"c-blue td-underline"},u[l.STATUS.CONNECTED]))}({mapId:n,tabUrl:c}):function(t){var n=t.mapId,o=t.onStatusChange,i=t.tabUrl,c=[{label:I18n.t("js.open"),onClick:function(){Amplitude.logEvent("open_in_teams"),Object(l.openMsTeamsTab)(n,i)}},{label:I18n.t("js.disconnect"),onClick:function(){return Object(l.unlinkMsTeamsTab)(n,o)}}];return e.createElement(s.a,{position:"above",canAutoPosition:!1,className:"sections",opener:e.createElement(r.a,{icon:f(),color:"blue",label:u[l.STATUS.CONNECTED]})},e.createElement(a.a,{items:c}))}({mapId:n,onStatusChange:o,tabUrl:c})}}}).call(this,n("q1tI"))},MGzD:function(e,t,n){var o=n("I3AD");"string"===typeof o&&(o=[[e.i,o,""]]);var i={insert:"head",singleton:!1};n("LboF")(o,i);o.locals&&(e.exports=o.locals)},NykK:function(e,t,n){var o=n("nmnc"),i=n("AP2z"),r=n("KfNM"),s="[object Null]",a="[object Undefined]",l=o?o.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?a:s:l&&l in Object(e)?i(e):r(e)}},O7RO:function(e,t,n){var o=n("CMye"),i=n("7GkX");e.exports=function(e){for(var t=i(e),n=t.length;n--;){var r=t[n],s=e[r];t[n]=[r,s,o(s)]}return t}},P0TD:function(e,t,n){"use strict";n.r(t);var o=n("RdGn"),i=Class.create({dcontainer:null,vnode:null,idea_image:null,loaded:!1,initialize:function(e,t){this.dcontainer=new o.default([t.width(),t.height()]),this.dcontainer.el._listener=e,this.vnode=e,this.dcontainer.el.id=this.vnode.dcontent.el.id+"_image",this.listener=this.onSelect.bindAsEventListener(this),this.idea_image=t,this.dcontainer.makeResizable({onResizeFinished:this.onResizeFinished.bind(this)}),this.toEditMode(),i.all.push(this)},onSelect:function(e){!e||App.config.editable&&!this.dcontainer.isSelected()||(this.showPopup(e),e.stop())},onResizeFinished:function(e,t){this.vnode.node.resizeImage(this.idea_image,e,t)},onUnselect:function(){canvas._imageResizing||this.dcontainer.toInactive()},toEditMode:function(){this.dcontainer.el.observe("click",this.listener)},toViewMode:function(){},show:function(){this.dcontainer.show(this.idea_image.url()),this.loaded=!0},showPopup:function(e){if(!(canvas._imageResizing||e&&Event.element(e)!==this.dcontainer.image)){var t=this.idea_image.url(),n=new Element("img",{id:"tinybox_image",class:"wauto",style:"max-width: 90vw; max-height: 90vh; min-width: "+this.idea_image.size[0]+"px; min-height: "+this.idea_image.size[1]+"px;"});if(this.idea_image.isLinkedMapPreview()){t=t.replace(/medium(\/\d+\/)/,"original$1").replace(/(\?size=)medium/,"$1original");var o=new Element("div",{style:"width: 50vw; height: 50vh;"}),i=MM.ui.LoadingSpinner(64);o.update(i),MM.ui.Lightbox.show(o.outerHTML,0,0,0,0)}n.onload=function(){MM.ui.Lightbox.show(n.outerHTML,0,0,0,0)},n.src=t}}});i.all=[],i.removeImage=function(e){i.all=i.all.without(e)},i.showAll=function(e){for(var t=i.all.length;t>0;){t--;var n=i.all[t];!n.loaded&&n.vnode&&n.vnode.dcontent&&(e||n.vnode.isVisible())&&n.show()}},t.default=i},PYYe:function(e,t,n){"use strict";e.exports=function(e){return String(e).replace(i,r).replace(o,encodeURI)};var o=/(?:[^\x21\x25\x26-\x3B\x3D\x3F-\x5B\x5D\x5F\x61-\x7A\x7E]|%(?:[^0-9A-Fa-f]|[0-9A-Fa-f][^0-9A-Fa-f]|$))+/g,i=/(^|[^\uD800-\uDBFF])[\uDC00-\uDFFF]|[\uD800-\uDBFF]([^\uDC00-\uDFFF]|$)/g,r="$1\ufffd$2"},PjTj:function(e,t,n){"use strict";(function(e){function n(e){return(n="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function i(e){return(i=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function r(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var a=function(t){function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=function(e,t){return!t||"object"!==n(t)&&"function"!==typeof t?r(e):t}(this,i(a).call(this,e))).state={value:e.defaultValue},t._focusField=t._focusField.bind(r(t)),t._handleValueChange=t._handleValueChange.bind(r(t)),t}var l,c,u;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(a,t),l=a,(c=[{key:"_focusField",value:function(){this.props.autoFocus&&this.field.focus()}},{key:"_handleValueChange",value:function(e){var t=e.target.value;this.setState({value:t}),this.props.onChange(e,t)}},{key:"componentDidMount",value:function(){this._focusField()}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.setState({value:e.value})}},{key:"componentDidUpdate",value:function(){this._focusField()}},{key:"render",value:function(){var t=this;return e.createElement("input",{ref:function(e){return t.field=e},type:this.props.type,value:this.state.value||"",className:this.props.className,placeholder:this.props.placeholder,onFocus:this.props.onFocus,onBlur:this.props.onBlur,onChange:this._handleValueChange})}}])&&o(l.prototype,c),u&&o(l,u),a}(e.Component);a.defaultProps={type:"text",defaultValue:"",className:"",onChange:function(){}},t.a=a}).call(this,n("q1tI"))},Pqld:function(e,t,n){"use strict";(function(e){var n=function(t){var n=t.className,o=t.elementLeft,i=t.elementLeftClassName,r=t.elementRight,s=t.elementRightClassName,a=t.title,l=t.titleClassName;return e.createElement("div",{className:"h-flex-row "+n},o?e.createElement("div",{className:i},o):null,e.createElement("div",{className:l},a),r?e.createElement("div",{className:s+" ml-auto"},r):null)};n.defaultProps={title:"",className:"",elementLeftClassName:"",elementRightClassName:"",titleClassName:"title"},t.a=n}).call(this,n("q1tI"))},RdGn:function(e,t,n){"use strict";n.r(t);var o=n("TxdS");function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],o=!0,i=!1,r=void 0;try{for(var s,a=e[Symbol.iterator]();!(o=(s=a.next()).done)&&(n.push(s.value),!t||n.length!==t);o=!0);}catch(l){i=!0,r=l}finally{try{o||null==a.return||a.return()}finally{if(i)throw r}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var r=Class.create({el:null,image:null,initialize:function(e){this.el=new Element("div",{className:"tk_image_container"}),this.imageWrapper=new Element("div",{className:"h-iblock p-r"}),this.image=new Element("img",{className:"tk_image",alt:I18n.t("js.image_not_available"),style:"visibility: hidden;"}),e&&this.setSize(e),this.el.insert(this.imageWrapper.insert(this.image)),this.image.draggable=!1,this.image.onmousedown=function(e){return e.preventDefault(),!1}},show:function(e){this.loadingImage=MM.ui.LoadingSpinner(24),this.loadingImage.title=I18n.t("js.loading_image"),this.el.appendChild(this.loadingImage),Event.observeOnce(this.image,"load",this.onImageLoaded.bind(this)),this.image.src=e},appendActionBtn:function(){if("phantomjs"!==App.config.environment){var e=MM.ui.icon({name:"triangle",size:10,consize:18,color:"grey500",parentClasses:"js-btn-image-action p-a at-5 ar-5 bg-white rad-100% b-1 bc-grey300"});this.imageWrapper.insert(e),this.actionButton=this.imageWrapper.select(".js-btn-image-action")[0],this.actionButton.onclick=this.showContextMenu.bind(this),this.actionButton.oncontextmenu=this.showContextMenu.bind(this)}},showContextMenu:function(e){e.preventDefault(),e.stopPropagation(),o.default&&o.default.show(e)},onImageLoaded:function(){this.loadingImage.remove(),this.image.style.visibility="",show(this.resizeHandle),this.appendActionBtn(),IdeaImage.mapLoadedImages++},makeResizable:function(e){this.resizeHandle=this.imageWrapper.appendChild(new Element("span",{className:"imrhandle"})),hide(this.resizeHandle),this.onMouseDown=this.onResizeStart.bindAsEventListener(this),this.onMouseMove=this.onResize.bindAsEventListener(this),this.onMouseUp=this.onResizeEnd.bindAsEventListener(this),e&&e.onResizeFinished&&(this._onResizeFinished=e.onResizeFinished),Event.observe(this.resizeHandle,"mousedown",this.onMouseDown)},toSelected:function(){addClassName(this.el,"selected")},toInactive:function(){removeClassName(this.el,"selected")},isSelected:function(){return hasClassName(this.el,"selected")},onShiftPressed:function(){var e=i(this.baseSize,2),t=e[0],n=e[1];this.aspectRatio=t/n},onShiftReleased:function(){this.aspectRatio=null},onResizeStart:function(e){this.mouseCoords=[Event.pointerX(e),Event.pointerY(e)],Event.stop(e),addClassName(this.el,"resizing"),Draggables.deactivate(),Event.observe(document,"mousemove",this.onMouseMove),Event.observe(document,"mouseup",this.onMouseUp)},onResize:function(e){canvas._imageResizing=!0,Draggables.deactivate();var t,n,o=Event.pointerX(e)-this.mouseCoords[0],i=Event.pointerY(e)-this.mouseCoords[1];if(canvas.shiftPressed){var r=this.baseSize[0]+o,s=((r/this.aspectRatio+i)*this.aspectRatio+r)/2;t=s.toFixed(0),n=(s/this.aspectRatio).toFixed(0)}else t=this.baseSize[0]+o,n=this.baseSize[1]+i;this.image.style.width="".concat(t>=20?t:20,"px"),this.image.style.height="".concat(n>=20?n:20,"px")},onResizeEnd:function(){setTimeout((function(){canvas._imageResizing=!1}),10),this._onResizeFinished&&(this.baseSize=[this.image.clientWidth,this.image.clientHeight],this._onResizeFinished(this.baseSize[0],this.baseSize[1])),Event.stopObserving(document,"mouseup",this.onMouseUp),Event.stopObserving(document,"mousemove",this.onMouseMove),removeClassName(this.el,"resizing")},setSize:function(e){this.baseSize=e,this.image.style.width=this.baseSize[0]+"px",this.image.style.height=this.baseSize[1]+"px"}});t.default=r},S2r9:function(e,t,n){"use strict";(function(e){var o=n("FW34");function i(e){return(i="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function s(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function a(e){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var u=function(t){function n(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(t=function(e,t){return!t||"object"!==i(t)&&"function"!==typeof t?l(e):t}(this,a(n).call(this,e))).state={tokens:[]},t.removeToken=t.removeToken.bind(l(t)),t}var u,f,p;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(n,t),u=n,(f=[{key:"addToken",value:function(e){var t=[].concat(r(this.state.tokens.filter((function(t){return t.label!==e.label}))),[e]);this.setState({tokens:t})}},{key:"removeToken",value:function(e){var t=this.state.tokens.filter((function(t){return t.label!==e.label||t.value!==e.value}));this.setState({tokens:t}),this.props.onRemoveToken()}},{key:"clear",value:function(){this.setState({tokens:[]})}},{key:"getValue",value:function(e){return this.state.tokens.map((function(t){if(t.type===e)return t.value})).join(",")}},{key:"getCount",value:function(){return this.state.tokens.length}},{key:"render",value:function(){var t=this;return e.createElement("div",{className:"h-flex h-flex-no-shrink"},this.state.tokens.map((function(n,i){return e.createElement(o.a,{key:i,value:n.value,label:n.label,onDelete:t.removeToken})})))}}])&&s(u.prototype,f),p&&s(u,p),n}(e.Component);u.defaultProps={onRemoveToken:function(){}},t.a=u}).call(this,n("q1tI"))},Sxd8:function(e,t,n){var o=n("ZCgT");e.exports=function(e){var t=o(e),n=t%1;return t===t?n?t-n:t:0}},TUoN:function(e,t,n){"use strict";n.r(t);var o=n("P0TD"),i=n("nyiR"),r=n("F6Ed"),s=n("rJb1"),a=n("jjBU"),l=n("d7KX");n("GuLx");window.App={ui:{},SINGLE:0,SHARED:1,MULTI:2,loaded:!1,SCROLLBAR_SIZE:0,SIDEBAR_WIDTH:0,SIDEBAR_HEIGHT:0,GHOST_SIZE:[112,26],config:{POLL_INTERVAL:15,editable:!0,persistent:!0,hasUI:!1,shareMode:null,hide_grid:!1,hide_sidebar:!1,bar_navigator:!0,bar_format:!0,bar_media:!0,bar_extras:!0,tab_extras:0,tab_format:0,bar_design:!0,zoomFactor:1,mapTheme:null,inline_tasks:!0,openedAt:new Date},eventNamespace:"mm:",debugMode:window.location.href.indexOf("mm_debug")>0,requestLog:new l.default(10),initialize:function(e){return Object.extend(this.config,e),this.config["is_"+this.config.viewMode]=!0,this.config.currentlyEditable=this.config.editable,!App.config.noExternals&&MM.utils.badBrowser()&&(MM.ui.dialogs.dialogBrowserWarning()||setTimeout((function(){Message.show(I18n.t("js.please_note_browser_not_supported_link",{v0:'<a href="#" onclick="return MM.ui.openHelp(\'217925788-Supported-browsers\');">',v1:"</a>"}),Message.WARNING,15)}),1e3)),App.hasFeature("fast_poll")&&(this.config.POLL_INTERVAL=5),Icon.default_width=16,Icon.default_height=16,this.SCROLLBAR_SIZE=MM.ui.getScrollBarWidth(),UI.Registry.onResize(),e.hasOwnProperty("teamPreferences")&&Object(a.c)(e.teamPreferences),!0},setPreference:function(e,t){ServerData.isLoggedIn&&!ServerData.user.isAnonymous&&(this.config[e]=t,ServerConnection.setPreference(e,t))},loadMapCode:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;new Ajax.Request("/maps/load_map_code/"+this.config.map_id,{parameters:{view_mode:this.config.viewMode},onSuccess:function(t){this.handleMapCode(t.responseJSON,e)}.bind(this),onFailure:function(){new MM.ui.Activity(I18n.t("js.problem_loading_map",{link1_start:'<a href="'+window.location.href+'">',link1_end:"</a>",link2_start:'<a href="/">',link2_end:"</a>"}),{type:"error",duration:5e4}),setTimeout((function(){window.location.href="/"}),5e4)}.bind(this),onException:function(e,t){MM.error.reportException({exception:t,message:"Error loading map code"})}})},handleMapCode:function(e,t){if("undefined"!==typeof e&&null!==e){this.config=Object.extend(this.config,e.properties),this.config.mapTheme=MapTheme.get(e.map_theme),addClassName(canvas.el,this.config.mapTheme.singleName()+(this.config.mapTheme.is_template?"":this.config.mapTheme.id)),this.config.layout=this.Layouts.get(e.layout),addClassName(canvas.el,"layout_"+this.config.layout.name),canvas.applyThemeDetails(),App.config.mapTheme.line.color&&mapView.hasMapFeature("graphics")&&(i.VGraphics.COLOR="#"+App.config.mapTheme.line.color),e.self_user&&(users.selfUser=new User(e.self_user)),users.allUsers=[],e.all_users.each((function(e){users.addUser(e)})),users.currentUsers=[],e.current_users.each((function(e){users.addCurrentUser(e)}));canvas.loadExternalFonts((function(){ChangeList.executeServerChanges(e.tree_code),App.postLoad(),App.hideMapLoading(),App.config.presentationReceive?Presentation.toggleViewer():App.config.presentationGive&&Presentation.onRemotePresenterStart(),setTimeout((function(){App.initUrlToolbar()}),500)}))}else t<5?this.loadMapCode(t+1):(new MM.ui.Activity(I18n.t("js.problem_loading_map",{link1_start:'<a href="'+window.location.href+'">',link1_end:"</a>",link2_start:'<a href="/">',link2_end:"</a>"}),{type:"error",duration:5e4}),setTimeout((function(){window.location.href="/"}),5e4))},postLoad:function(){var e=this;mapView.initUI&&mapView.initUI(),this.initShareMode(),IdeaVote.updateMaxVoteCount(),IdeaVote.nodesWithVotes.each((function(e){e._listener.__onSetProperty("votes",!1)})),mapView.postLoad();for(var t=document.getElementsByTagName("img"),n=0,o=t.length;n<o;n++){var i=t[n];i.draggable=!1,i.onmousedown=function(e){return e&&e.preventDefault(),!1}}IdeaImage.mapImageCount=0,tree.root.eachChild((function(e){e.idea_image&&IdeaImage.mapImageCount++})),IdeaImage.mapLoadedImages=0,this.subscribe(CustomEvents.TUTORIAL_STOPPED,this.onStopOnboarding.bind(this)),this.subscribe(CustomEvents.TUTORIAL_STARTED,this.onStartOnboarding.bind(this));var r=users.selfUser;if(r&&r.anonymous&&this.config.hasUI&&"default"===this.config.viewMode){this.subscribe(CustomEvents.TOPIC_INSERTED,(function t(){tree.finishedInitialization&&tree.totalNodes()>=20&&(setTimeout((function(){return MM.ui.dialogs.dialogLogin(r)}),1e3),e.unsubscribe(CustomEvents.TOPIC_INSERTED,t))}))}this.config.fromTemplate?this.initTemplateUI():this.initOnboarding()},initTemplateUI:function(){var e=this;n.e(25).then(n.bind(null,"ru1w")).then((function(t){var n=t.default;new Ajax.Request("/templates/"+e.config.fromTemplate+".json",{method:"get",onSuccess:function(e){n.init(e.responseJSON)}})}))},initHints:function(){"phantomjs"!==this.config.environment&&r.default.init()},showAnonymousHint:function(){var e=mm$("postit_anonymous");e&&removeClassName(e,"o-0")},hideAnonymousHint:function(){var e=mm$("postit_anonymous");e&&addClassName(e,"o-0")},initUrlToolbar:function(){var e=MM.utils.Url.getHashParams();e.hasOwnProperty("player")&&!Presentation.on&&App.config.fullscreen?Presentation.togglePresenter():App.config.editable&&e.hasOwnProperty("slideshow")?App.ui.Footer.toggleBar("slideshow"):App.config.editable&&e.hasOwnProperty("history")?App.ui.Footer.toggleBar("history"):e.hasOwnProperty("meistertask")&&mm$("btn_togglemeistertask")?App.ui.Footer.toggleBar("meistertask"):e.hasOwnProperty("print")&&mm$("btn_toggleprint")&&App.ui.Footer.toggleBar("print")},hasFeature:function(e){return App.config.features.indexOf(e)>=0},busy:function(e){var t=mm$("serverstatus");t&&(this.busyTimeout&&clearTimeout(this.busyTimeout),e?(addClassName(t,"busy"),t.title=I18n.t("js.status_updating_changes_from_server"),this.busyTimeout=setTimeout((function(){removeClassName(t,"busy"),addClassName(t,"verybusy"),App.busyTimeout=null}),1e3)):(removeClassName(t,"busy"),removeClassName(t,"verybusy"),t.title=""))},showMapLoading:function(){var e=mm$("map_loading_overlay");e&&(e.style.display="block")},hideMapLoading:function(){var e=mm$("map_loading_overlay");e&&(e.style.display="none")},initShareMode:function(){switch(this.config.shareMode){case this.SINGLE:this.toSingleMode(!0);break;case this.SHARED:this.toSharedMode(!0);break;case this.MULTI:this.toMultiMode(!0)}},toSingleMode:function(e){(e||this.config.shareMode!==this.SINGLE)&&(this.config.shareMode=this.SINGLE,users.removeUsersSelection(),users.removeAllCollaborators(),this.config.editable&&this.config.persistent&&"undefined"!==typeof toolbar&&ServerConnection.syncUndoRedo(),"undefined"!==typeof RevisionBrowser&&!this.config.currentlyEditable&&this.config.persistent&&mm$("revisions")&&RevisionsSlider.enableRevert(),App.trigger(CustomEvents.COLLABORATORS_UPDATED))},toSharedMode:function(e){(e||this.config.shareMode!==this.SHARED)&&(this.config.shareMode=this.SHARED,this.config.editable&&this.config.persistent&&ServerConnection.syncUndoRedo(),"undefined"!==typeof RevisionBrowser&&!this.config.currentlyEditable&&this.config.persistent&&mm$("revisions")&&RevisionsSlider.enableRevert(),App.trigger(CustomEvents.COLLABORATORS_UPDATED))},toMultiMode:function(e){(e||this.config.shareMode!==this.MULTI)&&(this.config.shareMode=this.MULTI,App.trigger(CustomEvents.COLLABORATORS_UPDATED),"embedded"!==App.config.viewMode&&(App.config.editable?Message.show(I18n.t("js.entering_brainstorming_mode"),Message.NOTICE):Message.show(I18n.t("js.you_are_in_view_only_mode")+I18n.t("js.other_users_editing"),Message.NOTICE)),this.config.editable&&this.config.persistent&&ServerConnection.syncUndoRedo(),"undefined"!=typeof RevisionBrowser&&!this.config.currentlyEditable&&mm$("revisions")&&RevisionsSlider.disableRevert())},toEditMode:function(){this.config.editable=!0,UI.Registry.toggleMode("edit")},toViewMode:function(){this.config.editable=!1,UI.Registry.toggleMode("view")},reloadView:function(e){var t=tree.root.countTotalChildren()>50;t&&this.showMapLoading(),setTimeout(function(){this.reloadViewSynchronously(e,t)}.bind(this),100)},reloadViewSynchronously:function(e,t){var n=(canvas.selected?canvas.selected:canvas.root).node;this.config.shareMode*=-1,UI.Registry.remove(canvas),Selections.teardown(),canvas.destroy(),tree.notPainted=!0,rectangleLayouter.elasticLayoutingEnabled=!1,mapView=new Canvas,canvas=mapView,canvas.buildFromModel(),tree.notPainted=null,canvas.root.paint(),rectangleLayouter.updateAll(),rectangleLayouter.elasticLayoutingEnabled=!0,CSS.remove(canvas.el,["transition-duration"]),canvas.checkBounds(),canvas.onRecenter(null,!1),this.config.editable&&this.config.currentlyEditable&&n&&n._listener.select(),this.config.shareMode*=-1,ChangeList.autoLayoutChangeset(),o.default.showAll(!0),IdeaVote.nodesWithVotes.each((function(e){e._listener.__onSetProperty("votes",!1)})),t&&this.hideMapLoading(),e&&e()},destroy:function(){canvas.destroy(),tree.destroy()},googleDrive:function(){return this.config.driveId&&this.config.editable},driveSave:function(){this.googleDrive()&&(this.config.driveRevision>=tree.revision||new Ajax.Request("/external/drive/update/"+this.config.map_id,{onSuccess:function(e){var t=e.responseJSON;t.location?window.location.href=t.location:t.error?Message.show(t.error.message,Message.ERROR):(this.config.driveId=t.map.gid,this.config.driveRevision=t.map.drive_revision)}.bind(this),onFailure:function(){}}))},initOnboarding:function(){var e=this,t=this.config,o=t.environment,i=t.viewMode,r=t.isNew,a=t.editable;o===ServerData.env&&ServerData.isLoggedIn&&a&&"default"===i&&!Presentation.on?s.a.get("onboarding",(function(t){t&&"hide"===t.value||Promise.all([n.e(1),n.e(13),n.e(218),n.e(2),n.e(217)]).then(n.bind(null,"i5ZA")).then((function(t){var n=t.default;r?n.init(n.start.bind(n,{autoStart:!0})):(n.init(),e.trigger(CustomEvents.TUTORIAL_STOPPED))}))})):this.trigger(CustomEvents.TUTORIAL_STOPPED)},onStartOnboarding:function(){r.default.destroy(),this.hideAnonymousHint()},onStopOnboarding:function(){setTimeout(this.showAnonymousHint,1e3),this.initHints(),this.config.isNew&&this.config.editable&&canvas.root.dcontent.toEditing(null,"rename")},trigger:function(e,t){e&&document.fire(this.eventNamespace+e,t)},subscribe:function(e,t){e&&t&&document.observe(this.eventNamespace+e,t)},unsubscribe:function(e,t){e&&t&&document.stopObserving(this.eventNamespace+e,t)},getCustomEventName:function(e){if(e)return(e.eventName||"").replace(this.eventNamespace,"")},titleToURI:function(e){return e?e.toLowerCase().replace(/[^a-z0-9]+/gi," ").trim().replace(/\s+/g,"-").truncate(500,""):e},changeLinkSharing:function(e,t,n){if(this.config.linkShare!==e||this.config.shareLink!==t||this.config.linkShareToken!==n){e&&this.config.shareMode===this.SINGLE&&this.toSharedMode(),this.config.linkShare=e,this.config.shareLink=t,this.config.linkShareToken=n;var o="/"+tree.root.id+(n?"?t="+n:"");history.replaceState(null,"",o)}}}},TiCD:function(e,t,n){var o=n("b+/x"),i=n("jFDo");e.exports=function(e,t,n){if(!e&&!t&&!n)throw new Error("Missing required arguments");if(!o.string(t))throw new TypeError("Second argument must be a String");if(!o.fn(n))throw new TypeError("Third argument must be a Function");if(o.node(e))return function(e,t,n){return e.addEventListener(t,n),{destroy:function(){e.removeEventListener(t,n)}}}(e,t,n);if(o.nodeList(e))return function(e,t,n){return Array.prototype.forEach.call(e,(function(e){e.addEventListener(t,n)})),{destroy:function(){Array.prototype.forEach.call(e,(function(e){e.removeEventListener(t,n)}))}}}(e,t,n);if(o.string(e))return function(e,t,n){return i(document.body,e,t,n)}(e,t,n);throw new TypeError("First argument must be a String, HTMLElement, HTMLCollection, or NodeList")}},TxdS:function(e,t,n){"use strict";n.r(t),function(e,o){var i=n("6acW"),r=n.n(i),s=n("4AML"),a=n("2Dbh"),l=n("39z+"),c=n("HKtW"),u=n("2L+8"),f={init:function(){document.observe("contextmenu",this.show.bindAsEventListener(this)),this.popover=new Popover("nodemenu",this.doActions.bind(this),{observeEvent:"none",offset:[0,0]}),this.iconsPopover=new l.c("iconmenu"),this.initialized=!0},show:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if((!canvas.selected||!canvas.selected.dcontent.isEditing())&&(this._resetPopover(),this.vnode=this.findAffected(t,n),this.vnode||this.type)){App.config.currentlyEditable&&this.vnode&&!this.vnode.isPartiallySelected()&&this.vnode.select();var i=this.getElements();if(0!==i.length){if("icon"===this.type)e.unmountComponentAtNode(this.iconsPopover.widgetContainer),e.render(o.createElement(c.a,{className:"icon-grid ph-10",emojis:i,elementsInRow:Math.min(8,i.length),onSelect:this.doIconActions.bind(this)}),this.iconsPopover.widgetContainer),this.iconsPopover.show();else{switch(this.popover.addElements(i),this.type){case"node":case"root":this._initClipboardButton()}this.popover.options=Object.extend(this.popover.options,{noKeymap:!1}),this.popover.show()}return this.vnode&&canvas.scrollToElement(this.vnode.dcontent.el),!1}}},_initClipboardButton:function(){var e=this;mm$("btn_menu_link_to_topic")&&(this._destroyClipboardButton(),this.clipboardButton=Object(a.a)("#btn_menu_link_to_topic",{text:function(){var t=document.location,n=t.protocol,o=t.host,i=t.search;return"".concat(n,"//").concat(o,"/").concat(e.vnode.node.id).concat(i)},onSuccess:function(){return new MM.ui.Activity(I18n.t("js.link_copied_to_clipboard"),{type:"feedback",icon:{name:"widget-link",color:"grey300"}})}}))},_destroyClipboardButton:function(){this.clipboardButton&&(this.clipboardButton.destroy(),this.clipboardButton=null)},showCustom:function(e,t){this._resetPopover(),this.popover.addElements(e),this.popover.opener=t.opener,this.popover.options=Object.extend(this.popover.options,t),this.popover.show()},findAffected:function(e,t){var n=t.opener||Event.element(e);if(this.type=null,n.hasClassName){if(n.hasClassName("editor")||n.hasClassName("link_preview"))return null;if(n.hasClassName("tk_icon")){this.type="icon";var o=n.parentNode,i=o.parentNode;this.iconsPopover.opener=o;var r=i.select(".tk_icon_container");return this.iconIndex=r.indexOf(o),e.stop&&e.stop(),i._listener}if(Event.findElement(e,".tk_image_container"))return n=Event.findElement(e,".tk_image_container"),this.type="image",this.popover.opener=n,e.stop&&e.stop(),n._listener;if(n.hasClassName("root")||n.up(".root")){this.type="root";var s=canvas.root;this.popover.opener=s.dcontent.el}if(n.className.match(/root_child|node/g)||n.up(".root_child, .node")){this.type="node";s=(n.up(".tk_label")||n)._listener;this.popover.opener=s.dcontent.el}if(s)return e.stop&&e.stop(),s}if(hasAncestor(n,canvas.el)){this.type="canvas",mm$("tk_openerghost")||canvas.el.appendChild(new Element("div",{id:"tk_openerghost"}));var a=e.offsetX||e.layerX,l=e.offsetY||e.layerY;if(n.cumulativeOffset){var c=n.cumulativeOffset();a+=c.left,l+=c.top}this.popover.opener=mm$("tk_openerghost"),this.popover.opener.setStyle({left:a-1+"px",top:l-1+"px"}),e.stop&&e.stop()}return null},getElements:function(){var e=[];if(this.vnode)var t=this.vnode.node;if(!App.config.currentlyEditable)return App.config.showRevisions&&e.push(new Element("a",{href:"#",id:"btn_menu_view_changes"}).update(I18n.t("js.view_changes_on_this_idea"))),e;switch(this.type){case"icon":e.push({name:"remove-icon",title:I18n.t("js.remove_icon"),className:"",element:o.createElement(u.a,{opts:{name:"remove",color:"blue",size:20,parentClasses:"h-iblock va-middle"}})});var n=t.icons[this.iconIndex],i=n.group();if(i)Icon.allInGroup(n.library,i).each((function(n){e.push({name:n.fullName(),className:"lib_".concat(Icon.sectionToString(n.library,n.section)).concat(t.icons.include(n)?" selected":""),element:o.createElement("span",{style:{backgroundPosition:"0 ".concat(24*-n.getSpritePosition(),"px")}})})}));break;case"image":e.push(new Element("a",{href:t.idea_image.download_link,download:"",target:"_blank",id:"btn_menu_save_image","data-handler":"false"}).update(I18n.t("js.save_image"))),e.push(new Element("a",{href:"#",id:"btn_menu_edit_image"}).update(I18n.t("js.editing_image"))),e.push(new Element("a",{href:"#",id:"btn_menu_remove_image"}).update(I18n.t("js.remove_image")));break;case"canvas":e.push(new Element("a",{href:"#",id:"btn_menu_add_topic"}).update(r()(I18n.t("js.add_s",{v0:I18n.t("js.topic").toLowerCase()})))),e.push(new Element("a",{href:"#",id:"btn_menu_add_floating_topic"}).update(I18n.t("js.add_floating_topic"))),e.push(new Element("a",{href:"#",id:"btn_menu_customize_theme"}).update(I18n.t("js.edit_map_theme")));break;default:var a=canvas.allSelected.length>1;if(e.push(new Element("a",{href:"#",id:"btn_menu_cut"}).update(I18n.t("js.cut"))),e.push(new Element("a",{href:"#",id:"btn_menu_copy"}).update(I18n.t("js.copy"))),a||e.push(new Element("a",{href:"#",class:s.default._copied||!t.isRoot()?"":"separator",id:"btn_menu_paste"}).update(I18n.t("js.paste"))),s.default._copied&&e.push(new Element("a",{href:"#",class:"separator",id:"btn_menu_paste_style"}).update(I18n.t("js.paste_style"))),t.isRoot()||e.push(new Element("a",{href:"#",class:"separator",id:"btn_menu_delete"}).update(I18n.t("js.delete"))),a||e.push(new Element("a",{href:"#",id:"btn_menu_edit"}).update(I18n.t("js.edit_caption"))),!t.isRoot()){var l=t.isFloating()?"connect":"disconnect";e.push(new Element("a",{id:"btn_menu_"+l,href:"#",class:a?"":"separator"}).update(I18n.t("js."+l)))}if(!a){var c=new Element("a",{href:"#",class:"subitem separator"}).update(I18n.t("js.show_detail")),f=new Element("ul",{class:"popover submenu menu",style:"display: none"});f.insert(new Element("li").insert(new Element("a",{href:"#",id:"btn_menu_show_detail_1"}).update(I18n.t("js.one_level")))),f.insert(new Element("li").insert(new Element("a",{href:"#",id:"btn_menu_show_detail_2"}).update(I18n.t("js.two_levels")))),f.insert(new Element("li").insert(new Element("a",{href:"#",id:"btn_menu_show_detail_99"}).update(I18n.t("js.all")))),c.insert(f),e.push(c),c=new Element("a",{href:"#",class:"subitem separator"}).update(I18n.t("js.tools")),(f=new Element("ul",{class:"popover submenu menu",style:"display: none"})).insert(new Element("li").insert(new Element("a",{href:"#",id:"btn_menu_view_changes"}).update(I18n.t("js.view_changes_on_this_idea")))),f.insert(new Element("li").insert(new Element("a",{href:"#",id:"btn_menu_copy_as_text"}).update(I18n.t("js.copy_as_text")+"..."))),f.insert(new Element("li").insert(new Element("a",{href:"#",id:"btn_menu_alphabetize"}).update(I18n.t("js.alphabetize")))),t.isRoot()||("external"!=App.config.viewMode&&(f.insert(new Element("li").insert(new Element("a",{href:"#",id:"btn_menu_create_as_map"}).update(I18n.t("js.create_as_map")+"..."))),f.insert(new Element("li").insert(new Element("a",{href:"#",id:"btn_menu_link_to_map"}).update(I18n.t("js.link_to_map")+"...")))),f.insert(new Element("li").insert(new Element("a",{href:"#",id:"btn_menu_split"}).update(I18n.t("js.split")))),f.insert(new Element("li").insert(new Element("a",{href:"#",id:"btn_menu_numbering"}).update(I18n.t("js.numbering"))))),c.insert(f),e.push(c),e.push(new Element("a",{href:"#",id:"btn_menu_link_to_topic"}).update(I18n.t("js.copy_link")))}}return e},doIconActions:function(e){if("remove-icon"===e){var t=this.vnode.node.icons[this.iconIndex];t&&sideBar.icons.removeIcon(t.fullName())}else sideBar.icons.toggleIcon(Icon.get(e))},doActions:function(e){if(0==(e=e.replace("btn_menu_","")).indexOf("show_detail"))e=e.replace("show_detail_",""),canvas.onShowDetail(parseInt(e),!0);else switch(e){case"add_topic":canvas.onAdd(canvas.root);break;case"add_floating_topic":canvas.onAddFloating();break;case"copy_image":case"save_image":break;case"edit_image":sideBar.images.editImage();break;case"remove_image":sideBar.images.removeImage(null,this.vnode.node);break;case"cut":case"copy":s.default.execCommand(e,{onError:MM.ui.dialogs.dialogCopyPasteInfo});break;case"paste":MM.ui.dialogs.dialogCopyPasteInfo();break;case"copy_as_image":case"copy_as_attachment":s.default.onPasteImage(e.replace("copy_as_",""));break;case"paste_style":s.default.onPasteStyle();break;case"delete":canvas.onRemove();break;case"edit":canvas.selected.dcontent.toEditing();break;case"view_changes":MM.ui.dialogs.historyDialog(this.vnode?this.vnode.node.getSingleLineTitle():"");break;case"customize_theme":MM.ui.dialogs.dialogCustomizeTheme({themeId:App.config.mapTheme.id});break;case"copy_as_text":MM.ui.dialogs.dialogTextOutline(canvas.selected.node);break;case"create_as_map":MM.ui.dialogs.dialogPasteAsMap();break;case"link_to_map":MM.ui.dialogs.show("link_topic",{map_id:canvas.selected.node.id,autoSize:!0,onComplete:function(){MM.status.helpTopic="218027868-Add-Links-to-Topics"}});break;case"alphabetize":canvas.onAlphabetize();break;case"numbering":canvas.onNumbering();break;case"split":canvas.onSplitLines();break;case"split_tree":canvas.onSplitTree();break;case"connect":canvas.onConnect();break;case"disconnect":canvas.onDisconnect()}},_resetPopover:function(){this.popover.parent.className="popover submenus menu",this.popover.removeElements()}};t.default=f}.call(this,n("i8i4"),n("q1tI"))},UfWW:function(e,t,n){var o=n("KwMD"),i=n("ut/Y"),r=n("Sxd8"),s=Math.max;e.exports=function(e,t,n){var a=null==e?0:e.length;if(!a)return-1;var l=null==n?0:r(n);return l<0&&(l=s(a+l,0)),o(e,i(t,3),l)}},UrGD:function(e,t,n){"use strict";(function(e){var o=n("Aw6l"),i=n("p+V3"),r=n("x6O/");function s(e){return(s="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var f=function(t){function n(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(t=function(e,t){return!t||"object"!==s(t)&&"function"!==typeof t?c(e):t}(this,l(n).call(this,e))).markAsRead=t.markAsRead.bind(c(t)),t.onFocus=t.onFocus.bind(c(t)),t.keydown=t.keydown.bind(c(t)),t.onBlur=t.onBlur.bind(c(t)),t.submitMessage=t.submitMessage.bind(c(t)),t.resendMessage=t.resendMessage.bind(c(t)),t.update=t.update.bind(c(t)),t.fetchOlderMessages=t.fetchOlderMessages.bind(c(t)),t}var f,p,h;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(n,t),f=n,(p=[{key:"markAsRead",value:function(){r.default.markAsRead(this.props.userID)}},{key:"onFocus",value:function(){this.keymap.enable()}},{key:"keydown",value:function(e){e.shiftKey||this.submitMessage(e.browserEvent)}},{key:"onBlur",value:function(){this.keymap.disable()}},{key:"submitMessage",value:function(e){Event.stop(e);var t=this.input.value;if(t.trim().length>0){var n={text:t,source:"me",user:users.selfUser,user_id:users.selfUser.id};this.input.value="",this.messages.scrollToBottom(),r.default.send(n,this.props.userID)}}},{key:"resendMessage",value:function(e){r.default.send(e,this.props.userID)}},{key:"update",value:function(){this.setState({chat:r.default.getChat(this.state.chat.targetId)})}},{key:"fetchOlderMessages",value:function(){return r.default.getOlderMessages(this.props.userID)}},{key:"onNewMessage",value:function(){this.messages.scrollToBottom()}},{key:"UNSAFE_componentWillMount",value:function(){var e=MM.utils.KeyEvent;this.keymap=new MM.utils.KeyMap(document,"chat_keymap",[{key:[e.RETURN],fn:this.keydown,withEvent:!0,stopEvent:!1}]),this.keymap.disable()}},{key:"render",value:function(){var t=this,n=users.findByID(this.props.userID),s=r.default.getChat(this.props.userID).loading,a=n.isOnline()?"":"o-40",l=n.isOnline()?" (online)":" (offline)";return e.createElement("div",{onClick:this.markAsRead,className:"chat"},e.createElement("div",{className:"h-flex-row justify-sb ph-24 h-64"},e.createElement("div",{className:"h-flex-row h-flex-grow h-flex-shrink"},e.createElement(o.a,{user:n,className:a,tooltip:l}),e.createElement("span",{className:"fs-l ml-13 ellipsis"},n.name.unescapeHTML()))),e.createElement(i.a,{ref:function(e){return t.messages=e},loading:s,resendMessage:this.resendMessage,onScrollTop:this.fetchOlderMessages,messages:this.props.messages}),e.createElement("div",{className:"is-stretched ph-24 h-84 bt-1"},e.createElement("form",{className:"h-100% h-flex-row justify-sb",onSubmit:this.submitMessage},e.createElement("textarea",{ref:function(e){return t.input=e},className:"content-visible h-100% h-flex-grow h-overflow-y lh-160% pr-20 pt-20 pb-10 b-0",placeholder:I18n.t("js.your_message"),maxLength:"255",autoFocus:!0,onFocus:this.onFocus,onBlur:this.onBlur}),e.createElement("input",{type:"submit",className:"button default",value:I18n.t("js.say_it")}))))}}])&&a(f.prototype,p),h&&a(f,h),n}(e.Component);t.a=f}).call(this,n("q1tI"))},WFqU:function(e,t,n){(function(t){function n(e){return(n="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var o="object"==("undefined"===typeof t?"undefined":n(t))&&t&&t.Object===Object&&t;e.exports=o}).call(this,n("yLpj"))},WbBG:function(e,t,n){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},WfvK:function(e,t,n){"use strict";(function(e){var o=n("2L+8"),i=function(t){var n=t.className,i=t.labelClassName,r=t.color,s=t.icon,a=t.label;return e.createElement("div",{className:n},e.createElement("div",{className:"w-100% h-flex-row justify-sb h-cp c-".concat(r)},s,e.createElement("span",{className:i},a),e.createElement(o.a,{className:"pl-5px",opts:{name:"triangle",size:8,color:r}})))};i.defaultProps={color:"grey500"},t.a=i}).call(this,n("q1tI"))},X7v8:function(e,t,n){"use strict";(function(e){var o=n("Aw6l");function i(e){return(i="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function s(e,t){return!t||"object"!==i(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function a(e){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var c=function(t){function n(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(t=s(this,a(n).call(this,e))).state={user:users.findByID(t.props.userId)},t}var i,c,u;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(n,t),i=n,(c=[{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.setState({user:users.findByID(e.userId)})}},{key:"render",value:function(){var t="rad-100% justify-center h-flex-row p-r "+this.props.className,n=this.state.user.isOnline()?"s-24":"o-40 o-hover-100 s-24",i="".concat(this.state.user.isOnline()?" (online)":" (offline)");return this.props.enabled?(n+=" h-cp",i+=" - ".concat(I18n.t("js.click_to_send_message"))):n+=" h-cd",e.createElement("div",{className:t},this.props.unread>0?e.createElement("span",{className:"chat-alert"},this.props.unread):null,e.createElement(o.a,{user:this.state.user,className:n,tooltip:i}))}}])&&r(i.prototype,c),u&&r(i,u),n}(e.Component);c.defaultProps={className:""},t.a=c}).call(this,n("q1tI"))},XWJH:function(e,t,n){var o=n("BIRy");"string"===typeof o&&(o=[[e.i,o,""]]);var i={insert:"head",singleton:!1};n("LboF")(o,i);o.locals&&(e.exports=o.locals)},"Y+p1":function(e,t,n){var o=n("wF/u");e.exports=function(e,t){return o(e,t)}},Y1fO:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return f}));var o=n("Pqld"),i=n("moWC");function r(e){return(r="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function a(e){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var f=function(t){function n(t){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),i=function(e,t){return!t||"object"!==r(t)&&"function"!==typeof t?l(e):t}(this,a(n).call(this,t)),u(l(i),"renderHeader",(function(){if(!i.props.header)return null;var t=i.props.header,n=t.elementLeft,r=t.title,s=t.className,a=t.elementRight,l=t.titleClassName;return e.createElement(o.a,{elementLeft:n,title:r,className:s,elementRight:a,titleClassName:l})})),i.state={items:i.props.items},i.onMouseLeave=i.onMouseLeave.bind(l(i)),i.onMouseEnter=i.onMouseEnter.bind(l(i)),i}var f,p,h;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(n,t),f=n,(p=[{key:"onMouseLeave",value:function(){this.props.onMouseLeave?this.props.onMouseLeave(-1):this.updateSelection(-1)}},{key:"onMouseEnter",value:function(e){this.props.onMouseEnter?this.props.onMouseEnter(e):this.updateSelection(e)}},{key:"unselectAll",value:function(){var e=this.state.items;return e[this.index]&&(e[this.index].highlighted=!1),e}},{key:"updateSelection",value:function(e){var t=this.unselectAll();this.index=e,t[this.index]&&(t[this.index].highlighted=!0),this.setState({allItems:t})}},{key:"componentDidMount",value:function(){this.props.tooltips&&(this._tooltips=MM.ui.ToolTips.touchSafe({el:this.container}))}},{key:"componentWillUnmount",value:function(){this.props.tooltips&&MM.ui.ToolTips.destroyTouchSafe(this._tooltips)}},{key:"render",value:function(){var t=this,n=this.props,o=n.className,r=n.elementsInRow,s=n.gridClassName,a=n.indexStart,l=n.items,c=a||0,u="g-".concat(r," h-flex-grid ").concat(s);return e.createElement("div",{ref:function(e){return t.container=e},className:o},this.renderHeader(),e.createElement("div",{className:u},l.map((function(n,o){return e.createElement(i.a,{key:o,title:n.title,element:n.element,className:n.className,onClick:function(e){return function(e,t){e.preventDefault(),e.nativeEvent.closePopover=!0,t.onClick&&t.onClick()}(e,n)},selected:n.selected,highlighted:n.highlighted,index:c+o,onMouseEnter:t.onMouseEnter,onMouseLeave:t.onMouseLeave})}))))}}])&&s(f.prototype,p),h&&s(f,h),n}(e.Component);u(f,"defaultProps",{className:"h-flex",gridClassName:"",elementsInRow:6})}).call(this,n("q1tI"))},YDNs:function(e,t,n){var o,i,r;function s(e){return(s="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}i=[e,n("gvr7")],void 0===(r="function"===typeof(o=function(e,t){"use strict";var n,o=(n=t)&&n.__esModule?n:{default:n},i="function"===typeof Symbol&&"symbol"===s(Symbol.iterator)?function(e){return s(e)}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":s(e)},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),a=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.resolveOptions(t),this.initSelection()}return r(e,[{key:"resolveOptions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.action=e.action,this.container=e.container,this.emitter=e.emitter,this.target=e.target,this.text=e.text,this.trigger=e.trigger,this.selectedText=""}},{key:"initSelection",value:function(){this.text?this.selectFake():this.target&&this.selectTarget()}},{key:"selectFake",value:function(){var e=this,t="rtl"==document.documentElement.getAttribute("dir");this.removeFake(),this.fakeHandlerCallback=function(){return e.removeFake()},this.fakeHandler=this.container.addEventListener("click",this.fakeHandlerCallback)||!0,this.fakeElem=document.createElement("textarea"),this.fakeElem.style.fontSize="12pt",this.fakeElem.style.border="0",this.fakeElem.style.padding="0",this.fakeElem.style.margin="0",this.fakeElem.style.position="absolute",this.fakeElem.style[t?"right":"left"]="-9999px";var n=window.pageYOffset||document.documentElement.scrollTop;this.fakeElem.style.top=n+"px",this.fakeElem.setAttribute("readonly",""),this.fakeElem.value=this.text,this.container.appendChild(this.fakeElem),this.selectedText=(0,o.default)(this.fakeElem),this.copyText()}},{key:"removeFake",value:function(){this.fakeHandler&&(this.container.removeEventListener("click",this.fakeHandlerCallback),this.fakeHandler=null,this.fakeHandlerCallback=null),this.fakeElem&&(this.container.removeChild(this.fakeElem),this.fakeElem=null)}},{key:"selectTarget",value:function(){this.selectedText=(0,o.default)(this.target),this.copyText()}},{key:"copyText",value:function(){var e=void 0;try{e=document.execCommand(this.action)}catch(t){e=!1}this.handleResult(e)}},{key:"handleResult",value:function(e){this.emitter.emit(e?"success":"error",{action:this.action,text:this.selectedText,trigger:this.trigger,clearSelection:this.clearSelection.bind(this)})}},{key:"clearSelection",value:function(){this.trigger&&this.trigger.focus(),window.getSelection().removeAllRanges()}},{key:"destroy",value:function(){this.removeFake()}},{key:"action",set:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"copy";if(this._action=e,"copy"!==this._action&&"cut"!==this._action)throw new Error('Invalid "action" value, use either "copy" or "cut"')},get:function(){return this._action}},{key:"target",set:function(e){if(void 0!==e){if(!e||"object"!==("undefined"===typeof e?"undefined":i(e))||1!==e.nodeType)throw new Error('Invalid "target" value, use a valid Element');if("copy"===this.action&&e.hasAttribute("disabled"))throw new Error('Invalid "target" attribute. Please use "readonly" instead of "disabled" attribute');if("cut"===this.action&&(e.hasAttribute("readonly")||e.hasAttribute("disabled")))throw new Error('Invalid "target" attribute. You can\'t cut text from elements with "readonly" or "disabled" attributes');this._target=e}},get:function(){return this._target}}]),e}();e.exports=a})?o.apply(t,i):o)||(e.exports=r)},Z0cm:function(e,t){var n=Array.isArray;e.exports=n},Z7WR:function(e,t,n){"use strict";n.r(t);t.default=function(e){e=Array.isArray(e)?e:Object.keys(e);var t={};return e.each((function(e){return t[e]=e})),t}(["CHILD_ADDED","EDIT_MODE_ENTERED","FILE_UPLOAD","ICON_CHANGED","NOTE_CHANGED","SIBLING_ADDED","TASK_ADDED","UNDO","WEB_IMAGE_ADDED","PRESENTATION_MODE_STARTED","PRESENTATION_STARTED","PRESENTATION_STOPPED","ROOT_RENAMED","TOPICS_COPIED","TOPIC_INSERTED","TUTORIAL_STARTED","TUTORIAL_STOPPED","WUNDERBILD_ADDED","TUTORIAL_INTRO_SHOWN","TOPIC_DROPPED","MAP_PROPERTIES_OPENED","TUTORIAL_PART_COMPLETED","LINK_CHANGED","ATTACHMENT_UPLOADED","EXPORT_DLG_OPENED","EXPORT_DLG_CLOSED","HISTORY_MODE_CLOSED","HISTORY_MODE_STARTED","MAP_EXPORTED","MEISTERTASK_BAR_OPENED","EXTERNAL_TASK_CREATED","EXTERNAL_TASK_OPENED","SHARING_POPOVER_OPENED","SHARING_POPOVER_CLOSED","WIDGET_NOTES_SELECTED","WIDGET_ICONS_SELECTED","WIDGET_LINKS_SELECTED","WIDGET_ATTACHMENTS_SELECTED","WIDGET_IMAGES_SELECTED","MEISTERTASK_SHOWN","TRAINING_TIP_SHOWN","POST_LOAD","THEME_CHANGED","COLLABORATORS_UPDATED","CHAT_UPDATE","SIMULATE_TOPIC_PASTED","SELECTED_SLIDE","SLIDE_CREATED"])},ZCgT:function(e,t,n){var o=n("tLB3"),i=1/0,r=17976931348623157e292;e.exports=function(e){return e?(e=o(e))===i||e===-i?(e<0?-1:1)*r:e===e?e:0:0===e?e:0}},ZCpW:function(e,t,n){var o=n("lm/5"),i=n("O7RO"),r=n("IOzZ");e.exports=function(e){var t=i(e);return 1==t.length&&t[0][2]?r(t[0][0],t[0][1]):function(n){return n===e||o(n,e,t)}}},ZWtO:function(e,t,n){var o=n("4uTw"),i=n("9Nap");e.exports=function(e,t){for(var n=0,r=(t=o(t,e)).length;null!=e&&n<r;)e=e[i(t[n++])];return n&&n==r?e:void 0}},aOY9:function(e,t,n){"use strict";n.r(t);var o=n("J4oq"),i=n("nyiR");t.default=Class.create({boundary:null,padding:{top:4,right:6,bottom:4,left:6},offset:{x:0,y:0},initialize:function(e){this.boundary=e},redraw:function(){this.drawBoundary()},drawBoundary:function(){var e=this.boundary,t=e.node,n=e.style,r=t._listener,s=t.isRoot(),a=s||t.closed||!t.hasChildren(),l=App.config.layout.orientation,c=l===App.Layouts.orientation.down||l===App.Layouts.orientation.up,u=n.shape;if((a||c)&&(u===o.default.SHAPE_CONE?u=o.default.SHAPE_BOX:u===o.default.SHAPE_CONE_ROUND&&(u=o.default.SHAPE_BOX_ROUND)),!s&&c)var f=r.dcontainer.el,p=Rectangle.fromPosSize(new Point(canvas.getElementOffset(f)),new Point(getDimensionsAsArray(f))),h=new Rectangle(new Point(p.p1.x,p.p1.y),new Point(p.p2.x,p.p2.y));else if(a){p=Rectangle.fromPosSize(new Point(canvas.getElementOffset(r.dcontent.el)),new Point(getDimensionsAsArray(r.dcontent.el)));if(!s&&r.node.hasChildren()){var d=r.rc.orientation===App.Layouts.orientation.right?{right:12,bottom:5}:{left:10,bottom:5};p.addPadding(d)}h=new Rectangle(new Point(p.p1.x,p.p1.y),new Point(p.p2.x,p.p2.y))}else{var m=r.dcontent.el,v=(p=Rectangle.fromPosSize(new Point(canvas.getElementOffset(m)),new Point(getDimensionsAsArray(m))),r.dchildren.el);h=Rectangle.fromPosSize(new Point(canvas.getElementOffset(v)),new Point(getDimensionsAsArray(v)));Math.abs(p.size().y-h.size().y)<5&&(p.addPadding({bottom:5}),h.addPadding({bottom:5}))}p.addPadding(this.padding),p.shift(this.offset),h.addPadding(this.padding),h.shift(this.offset),this.destroy(),this.path=i.Graphics.drawBoundary(p,h,n,{shape:u,orientation:s?null:r.rc.orientation}),i.Graphics.allBoundaries.set(t.id,this.path),this.visible=!0},translate:function(e){this.path.translate(e.x,e.y)},destroy:function(){this.path&&this.path.remove(),i.Graphics.allBoundaries.unset(this.boundary.node.id)},clear:function(){this.destroy()}})},aZjR:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return k}));var o=n("2L+8"),i=n("G7PK"),r=n("bFRA"),s=n("ERGR"),a=n("rW35"),l=n("lLo4"),c=n("iXwB"),u=n("jjBU");function f(e){return(f="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function d(e,t){if(null==e)return{};var n,o,i=function(e,t){if(null==e)return{};var n,o,i={},r=Object.keys(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function m(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function v(e,t){return!t||"object"!==f(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function b(e){return(b=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function y(e,t){return(y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var g=["Facebook","Twitter","Pinterest"],w=function(){return null},A=function(e,t){var n=tree.root.getRawTitle(),o=App.tree.root.id;return MM.utils.Social.share(e,{async:t,rootId:o,title:n,url:"".concat(document.location.origin,"/").concat(o,"/").concat(App.titleToURI(n))})},_=function(t){var n=t.isPublicMap,i=t.canShare,r=t.mapId,a=t.onPublish;if(n||i){var l=g.map((function(t){return{icon:e.createElement(o.a,{opts:{name:"service-"+t.toLowerCase(),size:20,parentClasses:"rad-5px mr-8px"}}),label:t,onClick:function(){return function(e){var t,n=e.platform,o=e.isPublicMap,i=e.mapId,r=e.onPublish;o?A(n):MM.ui.dialogs.dialogPublishConfirmation(i,{okCallback:function(){return t=A(n,!0)},successCallback:function(){r(),t.win.location.href=t.shareUrl}})}({platform:t,isPublicMap:n,mapId:r,onPublish:a})}}}));return e.createElement(s.a,{header:{title:I18n.t("js.social_media")},items:l,className:"mt-10 mb-15"})}return e.createElement("div",null)},C=function(t,n,i){var r=e.createElement(o.a,{opts:{name:"msteams",size:20,parentClasses:"mr-8px"}}),s=e.createElement("div",{className:"loading-spinner-16 s-20 mr-8px"});switch(n.status){case c.STATUS.CREATING:return{icon:s,label:"".concat(I18n.t("js.ms_teams_tab.creating_team_please_wait")).concat(I18n.t("js.ellipsis")),isDisabled:!0,subMenu:{items:[{label:I18n.t("js.cancel"),onClick:function(e){e.stopPropagation(),Object(c.cancelCreatingMsTeamsTab)(t,i)}}]}};case c.STATUS.CONNECTED:return{icon:r,label:"".concat(I18n.t("js.ms_teams_tab.open_in_microsoft_teams")).concat(I18n.t("js.ellipsis")),onClick:function(){Amplitude.logEvent("open_in_teams"),Object(c.openMsTeamsTab)(t,n.url)},subMenu:n.readOnly?null:{items:[{label:I18n.t("js.disconnect"),onClick:function(e){e.stopPropagation(),Object(c.unlinkMsTeamsTab)(t,i)}}]}};case c.STATUS.LOADING:return{icon:s,label:I18n.t("js.loading"),isDisabled:!0};default:return{icon:r,label:"".concat(I18n.t("js.ms_teams_tab.try_in_microsoft_teams")).concat(I18n.t("js.ellipsis")),onClick:function(e){e.nativeEvent.closePopover=!1,Amplitude.logEvent("try_teams_popover"),Object(c.onMsTeamsShare)(t,i)}}}},E=function(t){var n=t.currentUser,l=t.isPublicMap,c=t.mapId,u=t.msTeamsTabLink,f=t.onMsTeamsStatusChange,p=t.onInvite,h=t.onPublish,d=t.isLinkShareAllowed,m=t.isPublishMapAllowed,v=n.canShare(),b=n.anonymous||!v;return e.createElement("div",null,e.createElement("div",{className:"fs-l fw-medium m-20px mt-10px"},I18n.t("js.share_this_map")),b?null:e.createElement(r.a,{title:I18n.t("js.invite_people"),hideTokenizerHeader:!0,onSubmit:p}),d?e.createElement(i.a,{className:"mb-20",readOnly:b,mapId:c,on:App.config.linkShare,link:App.config.shareLink,onChange:b?w:App.changeLinkSharing.bind(App)}):null,e.createElement(a.a,null,_({isPublicMap:l,canShare:v,mapId:c,onPublish:h}),function(t){var n=t.isPublicMap,i=t.isPublishMapAllowed,r=t.isAnonymous,a=t.mapId,l=t.onPublish,c=t.msTeamsTabLink,u=t.onMsTeamsStatusChange;if(!r){var f=[];if(i){var p=n?I18n.t("js.publishing_settings"):I18n.t("js.publish_map"),h={icon:e.createElement(o.a,{opts:{name:"publish",color:"white",size:12,consize:20,parentClasses:"bg-blue rad-5px mr-8px"}}),label:"".concat(p,"..."),onClick:function(){n?MM.ui.dialogs.dialogPublish(a):MM.ui.dialogs.dialogPublishConfirmation(a,{successCallback:function(){l(),MM.ui.dialogs.dialogPublish(a)}})}};f.push(h)}return f.push({icon:e.createElement(o.a,{opts:{name:"sharing",color:"white",size:12,consize:20,parentClasses:"bg-green rad-5px mr-8px"}}),label:I18n.t("js.sharing_settings")+"...",onClick:function(){return MM.ui.dialogs.dialogSharing(a)}}),c&&!c.showLinkInFooter&&f.push(C(a,c,u)),e.createElement(s.a,{header:{title:I18n.t("js.more")},items:f,className:"mv-10"})}return e.createElement("div",null)}({isPublicMap:l,isPublishMapAllowed:m&&v,isAnonymous:n.anonymous,mapId:c,onPublish:h,msTeamsTabLink:u,onMsTeamsStatusChange:f})))},k=function(t){function n(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(t=v(this,b(n).call(this,e))).state={isLinkShareAllowed:Object(u.b)(u.a.ALLOW_LINK_SHARE),isPublishMapAllowed:Object(u.b)(u.a.ALLOW_PUBLISH)},t}var i,r,s;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&y(e,t)}(n,t),i=n,(r=[{key:"render",value:function(){var t=this.props,n=t.onShow,i=t.onClose,r=d(t,["onShow","onClose"]);return e.createElement(l.a,{position:"above",canAutoPosition:!1,className:"sections",opener:e.createElement("button",{id:"btn_share",className:"button h-flex-row"},e.createElement("span",null,I18n.t("js.share")),e.createElement(o.a,{className:"c-blue pl-5px",opts:{name:"triangle",color:"blue",size:8}})),onShow:n,onClose:i},E(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(n,!0).forEach((function(t){h(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},r,{},this.state)))}}])&&m(i.prototype,r),s&&m(i,s),n}(e.Component)}).call(this,n("q1tI"))},"b+/x":function(e,t){t.node=function(e){return void 0!==e&&e instanceof HTMLElement&&1===e.nodeType},t.nodeList=function(e){var n=Object.prototype.toString.call(e);return void 0!==e&&("[object NodeList]"===n||"[object HTMLCollection]"===n)&&"length"in e&&(0===e.length||t.node(e[0]))},t.string=function(e){return"string"===typeof e||e instanceof String},t.fn=function(e){return"[object Function]"===Object.prototype.toString.call(e)}},bFRA:function(e,t,n){"use strict";(function(e){var o=n("DuKA"),i=n("Pqld");function r(e){return(r="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function a(e){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var u=function(t){function n(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(t=function(e,t){return!t||"object"!==r(t)&&"function"!==typeof t?l(e):t}(this,a(n).call(this,e))).submit=t.submit.bind(l(t)),t}var u,f,p;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(n,t),u=n,(f=[{key:"submit",value:function(e){var t=this;e.preventDefault(),e.stopPropagation();var n=this.widget.getMembers(),o=this.widget.getMembers("share_groups"),i=this.widget.getTokenCount();if(0!==i){var r=this.widget.isViewOnly();MM.ui.disableButton(this.submitButton),new Ajax.Request("/sharing/invite/"+App.config.map_id,{requestHeaders:{Accept:"application/json"},parameters:{collaborators:n,groups:o,send_invitations:!0,permission:r?1:2,message:""},onSuccess:function(e){var n=e.responseJSON,o=n.errors,r=n.users;MM.ui.enableButton(t.submitButton),t.widget.clearTokens();var s=[],a=Message.INFO;o&&(s=o,a=Message.ERROR);var l=i-s.length;l>0&&s.push(I18n.t("js.invitations_sent",{count:l})),Message.show(s.join("<br />"),a),t.props.onSubmit({users:r})},onFailure:function(e){MM.ui.enableButton(t.submitButton),429===e.status?Message.show(I18n.t("js.error_on_invitations_rate_exceeded"),Message.ERROR):Message.show(I18n.t("js.error_on_invitations_try_again_later"),Message.ERROR)}})}}},{key:"render",value:function(){var t=this;return e.createElement("div",{className:"widget-container invitation-widget "+this.props.className},e.createElement(i.a,{title:this.props.title,className:"mt-10 mb-5"}),e.createElement("form",{className:"mb-20",onSubmit:this.submit},e.createElement("div",{className:"h-flex-start"},e.createElement(o.a,{ref:function(e){return t.widget=e},className:"w-200 mr-10",placeholder:I18n.t("js.email_or_name"),hideTokenizerHeader:this.props.hideTokenizerHeader}),e.createElement("input",{ref:function(e){return t.submitButton=e},type:"submit",className:"button default",value:I18n.t("js.invite")}))))}}])&&s(u.prototype,f),p&&s(u,p),n}(e.Component);u.defaultProps={className:"",onSubmit:function(){}},t.a=u}).call(this,n("q1tI"))},bahg:function(e,t){e.exports=function(e){return e.split("")}},d7KX:function(e,t,n){"use strict";function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}n.r(t),n.d(t,"default",(function(){return i}));var i=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._capacity=t||10,this._contents=[]}var t,n,i;return t=e,(n=[{key:"add",value:function(e){this._contents.push(e),this._contents.length>this._capacity&&this._contents.shift()}},{key:"join",value:function(){return this._contents.collect((function(e){return e.toString()})).join("\n\n")}},{key:"empty",value:function(){return 0==this._contents.length}},{key:"first",value:function(){return this._contents[0]}},{key:"last",value:function(){return this._contents[this._contents.length-1]}},{key:"shift",value:function(){return this._contents.shift()}},{key:"unshift",value:function(e){return this._contents.unshift(e)}},{key:"size",value:function(){return this._contents.length}},{key:"toArray",value:function(){return this._contents}}])&&o(t.prototype,n),i&&o(t,i),e}()},dt0z:function(e,t,n){var o=n("zoYe");e.exports=function(e){return null==e?"":o(e)}},eQkx:function(e,t,n){"use strict";(function(e){var o=n("2L+8"),i=n("6r2b"),r=n("fay+"),s=n("s7eh");function a(e){return(a="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var p=function(t){function n(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t=function(e,t){return!t||"object"!==a(t)&&"function"!==typeof t?u(e):t}(this,c(n).call(this,e));var o=e.icon?"grey100":"blue";return t.state={backgroundColor:e.backgroundColor||o},t._enableSubMenu=t._enableSubMenu.bind(u(t)),t._disableSubMenu=t._disableSubMenu.bind(u(t)),t._onMouseEnter=t._onMouseEnter.bind(u(t)),t._onMouseLeave=t._onMouseLeave.bind(u(t)),t._handleClick=t._handleClick.bind(u(t)),t}var p,h,d;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(n,t),p=n,(h=[{key:"_enableSubMenu",value:function(){this.props.disableParentKeyMap&&this.props.disableParentKeyMap()}},{key:"_disableSubMenu",value:function(){this.props.enableParentKeyMap&&this.props.enableParentKeyMap()}},{key:"_onMouseEnter",value:function(e){e.stopPropagation(),e.preventDefault(),this.props.onMouseEnter(this.props.index)}},{key:"_onMouseLeave",value:function(e){e.stopPropagation(),e.preventDefault(),this._disableSubMenu(),this.props.onMouseLeave(this.props.index)}},{key:"_handleClick",value:function(e){this.props.isDisabled||(e.nativeEvent.closePopover=this.props.closePopover,this.props.onClick&&this.props.onClick(e))}},{key:"componentDidMount",value:function(){this.props.subMenu&&(this.keymap=new MM.utils.KeyMap(document,"menu_item_"+(new Date).getTime(),[{key:MM.utils.KeyEvent.RIGHT,fn:this._enableSubMenu},{key:MM.utils.KeyEvent.LEFT,fn:this._disableSubMenu}]),this.keymap.disable())}},{key:"componentWillUnmount",value:function(){this.props.subMenu&&this.keymap&&(this.keymap.disable(),this.keymap=null)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){e.highlighted?this.keymap&&this.keymap.enable():this.keymap&&this.keymap.disable()}},{key:"componentDidUpdate",value:function(){if(this.props.highlighted){for(var e=this.el,t=e.getBoundingClientRect(),n=e.parentElement;(0===n.clientHeight||!Object(s.a)(n))&&n!==document.body;)n=n.parentElement;var o=n.getBoundingClientRect();(t.top+t.height<o.top||t.top+10>o.top+o.height)&&e.scrollIntoView(!1)}}},{key:"render",value:function(){var t,n,s=this;this.props.selected&&(t=e.createElement(o.a,{opts:{name:"checkmark",size:10,color:"blue",classes:"h-a-center",parentClasses:"p-r ml-8",consize:16}})),this.props.subMenu&&(n=e.createElement("div",null,e.createElement(o.a,{opts:{name:"arrow-right",size:10,color:"grey300",classes:"h-a-center",parentClasses:"p-r ml-8",consize:16}}),this.props.selected||this.props.highlighted?e.createElement(i.a,{selectable:this.props.subMenu.selectable,items:this.props.subMenu.items}):null));var a=this.props.highlighted?"bg-"+this.state.backgroundColor:"",l=this.props.isDisabled?"o-50":"",c="list-widget-item p-r h-flex-row minh-32 pv-6 h-cp ".concat(a," ").concat(this.props.itemClassName," ").concat(l);return e.createElement("div",{ref:function(e){return s.el=e},className:c,onClick:this._handleClick,onMouseEnter:this._onMouseEnter,onMouseLeave:this._onMouseLeave},e.createElement(r.a,{parentClassName:"width-100%",className:"ws-nowrap "+this.props.className,style:this.props.style,icon:this.props.icon,label:this.props.label}),t,n)}}])&&l(p.prototype,h),d&&l(p,d),n}(e.Component);p.defaultProps={itemClassName:"",className:""},t.a=p}).call(this,n("q1tI"))},eUgh:function(e,t){e.exports=function(e,t){for(var n=-1,o=null==e?0:e.length,i=Array(o);++n<o;)i[n]=t(e[n],n,e);return i}},"fay+":function(e,t,n){"use strict";(function(e){var n=function(t){var n=t.parentClassName,o=t.className,i=t.style,r=t.label,s=t.icon;return e.createElement("div",{className:"h-flex-row "+n},s,e.createElement("div",{className:o,style:i},r))};n.defaultProps={parentClassName:"",className:"",style:{},label:""},t.a=n}).call(this,n("q1tI"))},fgbg:function(e,t,n){var o={"./app":["TUoN",9],"./app.js":["TUoN",9],"./canvas/canvas":["o8/4",9,16,7,6,15,57],"./canvas/canvas.js":["o8/4",9,16,7,6,15,57],"./canvas/contextMenu":["fvY9",9,139],"./canvas/contextMenu.js":["fvY9",9,139],"./canvas/copyPaste":["4AML",9],"./canvas/copyPaste.js":["4AML",9],"./canvas/layout":["iyru",9,125],"./canvas/layout.js":["iyru",9,125],"./canvas/mapView":["Avrk",9,16,7,6,76],"./canvas/mapView.js":["Avrk",9,16,7,6,76],"./canvas/views/block":["h2DW",9,75],"./canvas/views/block.js":["h2DW",9,75],"./canvas/views/draggable":["Fbyt",9,140],"./canvas/views/draggable.js":["Fbyt",9,140],"./canvas/views/editable":["+c3t",9,113],"./canvas/views/editable.js":["+c3t",9,113],"./canvas/views/editableBlock":["Wd7y",9,141],"./canvas/views/editableBlock.js":["Wd7y",9,141],"./canvas/views/graphics":["nyiR",9],"./canvas/views/graphics.js":["nyiR",9],"./canvas/views/imageBlock":["RdGn",9],"./canvas/views/imageBlock.js":["RdGn",9],"./canvas/views/resizable":["bccC",9,142],"./canvas/views/resizable.js":["bccC",9,142],"./canvas/views/selectable":["LOIY",9,143],"./canvas/views/selectable.js":["LOIY",9,143],"./canvas/views/vboundary":["aOY9",9],"./canvas/views/vboundary.js":["aOY9",9],"./canvas/views/vconnection":["zYya",9,18],"./canvas/views/vconnection.js":["zYya",9,18],"./canvas/views/vconnectionEditor":["r5HS",9,144],"./canvas/views/vconnectionEditor.js":["r5HS",9,144],"./canvas/views/vconnectionHandler":["1Hvr",9,18],"./canvas/views/vconnectionHandler.js":["1Hvr",9,18],"./canvas/views/vgenericNode":["wK+5",9,6,19],"./canvas/views/vgenericNode.js":["wK+5",9,6,19],"./canvas/views/vnode":["YIZm",9,6,19],"./canvas/views/vnode.js":["YIZm",9,6,19],"./canvas/views/vnodeIcon":["H+JK",9,145],"./canvas/views/vnodeIcon.js":["H+JK",9,145],"./canvas/views/vnodeImage":["P0TD",9],"./canvas/views/vnodeImage.js":["P0TD",9],"./canvas/views/vnodeVideo":["Tqv9",9,146],"./canvas/views/vnodeVideo.js":["Tqv9",9,146],"./canvas/views/vroot":["L0S0",9,7,6,86],"./canvas/views/vroot.js":["L0S0",9,7,6,86],"./canvas/views/vrootChild":["7XaY",9,147],"./canvas/views/vrootChild.js":["7XaY",9,147],"./mm/plugins/wundermap":["zg/X",7,26],"./mm/plugins/wundermap.js":["zg/X",7,26],"./models/attachment":["ClT6",9,148],"./models/attachment.js":["ClT6",9,148],"./models/boundary":["J4oq",9],"./models/boundary.js":["J4oq",9],"./models/boundaryStyle":["pddD",9,149],"./models/boundaryStyle.js":["pddD",9,149],"./models/buffer":["d7KX",9],"./models/buffer.js":["d7KX",9],"./models/change":["C9DP",9,7,6,17,69],"./models/change.js":["C9DP",9,7,6,17,69],"./models/chatModel":["x6O/",9],"./models/chatModel.js":["x6O/",9],"./models/connectionModel":["ZlCP",9,7,150],"./models/connectionModel.js":["ZlCP",9,7,150],"./models/font":["iors",9,151],"./models/font.js":["iors",9,151],"./models/iconModel":["fMIU",9,152],"./models/iconModel.js":["fMIU",9,152],"./models/ideaComment":["vpdt",9,155],"./models/ideaComment.js":["vpdt",9,155],"./models/ideaImage":["i5FV",9,156],"./models/ideaImage.js":["i5FV",9,156],"./models/ideaProperty":["z4/t",9,157],"./models/ideaProperty.js":["z4/t",9,157],"./models/ideaVideo":["dYE5",9,158],"./models/ideaVideo.js":["dYE5",9,158],"./models/ideaVote":["GuLx",7],"./models/ideaVote.js":["GuLx",7],"./models/mapTheme":["YLnn",9,126],"./models/mapTheme.js":["YLnn",9,126],"./models/node":["Ij8n",9,7,17,153],"./models/node.js":["Ij8n",9,7,17,153],"./models/poller":["+29S",9,159],"./models/poller.js":["+29S",9,159],"./models/server":["hvl1",9,127],"./models/server.js":["hvl1",9,127],"./models/style":["CO2j",9,160],"./models/style.js":["CO2j",9,160],"./models/task":["fh04",9,161],"./models/task.js":["fh04",9,161],"./models/tree":["iLPW",9,56],"./models/tree.js":["iLPW",9,56],"./models/userModel":["ktz6",9],"./models/userModel.js":["ktz6",9],"./ui/attachmentViewer/view":["TFUZ",9,94],"./ui/attachmentViewer/view.js":["TFUZ",9,94],"./ui/boundaries":["Wsn6",9,23],"./ui/boundaries.js":["Wsn6",9,23],"./ui/customizeBoundary":["2shd",9,107],"./ui/customizeBoundary.js":["2shd",9,107],"./ui/customizeStyle":["8Pqz",9,78],"./ui/customizeStyle.js":["8Pqz",9,78],"./ui/doodling":["PkDF",9,108],"./ui/doodling.js":["PkDF",9,108],"./ui/filter":["A4Hc",9,32],"./ui/filter.js":["A4Hc",9,32],"./ui/footer":["Gkdu",9],"./ui/footer.js":["Gkdu",9],"./ui/footerPublic":["6VjO",9,162],"./ui/footerPublic.js":["6VjO",9,162],"./ui/header":["uE/J",9,31],"./ui/header.js":["uE/J",9,31],"./ui/hints":["F6Ed",9],"./ui/hints.js":["F6Ed",9],"./ui/history/history":["HPVX",9,9,64],"./ui/history/history.js":["HPVX",9,9,64],"./ui/history/revisionsBrowser":["rVqE",9,9],"./ui/history/revisionsBrowser.js":["rVqE",9,9],"./ui/history/revisionsSlider":["O0Ld",9,9],"./ui/history/revisionsSlider.js":["O0Ld",9,9],"./ui/history/slider":["gNXr",9,163],"./ui/history/slider.js":["gNXr",9,163],"./ui/history/utils":["VzPA",9,9],"./ui/history/utils.js":["VzPA",9,9],"./ui/menu":["TxdS",9],"./ui/menu.js":["TxdS",9],"./ui/message":["aUUJ",7,164],"./ui/message.js":["aUUJ",7,164],"./ui/onboarding/hintsPopover":["JPIP",9,13,165],"./ui/onboarding/hintsPopover.js":["JPIP",9,13,165],"./ui/onboarding/progressPopover":["b4lK",9,128],"./ui/onboarding/progressPopover.js":["b4lK",9,128],"./ui/onboarding/tutorial":["i5ZA",9,13,39],"./ui/onboarding/tutorial.js":["i5ZA",9,13,39],"./ui/options":["wNWC",9],"./ui/options.js":["wNWC",9],"./ui/presentation/controls":["601u",7,166],"./ui/presentation/controls.js":["601u",7,166],"./ui/presentation/player":["RQOq",7,167],"./ui/presentation/player.js":["RQOq",7,167],"./ui/presentation/presentation":["hwfg",9,91],"./ui/presentation/presentation.js":["hwfg",9,91],"./ui/presentation/slideshow":["6Nsm",9,74],"./ui/presentation/slideshow.js":["6Nsm",9,74],"./ui/preview":["iX0B",9,65],"./ui/preview.js":["iX0B",9,65],"./ui/print/print":["DTzy",7,168],"./ui/print/print.js":["DTzy",7,168],"./ui/sidebar":["x+1z",9,15,154],"./ui/sidebar.js":["x+1z",9,15,154],"./ui/sidebar/attachmentsWidget":["3cgG",9,106],"./ui/sidebar/attachmentsWidget.js":["3cgG",9,106],"./ui/sidebar/boundariesWidget":["R8jl",9,129],"./ui/sidebar/boundariesWidget.js":["R8jl",9,129],"./ui/sidebar/colorsWidget":["1aen",9,109],"./ui/sidebar/colorsWidget.js":["1aen",9,109],"./ui/sidebar/commentsWidget":["3Uto",9,116],"./ui/sidebar/commentsWidget.js":["3Uto",9,116],"./ui/sidebar/formatWidget":["Zu2b",9,117],"./ui/sidebar/formatWidget.js":["Zu2b",9,117],"./ui/sidebar/iconsWidget":["vTq2",9,79],"./ui/sidebar/iconsWidget.js":["vTq2",9,79],"./ui/sidebar/iconsWidgetExpanded/icon":["S/+i",9,169],"./ui/sidebar/iconsWidgetExpanded/icon.js":["S/+i",9,169],"./ui/sidebar/iconsWidgetExpanded/iconLibrary":["347H",9,130],"./ui/sidebar/iconsWidgetExpanded/iconLibrary.js":["347H",9,130],"./ui/sidebar/iconsWidgetExpanded/iconsWidgetExpanded":["eAEe",9,92],"./ui/sidebar/iconsWidgetExpanded/iconsWidgetExpanded.js":["eAEe",9,92],"./ui/sidebar/imagesWidget":["sfJZ",9,63],"./ui/sidebar/imagesWidget.js":["sfJZ",9,63],"./ui/sidebar/linksWidget":["Vq2u",9,118],"./ui/sidebar/linksWidget.js":["Vq2u",9,118],"./ui/sidebar/notesWidget":["1tAg",9,83],"./ui/sidebar/notesWidget.js":["1tAg",9,83],"./ui/sidebar/stylesWidget":["lBGc",9,131],"./ui/sidebar/stylesWidget.js":["lBGc",9,131],"./ui/sidebar/tabbedWidgetContainer":["uvCM",9,132],"./ui/sidebar/tabbedWidgetContainer.js":["uvCM",9,132],"./ui/sidebar/tasksWidget":["nYGJ",9,82],"./ui/sidebar/tasksWidget.js":["nYGJ",9,82],"./ui/sidebar/videosWidget":["5ehg",9,66],"./ui/sidebar/videosWidget.js":["5ehg",9,66],"./ui/sidebar/widget":["mbwg",9,170],"./ui/sidebar/widget.js":["mbwg",9,170],"./ui/sidebarPublic":["oFg8",9,171],"./ui/sidebarPublic.js":["oFg8",9,171],"./ui/slide":["VQOc",9,119],"./ui/slide.js":["VQOc",9,119],"./ui/styles":["dLnw",9,20],"./ui/styles.js":["dLnw",9,20],"./ui/template/template":["ru1w",9,25],"./ui/template/template.js":["ru1w",9,25],"./ui/template/templatePopover":["wadt",9,172],"./ui/template/templatePopover.js":["wadt",9,172],"./ui/themes":["A6hF",9,21],"./ui/themes.js":["A6hF",9,21],"./ui/users":["fK4Y",9,173],"./ui/users.js":["fK4Y",9,173],"./ui/wheelScroll":["0s9k",9,114],"./ui/wheelScroll.js":["0s9k",9,114],"./ui/zoom":["k8rv",9,93],"./ui/zoom.js":["k8rv",9,93],"./utils/constants":["syde",9,174],"./utils/constants.js":["syde",9,174],"./utils/customEvents":["Z7WR",9],"./utils/customEvents.js":["Z7WR",9],"./utils/googleSearch":["4tVC",9,175],"./utils/googleSearch.js":["4tVC",9,175],"./utils/imageSearch":["B01C",9,84],"./utils/imageSearch.js":["B01C",9,84],"./utils/images":["yQ/X",9,176],"./utils/images.js":["yQ/X",9,176],"./utils/layouter":["Gga9",9,177],"./utils/layouter.js":["Gga9",9,177],"./utils/math":["uvak",9],"./utils/math.js":["uvak",9],"./utils/meistertask/helpers":["n4vn",9,178],"./utils/meistertask/helpers.js":["n4vn",9,178],"./utils/meistertask/meistertask":["vUyb",9,77],"./utils/meistertask/meistertask.js":["vUyb",9,77],"./utils/meistertask/meistertask_picker":["JI7Q",9,179],"./utils/meistertask/meistertask_picker.js":["JI7Q",9,179],"./utils/meistertask/project_creator":["qAcQ",9,120],"./utils/meistertask/project_creator.js":["qAcQ",9,120],"./utils/msTeamsTabLink":["iXwB",9],"./utils/msTeamsTabLink.js":["iXwB",9],"./utils/searchWrapper":["C9l9",9,180],"./utils/searchWrapper.js":["C9l9",9,180],"./utils/skoletube/attachments/attachments":["A0kH",9,24],"./utils/skoletube/attachments/attachments.js":["A0kH",9,24],"./utils/skoletube/attachments/search":["egk4",9,133],"./utils/skoletube/attachments/search.js":["egk4",9,133],"./utils/skoletube/attachments/searchWrapper":["QM5X",9,110],"./utils/skoletube/attachments/searchWrapper.js":["QM5X",9,110],"./utils/skoletube/images/search":["Qh5C",9,134],"./utils/skoletube/images/search.js":["Qh5C",9,134],"./utils/skoletube/mediaSearch":["GcUR",9,181],"./utils/skoletube/mediaSearch.js":["GcUR",9,181],"./utils/skoletube/skoletube":["2lpU",9,14],"./utils/skoletube/skoletube.js":["2lpU",9,14],"./utils/skoletube/videos/search":["a3FK",9,135],"./utils/skoletube/videos/search.js":["a3FK",9,135],"./utils/videoHelpers":["CJ9X",9],"./utils/videoHelpers.js":["CJ9X",9],"./utils/videoSearch":["P2n3",9,90],"./utils/videoSearch.js":["P2n3",9,90]};function i(e){if(!n.o(o,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=o[e],i=t[0];return Promise.all(t.slice(2).map(n.e)).then((function(){return n.t(i,t[1])}))}i.keys=function(){return Object.keys(o)},i.id="fgbg",e.exports=i},gQMU:function(e,t,n){var o=n("0ZTe")("toUpperCase");e.exports=o},gvr7:function(e,t){e.exports=function(e){var t;if("SELECT"===e.nodeName)e.focus(),t=e.value;else if("INPUT"===e.nodeName||"TEXTAREA"===e.nodeName){var n=e.hasAttribute("readonly");n||e.setAttribute("readonly",""),e.select(),e.setSelectionRange(0,e.value.length),n||e.removeAttribute("readonly"),t=e.value}else{e.hasAttribute("contenteditable")&&e.focus();var o=window.getSelection(),i=document.createRange();i.selectNodeContents(e),o.removeAllRanges(),o.addRange(i),t=o.toString()}return t}},hANK:function(e,t,n){"use strict";(function(e,o){var i=n("HKtW"),r=n("39z+"),s=function(e){return(e+"").replace(/([.^$\\(){}|])/g,"\\$1")},a=1,l=3,c=["p","div","pre","form"],u=Class.create({initialize:function(e,t){this.options=t,this.textarea=e,this.editor=t.editor||new Element("div",{class:"comment"}),this.editor.textContent=e.value,this.editor.setAttribute("contenteditable","true"),this.onDocumentClickListener=this.onDocumentClick.bindAsEventListener(this),this.editor.observe("paste",this.onChange.bind(this)),this.editor.observe("keyup",this.onChange.bind(this)),this.editor.observe("blur",function(){var e=window.getSelection();e.rangeCount>0&&(this.selection=e.getRangeAt(0)),document.stopObserving("mousedown",this.onDocumentClickListener),this.onChange()}.bind(this)),this.editor.observe("focus",function(){this.hasFocus=!0,document.observe("mousedown",this.onDocumentClickListener)}.bind(this)),this.onChange(),t.editor||this.textarea.insert({after:this.editor}),this.textarea.hide(),this.buildMenu()},buildMenu:function(){var e=GeneralPopover.get(this.options.menu||this.editor.id+"_emoji");e||(e=new r.c(this.options.menu||this.editor.id+"_emoji",{onShow:this.onShowMenu.bind(this),onClose:function(){setTimeout(function(){this.editor.focus(),MM.utils.addSelection(this.selection)}.bind(this),0)}.bindAsEventListener(this)})),this.menu=e,this.menu.opener=this.options.menuOpener||mm$(this.editor.id+"_emoji"),this.menu.openerListener=this.menu.togglePopover.bindAsEventListener(this.menu),this.menu.register()},onShowMenu:function(){var t=u.config.emojis,n=Object.keys(t).map((function(n){return{name:n=n.replace(/[\(\)]/g,""),element:e.createElement("img",{src:t[n],alt:n})}}));o.render(e.createElement(i.a,{className:"w-300px comments-emojis",emojis:n,onSelect:this.insert.bind(this)}),this.menu.widgetContainer)},onDocumentClick:function(e){var t=Event.findElement(e);this.hasFocus=t===this.editor||Element.ancestors(t).include(this.menu.opener)},onChange:function(){this.textarea.value=function(e){for(var t=[],n=[],o=function(){t.push(n.join("")),n=[]},i=function e(t){if(t.nodeType===l)n.push(t.nodeValue);else if(t.nodeType===a){var i=t.tagName.toLowerCase(),r=-1!==c.indexOf(i);if(r&&n.length&&o(),"img"===i){var s=t.getAttribute("alt")||"";return void(s&&n.push(s))}"br"===i&&o();for(var u=t.childNodes,f=0;f<u.length;f++)e(u[f]);r&&n.length&&o()}},r=0;r<e.length;r++)i(e[r]);return n.length&&o(),t.join("\n")}(this.editor.childNodes),function(e,t){if(document.createEvent){var n=document.createEvent("HTMLEvents");return n.initEvent(t,!0,!0),e.dispatchEvent(n)}if(e.fireEvent)e.fireEvent("on"+t)}(this.textarea,"change")},insert:function(e){this.editor.focus(),this.selection&&(MM.utils.addSelection(this.selection),this.selection=null),MM.utils.replaceSelection("(".concat(e,")")),this.onChange()}});u.createIcon=function(e){var t=e.replace(/[\(\)]/g,""),n=u.config.emojis[t];if("undefined"===typeof n)throw"Emoji: "+t+" is undefined";return'<img src="'+n+'" alt="'+t+'">'},u.linkifyContent=function(e){return e.replace(/(((http|https|mailto):)(?:((?:[\-_.!~*'()a-zA-Z\d;?:@&=+$,]|%[a-fA-F\d]{2})(?:[\-_.!~*'()a-zA-Z\d;\/?:@&=+$,\[\]]|%[a-fA-F\d]{2})*)|(?:(?:\/\/(?:(?:(?:((?:[\-_.!~*'()a-zA-Z\d;:&=+$,]|%[a-fA-F\d]{2})*)@)?(?:((?:(?:[a-zA-Z0-9\-.]|%\h\h)+|\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}|\[(?:(?:[a-fA-F\d]{1,4}:)*(?:[a-fA-F\d]{1,4}|\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})|(?:(?:[a-fA-F\d]{1,4}:)*[a-fA-F\d]{1,4})?::(?:(?:[a-fA-F\d]{1,4}:)*(?:[a-fA-F\d]{1,4}|\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}))?)\]))(?::(\d*))?))?|((?:[\-_.!~*'()a-zA-Z\d$,;:@&=+]|%[a-fA-F\d]{2})+))|(?!\/\/))(\/(?:[\-_.!~*'()a-zA-Z\d:@&=+$,]|%[a-fA-F\d]{2})*(?:;(?:[\-_.!~*'()a-zA-Z\d:@&=+$,]|%[a-fA-F\d]{2})*)*(?:\/(?:[\-_.!~*'()a-zA-Z\d:@&=+$,]|%[a-fA-F\d]{2})*(?:;(?:[\-_.!~*'()a-zA-Z\d:@&=+$,]|%[a-fA-F\d]{2})*)*)*)?)(?:\?((?:[\-_.!~*'()a-zA-Z\d;\/?:@&=+$,\[\]]|%[a-fA-F\d]{2})*))?)(?:\#((?:[\-_.!~*'()a-zA-Z\d;\/?:@&=+$,\[\]]|%[a-fA-F\d]{2})*))?)/g,'<a target="_blank" href="$1">$1</a>')},u.getHTMLContent=function(e){var t=e.gsub("&lt;3","<3").gsub(/(\n|\\n)/,"<br/>");t=u.linkifyContent(t);var n=u.emojisProcessed,o=function(e){n.hasOwnProperty(e)&&(t=t.replace(new RegExp(n[e],"g"),(function(t){return(t.match(/^\s/)?" ":"")+u.createIcon(e)})))};for(var i in n)o(i);return t},u.createProcessedEmojis=function(){this.emojisProcessed={};var e=this.config,t=e.emojis,n=e.emoticons,o=e.emojiSynonym;for(var i in t){var r=[s("("+i+")")];n[i]&&r.push("(^|\\s|>)"+s(n[i])+"(?=\\s|$)"),o[i]&&r.push(s(o[i]));var a=r.map((function(e){return"(".concat(e,")")})).join("|");this.emojisProcessed["(".concat(i,")")]=a}},u.config={path:"",icons:{},defaults:{button:null,buttonLabel:"Emojis",buttonPosition:"after"}},t.a=u}).call(this,n("q1tI"),n("i8i4"))},hgQt:function(e,t,n){var o=n("Juji"),i=n("4sDh");e.exports=function(e,t){return null!=e&&i(e,t,o)}},i1gT:function(e,t,n){"use strict";(function(e){var o=n("2L+8");t.a=function(t){var n,i=t.message,r=t.resendMessage,s=i.text.strip().escapeHTML().replace(/\n/gi,"<br/>"),a=(i.timestamp?new Date(1e3*i.timestamp):new Date).toUIString(),l=i.user_id!==users.selfUser.id?"them":"me";return i.failed&&(n=e.createElement("div",{className:"ta-center mv-10"},e.createElement(o.a,{className:"mb-5 h-iblock",opts:{name:"warning",size:30}}),e.createElement("span",{className:"h-block mb-10"},"Message could not be sent"),e.createElement("a",{onClick:function(){return r(i)},className:"button h-iblock mb-10"},"Resend"))),e.createElement("div",{className:"msg from-"+l},e.createElement("div",{className:"bubble",title:a},e.createElement("p",{dangerouslySetInnerHTML:{__html:EmojiArea.getHTMLContent(s)}}),n))}}).call(this,n("q1tI"))},iXwB:function(e,t,n){"use strict";n.r(t),n.d(t,"STATUS",(function(){return r})),n.d(t,"initMsTeamsTabLink",(function(){return p})),n.d(t,"onMsTeamsShare",(function(){return h})),n.d(t,"openMsTeamsTab",(function(){return d})),n.d(t,"unlinkMsTeamsTab",(function(){return m})),n.d(t,"cancelCreatingMsTeamsTab",(function(){return v}));var o,i=n("oEzx"),r={INIT:"init",CREATING:"creating",LOADING:"loading",DISCONNECTED:"disconnected",CONNECTED:"connected"},s=function(e){return new Promise((function(t){return setTimeout(t,e)}))},a=function(e){var t=e.mapId,n=e.onMsTeamsStatusChange,o=e.onSuccess;new Ajax.Request("/services/ms_teams/teams",{method:"DELETE",parameters:{map_id:t},onSuccess:o,onFailure:function(){Message.show(I18n.t("js.ms_teams_tab.error_occurred_disconnect_unsuccessful"),Message.ERROR,10),n(r.CONNECTED,App.config.msTeamsTabLink.url)}})},l=function e(t){var n=t.mapId,r=t.onSuccess,a=t.onFailure,l=t.counter,c=void 0===l?0:l,u=t.errorCounter,f=void 0===u?0:u;return(o=Object(i.a)(new Promise((function(e,t){(function(e){return new Promise((function(t,n){new Ajax.Request("/services/ms_teams/teams/status",{method:"GET",parameters:{map_id:e},onSuccess:function(e){e.responseJSON.status?t(e.responseJSON.status):n(e.responseJSON||{})},onFailure:function(e){n(e.responseJSON||{})}})}))})(n).then((function(n){return regeneratorRuntime.async((function(o){for(;;)switch(o.prev=o.next){case 0:if(!(c>50||f>8)){o.next=4;break}return o.abrupt("return",t("Error: Retry limit reached"));case 4:if("inProgress"!==n){o.next=7;break}return o.next=7,regeneratorRuntime.awrap(s(5e3));case 7:e(n);case 8:case"end":return o.stop()}}))})).catch((function(e){return t(e)}))})))).promise.then((function(t){if("inProgress"===t)return e({mapId:n,onSuccess:r,onFailure:a,counter:++c,errorCounter:f});"succeeded"===t&&r(t)})).catch((function(t){return regeneratorRuntime.async((function(o){for(;;)switch(o.prev=o.next){case 0:if(!t.error||"AccessDenied"!==t.error.code){o.next=6;break}return o.next=3,regeneratorRuntime.awrap(s(5e3));case 3:return o.abrupt("return",e({mapId:n,onSuccess:r,onFailure:a,counter:++c,errorCounter:++f}));case 6:t.isCanceled||a(t);case 7:case"end":return o.stop()}}))}))},c=function(e){Message.show(I18n.t("js.ms_teams_tab.error_occurred_during_team_creation_try_again"),Message.ERROR,10),e(r.DISCONNECTED)},u=function(e,t){e&&"api_unauthorized"===e.error?Dialog.confirm(I18n.t("js.oauth2.authorization_with_external_service_required"),{okLabel:I18n.t("js.continue"),ok:function(t){t.close(),window.location=e.authUrl},cancel:function(){t(r.DISCONNECTED)}}):c(t)},f=function(e,t){l({mapId:e,onSuccess:function(){return function(e,t){(o=Object(i.a)(new Promise((function(t,n){new Ajax.Request("/services/ms_teams/teams",{method:"GET",parameters:{map_id:e},onSuccess:function(e){return t(e.responseJSON.ms_tab_url)},onFailure:function(e){return n(e.responseJSON||{})}})})))).promise.then((function(e){e?(Message.show(I18n.t("js.ms_teams_tab.team_successfully_created_open_map_in_teams",{link_start:'<a href="'+e+'" target="_blank">',link_end:"</a>"}),Message.NOTICE,30),t(r.CONNECTED,e)):c(t)})).catch((function(e){e.isCanceled||u(e,t)}))}(e,t)},onFailure:function(e){return u(e,t)}})},p=function(e,t,n){t===r.INIT?h(e,n):t===r.CREATING&&f(e,n)},h=function(e,t){t("loading"),new Ajax.Request("/services/ms_teams/teams",{parameters:{map_id:e},onSuccess:function(){Message.show(I18n.t("js.ms_teams_tab.creating_new_team_please_wait"),Message.NOTICE,30),t(r.CREATING),f(e,t)},onFailure:function(e){u(e.responseJSON,t)}})},d=function(e,t){window.open(t,"_blank").focus()},m=function(e,t){Dialog.confirm(I18n.t("js.ms_teams_tab.disconnect_confirmation"),{ok:function(n){n.close(),t(r.LOADING),a({mapId:e,onMsTeamsStatusChange:t,onSuccess:function(){Message.show(I18n.t("js.ms_teams_tab.mind_map_successfully_disconnected"),Message.NOTICE,10),t(r.DISCONNECTED)}})}})},v=function(e,t){t(r.LOADING),o&&o.cancel(),a({mapId:e,onMsTeamsStatusChange:t,onSuccess:function(){t(r.DISCONNECTED)}})}},jFDo:function(e,t,n){var o=n("lNia");function i(e,t,n,o,i){var s=r.apply(this,arguments);return e.addEventListener(n,s,i),{destroy:function(){e.removeEventListener(n,s,i)}}}function r(e,t,n,i){return function(n){n.delegateTarget=o(n.target,t),n.delegateTarget&&i.call(e,n)}}e.exports=function(e,t,n,o,r){return"function"===typeof e.addEventListener?i.apply(null,arguments):"function"===typeof n?i.bind(null,document).apply(null,arguments):("string"===typeof e&&(e=document.querySelectorAll(e)),Array.prototype.map.call(e,(function(e){return i(e,t,n,o,r)})))}},jRMI:function(e,t,n){"use strict";n.r(t);n("TUoN");var o=n("Gkdu"),i=n("wNWC"),r=n("ktz6"),s=(n("GuLx"),n("hANK"));window.sideBar=null,App.ui.Footer=o.default,App.ui.Options=i.default,window.EmojiArea=s.a,window.User=r.UserModel,window.users=r.users},jjBU:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return s}));var o={preferences:{}},i={ALLOW_LINK_SHARE:"allow_link_share",ALLOW_PUBLISH:"allow_publish",ALLOW_ACTIVITY:"allow_activity",USE_FULL_NAMES:"use_full_names"},r=function(e){return!!o.preferences[e]},s=function(e){o.preferences=e}},ktz6:function(e,t,n){"use strict";n.r(t),n.d(t,"UserModel",(function(){return s})),n.d(t,"users",(function(){return a}));var o=n("jjBU");function i(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function r(e){return(r="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var s=Class.create({id:null,color:null,idea_id:null,presentation_step:null,name:null,presenter:!1,anonymous:!1,permission:0,initialize:function(e){this.id=e.id,this.name=(e.name||"").gsub(/&#39;|&apos;|&#x27;/,"'"),this.color=e.color?"#"+e.color:null,this.presenter=e.presenter,this.anonymous=e.anonymous,e.avatar&&("object"===r(e.avatar)&&e.avatar.thumb?(this.avatar=e.avatar.thumb,this.fullsizeAvatar=e.avatar.original):this.avatar=e.avatar),e.idea_id&&(this.idea_id=parseInt(e.idea_id)),e.presentation_step&&(this.presentation_step=parseInt(e.presentation_step)),e.hasOwnProperty("permission")&&(this.permission=e.permission)},canShare:function(){return(this.isOwner()||2===this.permission)&&Object(o.b)(o.a.ALLOW_PUBLISH)},isOwner:function(){return this.id===a.owner.id},isOnline:function(){return this.id===a.selfUser.id||a.currentUsers.indexOf(this)>=0},getNames:function(){if(!this.name)return[];var e=this.name.split(/\s+/);return[].concat(i(e.slice(0,1)),i(e.slice(e.length-1)))},getShortLastname:function(e){var t=this.getNames()[1]?this.getNames()[1].substr(0,1):"",n=!1;return e.length>1&&e.each(function(e){var o=e.getNames();e.id!==this.id&&o[1]&&o[1].substr(0,1)===t&&(n=!0,t=this.getNames()[1])}.bind(this)),t+(!n&&this.getNames()[1].length>1?".":"")},setDisplayName:function(e){if(this.anonymous||Object(o.b)(o.a.USE_FULL_NAMES))this.displayname=this.name;else{var t=this.getNames(),n=[],i=[];e.each((function(e){if(!e.anonymous){var o=e.getNames();t[0]&&o[0]&&t[0]===o[0]&&(n.push(e),t[1]&&o[1]&&t[1]===o[1]&&i.push(e))}})),t[0]?1===n.length||i.length>1&&i.length==n.length?this.displayname=t[0]:n.each(function(e){this.displayname=e.getNames()[1]?e.getNames()[0]+" "+this.getShortLastname(n):e.name}.bind(this)):this.displayname=this.name}},getInitials:function(){return this.getNames().map((function(e){return e.empty()?"":e[0].toUpperCase()})).join("")},getFullsizeAvatar:function(){return this.fullsizeAvatar?this.fullsizeAvatar:this.avatar},getAvatar:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";e="i-avatar h-flex-row justify-center tooltip ".concat(e);var o="".concat(this.name," ").concat(n);if(!this.avatar)return'<div title="'+o+'" class="initials '+e+'"'+(this.color?' style="background-color: '+this.color+'"':"")+"><span>"+this.getInitials()+"</span></div>";var i=t?this.getFullsizeAvatar():this.avatar;return'<div class="'.concat(e,'" title="').concat(o,'" style=\'background-image: url("').concat(i,"\")'></div>")}}),a={selfUser:null,owner:null,currentUsers:[],allUsers:[],_pe:null,updateAfterPoll:function(e){var t=this;if(a.allUsers.each((function(t){e.all_users.find((function(e){return t.id===e.id}))||a.removeCollaborator(t,!0)})),e.all_users.each((function(e){return a.addUser(e,!0)})),e.selfUser&&(a.selfUser=new User(e.selfUser),mm$("self_user_color")&&(mm$("self_user_color").style.backgroundColor=a.selfUser.color)),mapView.hasMapFeature("presentation")){var n=e.current_users.find((function(e){return e.presenter}));n&&(!a.selfUser||a.selfUser&&n.id!==a.selfUser.id)?Presentation.on||Presentation.toggleViewer(n):!n&&Presentation.on&&Presentation.viewer&&Presentation.toggleViewer(),!tree.notPainted&&mapView.hasMapFeature("selection")&&Presentation.on&&Presentation.viewer&&Presentation.updateViewerMode(n)}var o=this.multipleCollaborators(e.current_users);0===this.currentUsers.length&&o?App.toMultiMode():this.currentUsers.length>0&&!o&&App.toSharedMode(),this.removeUsersSelection(),this.currentUsers=[],e.current_users.each((function(e){return t.addCurrentUser(e,!0)})),App.trigger(CustomEvents.COLLABORATORS_UPDATED)},multipleCollaborators:function(e){return e.any((function(e){return 2===e.permission}))},findByID:function(e){return this.allUsers.find((function(t){return t.id===e}))},addUser:function(e,t){var n=this.findByID(e.id);return n?(n.permission=e.permission,n.color="#"+e.color,n.presenter=e.presenter,e.idea_id&&(n.idea_id=e.idea_id)):(n=new User(e),this.allUsers.push(n),n.setDisplayName(this.allUsers)),t||App.trigger(CustomEvents.COLLABORATORS_UPDATED),n},addCurrentUser:function(e,t){var n=this.addUser(e,t);this.currentUsers.find((function(e){return e.id===n.id}))||this.currentUsers.push(n)},removeAllCollaborators:function(){var e=this;this.selfUser&&(this.allUsers.filter((function(t){return t.id!==e.selfUser.id})).each((function(t){return e.removeCollaborator(t,!0)})),this.currentUsers=[this.selfUser])},removeCollaborator:function(e,t){e&&(e.permission=0,t||App.trigger(CustomEvents.COLLABORATORS_UPDATED))},collaborators:function(){return this.allUsers.findAll((function(e){return e.permission>0}))},updateUserSelection:function(){var e=this;mapView.hasMapFeature("selection")&&!Presentation.on&&this.currentUsers.filter((function(t){return!t.anonymous&&2===t.permission&&(!e.selfUser||e.selfUser.id!==t.id)})).each((function(e){var t=tree.root.getChild(e.idea_id);t&&t._listener&&t._listener.selectByUser(e)}))},removeUsersSelection:function(){mapView.hasMapFeature("selection")&&(tree.notPainted||this.currentUsers.each((function(e){if(!e.anonymous&&e.idea_id){var t=tree.root.getChild(e.idea_id);t&&t._listener&&t._listener.unSelectByUser(e)}})))}}},lLo4:function(e,t,n){"use strict";(function(e){var o=n("17x9"),i=n.n(o),r=n("Y+p1"),s=n.n(r);function a(e){return(a="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var d=function(t){function n(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(t=function(e,t){return!t||"object"!==a(t)&&"function"!==typeof t?p(e):t}(this,f(n).call(this,e))).state={active:e.active,visible:e.visible,offset:{horizontal:0,vertical:0},position:e.position},t.sizeAndPosition=t.sizeAndPosition.bind(p(t)),t._toggle=t._toggle.bind(p(t)),t._handleDocumentClick=t._handleDocumentClick.bind(p(t)),t._close=t._close.bind(p(t)),t}var o,i,r;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}(n,t),o=n,(i=[{key:"sizeAndPosition",value:function(){if(this.state.active&&this.props.canAutoPosition){var e=this.container.getBoundingClientRect(),t=this.popover.getBoundingClientRect(),n=document.body.getBoundingClientRect(),o=UI.Registry.viewportOffset,i=this.state.position;e.top+e.height+t.height<n.height-o.bottom?i="bottom":e.top-t.height>o.top?i="above":e.left-t.width>o.left?i="onleft":e.left+e.width+t.width<n.width-o.right&&(i="onright");var r=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(n,!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},this.state.offset);if("bottom"===i||"above"===i){for(var a=this.container;!1===/auto|scroll/.test(getComputedStyle(a,null).getPropertyValue("overflow-y"))&&a!==document.documentElement;)a=a.parentNode;var u=a.getBoundingClientRect();u.right<t.right&&(r.horizontal=Math.ceil(t.right-u.right)+a.offsetWidth-a.clientWidth)}i===this.state.position&&!1!==s()(r,this.state.offset)||this.setState({position:i,offset:r})}}},{key:"_toggle",value:function(e){e.preventDefault(),this.props.disabled||(this.state.active?this._close(e):this._show(e))}},{key:"_handleDocumentClick",value:function(e){var t=e.target;(!Element.ancestors(t).include(this.container)||e.closePopover&&GeneralPopover.getLastOpened()===this)&&this._close(e)}},{key:"_show",value:function(e){var t=this;clearTimeout(this.timer),window.addEventListener("click",this._handleDocumentClick),window.addEventListener("resize",this.sizeAndPosition),this.setState({active:!0,visible:!0});var n=GeneralPopover.getLastOpened();n&&n.close&&n.close(),GeneralPopover.opened.push(this),this.keymap.enable(),this.timer=setTimeout((function(){t.props.onShow(e),"undefined"!==typeof canvas&&canvas&&canvas.removeFocus()}),300)}},{key:"_close",value:function(e){var t=this;clearTimeout(this.timer),this.setState({active:!1}),this.keymap.disable(),this.timer=setTimeout((function(){t.props.onClose(e),t.setState({visible:!1})}),300),this._onClose()}},{key:"_onClose",value:function(){window.removeEventListener("click",this._handleDocumentClick),window.removeEventListener("resize",this.sizeAndPosition),GeneralPopover.remove(this,!0)}},{key:"componentDidMount",value:function(){this.keymap=new MM.utils.KeyMap(document,"keymap_popover",[{key:MM.utils.KeyEvent.ESC,fn:this._close}]),this.keymap.disable()}},{key:"componentWillUnmount",value:function(){this.keymap=null,clearTimeout(this.timer),this.state.active&&this._onClose()}},{key:"componentDidUpdate",value:function(){this.sizeAndPosition()}},{key:"render",value:function(){var t=this,n=this.state,o=n.active,i=n.offset,r=n.position,s=n.visible,a="popover content ".concat(r," ").concat(this.props.className).concat(o?" active":""),l=s?this.props.children:null,c={};return i.horizontal&&(c.arrow={left:"calc(50% + ".concat(i.horizontal,"px")},c.popover={left:"calc(50% - ".concat(i.horizontal,"px")}),e.createElement("div",{ref:function(e){return t.container=e},className:"p-r"},e.createElement("span",{onClick:this._toggle},this.props.opener),e.createElement("div",{ref:function(e){return t.popover=e},className:a,style:c.popover},e.createElement("span",{className:"arrow",style:c.arrow}),l))}}])&&u(o.prototype,i),r&&u(o,r),n}(e.Component);d.propTypes={className:i.a.string,opener:i.a.node.isRequired,children:i.a.node,position:i.a.oneOf(["above","bottom","onleft","onright"]),canAutoPosition:i.a.bool,onShow:i.a.func,onClose:i.a.func},d.defaultProps={position:"bottom",canAutoPosition:!0,className:"",onShow:function(){},onClose:function(){}},t.a=d}).call(this,n("q1tI"))},lNia:function(e,t){var n=9;if("undefined"!==typeof Element&&!Element.prototype.matches){var o=Element.prototype;o.matches=o.matchesSelector||o.mozMatchesSelector||o.msMatchesSelector||o.oMatchesSelector||o.webkitMatchesSelector}e.exports=function(e,t){for(;e&&e.nodeType!==n;){if("function"===typeof e.matches&&e.matches(t))return e;e=e.parentNode}}},"lm/5":function(e,t,n){var o=n("fmRc"),i=n("wF/u"),r=1,s=2;e.exports=function(e,t,n,a){var l=n.length,c=l,u=!a;if(null==e)return!c;for(e=Object(e);l--;){var f=n[l];if(u&&f[2]?f[1]!==e[f[0]]:!(f[0]in e))return!1}for(;++l<c;){var p=(f=n[l])[0],h=e[p],d=f[1];if(u&&f[2]){if(void 0===h&&!(p in e))return!1}else{var m=new o;if(a)var v=a(h,d,p,e,t,m);if(!(void 0===v?i(d,h,r|s,a,m):v))return!1}}return!0}},moWC:function(e,t,n){"use strict";(function(e){var o=n("s7eh");function i(e){return(i="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function a(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var c=function(t){function n(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(t=function(e,t){return!t||"object"!==i(t)&&"function"!==typeof t?a(e):t}(this,s(n).call(this,e)))._onMouseEnter=t._onMouseEnter.bind(a(t)),t._onMouseLeave=t._onMouseLeave.bind(a(t)),t}var c,u,f;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(n,t),c=n,(u=[{key:"_onMouseEnter",value:function(e){e.stopPropagation(),e.preventDefault(),this.props.onMouseEnter(this.props.index)}},{key:"_onMouseLeave",value:function(e){e.stopPropagation(),e.preventDefault(),this.props.onMouseLeave(this.props.index)}},{key:"componentDidUpdate",value:function(){if(this.props.highlighted){for(var e=this.el,t=e.getBoundingClientRect(),n=e.parentElement;(0===n.clientHeight||!Object(o.a)(n))&&n!==document.body;)n=n.parentElement;var i=n.getBoundingClientRect();(t.top+t.height<i.top||t.top+10>i.top+i.height)&&e.scrollIntoView(!1)}}},{key:"render",value:function(){var t=this,n="item "+this.props.className+(this.props.title?" tooltip":"");return(this.props.selected||this.props.highlighted)&&(n+=" selected"),e.createElement("a",{ref:function(e){return t.el=e},href:"#",onMouseEnter:this._onMouseEnter,onMouseLeave:this._onMouseLeave,className:n,title:this.props.title,onClick:this.props.onClick},this.props.element)}}])&&r(c.prototype,u),f&&r(c,f),n}(e.Component);c.defaultProps={className:"",title:""},t.a=c}).call(this,n("q1tI"))},mwIZ:function(e,t,n){var o=n("ZWtO");e.exports=function(e,t,n){var i=null==e?void 0:o(e,t);return void 0===i?n:i}},nmnc:function(e,t,n){var o=n("Kz5y").Symbol;e.exports=o},nyiR:function(e,t,n){"use strict";n.r(t),n.d(t,"Graphics",(function(){return r})),n.d(t,"VGraphics",(function(){return s}));var o=n("uvak"),i=n("J4oq");Element.prototype.triggerEvent=function(e){if(document.createEvent){var t=document.createEvent("MouseEvents");return t.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),this.dispatchEvent(t)}if(this.fireEvent)return this.fireEvent("on"+e)};var r={raphael:null,graphicscontainer:null,connectionstack:new Hash,allBoundaries:new Hash,initialize:function(e,t){"undefined"!=typeof Raphael&&(this.graphicscontainer=document.getElementById("graphics_container"),this.raphael=new Raphael(this.graphicscontainer,parseInt(e),parseInt(t)))},resize:function(e,t){e=parseInt(e),t=parseInt(t),this.raphael&&this.graphicscontainer&&(this.raphael.setSize(e,t),this.graphicscontainer.style.width=e+"px",this.graphicscontainer.style.height=t+"px")},drawPath:function(e,t,n){if(this.raphael){var o=s.COLOR,i="none",r=App.config.mapTheme.lineStrokeWidth();return n=n||1,t&&(i=o),this.raphael.path(e).attr({stroke:o,"stroke-width":r,fill:i,"stroke-linecap":"round",opacity:n})}},drawConnection:function(e,t,n,o,i,s,a,l,c,u){if(this.raphael){var f="#"+u,p={fill:"#FF0000",stroke:"#FF0000",opacity:"0.1"},h=this.raphael.set(this.raphael.circle(i,s,30).attr(p).hide(),this.raphael.circle(a,l,30).attr(p).hide()),d=[["M",i,s],["C",e,t,n,o,a,l]],m=[["M",i,s],["L",e,t],["M",n,o],["L",a,l]],v=App.config.mapTheme.lineStrokeWidth(),b=this.raphael.path(d).attr({stroke:f,"stroke-width":v,"stroke-linecap":"round"});b.click((function(){r.selectConnection(c)}));var y=b.getPointAtLength(b.getTotalLength()/2),g=this.raphael.set(this.raphael.path(m).attr({stroke:"#777777","stroke-opacity":.5}).hide(),this.raphael.circle(i,s,2).attr({stroke:f}).hide(),this.raphael.circle(e,t,2).attr({stroke:"#777777"}).hide(),this.raphael.circle(n,o,2).attr({stroke:"#777777"}).hide()),w=r.getConnectionArrow(g[0]),A=this.raphael.path(w).attr({fill:f,stroke:f});A.click((function(){r.selectConnection(c)})),g[4]=A;var _=this.connectionstack.get(c)||[];return _.push(b,g,h),this.connectionstack.set(c,_),g[1].update=function(e,t){e=parseInt(e),t=parseInt(t);var n=this.attr("cx")+e,o=this.attr("cy")+t;this.attr({cx:n,cy:o}),d[0][1]=n,d[0][2]=o,m[0][1]=n,m[0][2]=o,g[2].update(e,t)},g[2].update=function(e,t){e=parseInt(e),t=parseInt(t);var n=this.attr("cx")+e,o=this.attr("cy")+t;this.attr({cx:n,cy:o}),m[1][1]=n,m[1][2]=o,g[0].attr({path:m});var i=r.getConnectionArrow(g[0]);g[4].attr({path:i}),d[1][1]=n,d[1][2]=o,b.attr({path:d})},g[2].updateAbsolute=function(e,t){var n=e=parseInt(e),o=t=parseInt(t);this.attr({cx:n,cy:o}),m[1][1]=n,m[1][2]=o,g[0].attr({path:m});var i=r.getConnectionArrow(g[0]);g[4].attr({path:i}),d[1][1]=n,d[1][2]=o,b.attr({path:d})},g[3].update=function(e,t){e=parseInt(e),t=parseInt(t);var n=this.attr("cx")+e,o=this.attr("cy")+t;this.attr({cx:n,cy:o}),m[2][1]=n,m[2][2]=o,g[0].attr({path:m});var i=r.getConnectionArrow(g[0]);g[4].attr({path:i}),d[1][3]=n,d[1][4]=o,d[1][5]=i[1][1],d[1][6]=i[1][2],b.attr({path:d})},g[3].updateAbsolute=function(e,t){var n=e=parseInt(e),o=t=parseInt(t);this.attr({cx:n,cy:o}),m[2][1]=n,m[2][2]=o,g[0].attr({path:m});var i=r.getConnectionArrow(g[0]);g[4].attr({path:i}),d[1][3]=n,d[1][4]=o,d[1][5]=i[1][1],d[1][6]=i[1][2],b.attr({path:d})},y}},getConnectionArrow:function(e){if(this.raphael){var t=e.attr("path")[3][1],n=e.attr("path")[3][2],o=e.attr("path"),i=Raphael.angle(o[2][1],o[2][2],o[3][1],o[3][2]),r=Raphael.rad(i),s=[["M",t,n],["L",parseInt(t+-50*Math.cos(r-Math.PI)),parseInt(n+-50*Math.sin(r-Math.PI))]],a=this.raphael.path(s).attr({stroke:"#777777","stroke-dasharray":"."}),l=a.getPointAtLength(18);l.x=parseInt(l.x),l.y=parseInt(l.y);var c=parseInt(l.x+12*Math.cos(r+Math.PI/2)/2),u=parseInt(l.y+12*Math.sin(r+Math.PI/2)/2),f=parseInt(l.x+12*Math.cos(r-Math.PI/2)/2),p=parseInt(l.y+12*Math.sin(r-Math.PI/2)/2),h=[["M",c,u],["L",l.x,l.y],["L",f,p],["L",t,n],["L",c,u,"Z"]];return a.remove(),h}},selectConnection:function(e){var t=mm$("connection_handler_"+e+"_2"),n=mm$("connection_handler_"+e+"_3");t&&n&&(removeClassName(t,"hidden"),removeClassName(n,"hidden"),r.connectionstack.get(e)[1].show())},deselectConnections:function(){$$(".connection_handle").each((function(e){e.addClassName("hidden")})),r.connectionstack.each((function(e){e&&e[1][1].hide()}))},drawBoundaryPreview:function(e,t,n){"undefined"==typeof n&&(n=1),e._raphael=new Raphael(e,72*n,46*n);var o=r.drawBoundary(t.r1,t.r2,t.style,{shape:t.style.shape,orientation:App.Layouts.orientation.right,raphael:e._raphael,cornerRadius:4,cloudSize:10});return 1!=n&&o.scale(n,n,0,0),o},drawBoundary:function(e,t,n,r){var s=r.raphael||this.raphael;if(s){var a=r.shape||n.shape,l={stroke:n.stroke_color?"#"+n.stroke_color:"none","stroke-opacity":null!=n.stroke_opacity?n.stroke_opacity:1,"stroke-width":null!=n.stroke_width?n.stroke_width:0,"stroke-linecap":"round",fill:n.fill_color?"#"+n.fill_color:"none","fill-opacity":null!=n.fill_opacity?n.fill_opacity:1};l["stroke-width"]>0&&(n.stroke_style==i.default.STROKE_DASHED?l["stroke-dasharray"]="-":n.stroke_style==i.default.STROKE_DOTTED&&(l["stroke-dasharray"]=","));var c=e.coords(),u=t.coords();if(a==i.default.SHAPE_BOX||a==i.default.SHAPE_BOX_ROUND)if(r.orientation==App.Layouts.orientation.left)var f=[new Point(u[0].x,Math.min(c[0].y,u[0].y)),new Point(c[1].x,Math.min(c[1].y,u[1].y)),new Point(c[2].x,Math.max(c[2].y,u[2].y)),new Point(u[3].x,Math.max(c[3].y,u[3].y))];else f=[new Point(c[0].x,Math.min(c[0].y,u[0].y)),new Point(u[1].x,Math.min(c[1].y,u[1].y)),new Point(u[2].x,Math.max(c[2].y,u[2].y)),new Point(c[3].x,Math.max(c[3].y,u[3].y))];else if(r.orientation==App.Layouts.orientation.left)f=[c[2],new Point(u[2].x,Math.max(c[2].y,u[2].y)),u[3],u[0],new Point(u[1].x,Math.min(c[1].y,u[1].y)),c[1]];else f=[c[0],new Point(u[0].x,Math.min(c[1].y,u[0].y)),u[1],u[2],new Point(u[3].x,Math.max(c[2].y,u[3].y)),c[3]];var p=s.path(),h=0;switch(a){case i.default.SHAPE_BOX_ROUND:h=r.cornerRadius||10;case i.default.SHAPE_BOX:p=s.rect(f[0].x,f[0].y,f[2].x-f[0].x,f[2].y-f[0].y,h);break;case i.default.SHAPE_CONE:p.moveTo(f[f.length-1].x,f[f.length-1].y);for(var d=0;d<f.length;d++)p.lineTo(f[d].x,f[d].y);break;case i.default.SHAPE_CONE_ROUND:var m,v,b=f;f=[];for(h=r.cornerRadius?2*r.cornerRadius:20,d=0;d<b.length;d++){var y=b[d],g=d>0?b[d-1]:b[b.length-1],w=d<b.length-1?b[d+1]:b[0];m||(m=s.path().moveTo(g.x,g.y).lineTo(y.x,y.y).hide());var A=m.getPointAtLength(m.getTotalLength()-h),_=(v=s.path().moveTo(y.x,y.y).lineTo(w.x,w.y).hide()).getPointAtLength(h);m=v,f.push(A),f.push(_)}p.moveTo(f[0].x,f[0].y);for(d=0;d<b.length;d++){var C=b[d],E=f[2*d],k=f[2*d+1];p.lineTo(E.x,E.y),p.curveTo(C.x,C.y,C.x,C.y,k.x,k.y)}break;case i.default.SHAPE_CLOUD:p.moveTo(f[0].x,f[0].y);var S=t.size();S=Math.max(S.x,S.y);var O=r.cloudSize||25+25*S/1e3;for(d=0;d<f.length;d++){var x=d<f.length-1?f[d+1]:f[0],M=new o.Line(f[d],x).pointsAtInterval(O);M.unshift(f[d]),M.push(x);for(var P=1;P<M.length;P++)p.arcTo(O,O,0,1,M[P].x,M[P].y,0)}}return p.attr(l),p.node.setAttribute("class","tk_boundary"),p}},drawDonutChart:function(e,t,n,o){if(e){e._raphael=e._raphael||new Raphael(e,o.width,o.height),e._raphael.clear();for(var i=0,r=270,s=Math.PI/180,a=o.width/2.5,l=o.width/2,c=0;c<t.length;c++)if(t[c]>0){var u=t[c]/n*360;r+=u;var f="M "+(l+a*Math.cos((270+i)*s))+" "+(l+a*Math.sin((270+i)*s)),p=" A"+a+" "+a+" 0,"+(u>180?1:0)+",1 "+(l+a*Math.cos(r*s)-9e-4)+" "+(l+a*Math.sin(r*s));if(i+=u,o.animate)(h=e._raphael.path("M "+l+" "+l)).animate({path:f+p},500);else var h=e._raphael.path(f+p);h.attr({stroke:o.colors&&o.colors[c]?o.colors[c]:"#00aaff","stroke-width":o.strokeWidth||10,"stroke-opacity":o.strokeOpacity||1})}}}},s=Class.create({rc:null,livePath:null,rootPath:null,childrenPath:null,childrenPathRoot:null,_partialChildrenPath:"",initialize:function(e){this.rc=e},destroy:function(){this.livePath&&this.livePath.remove(),this.rootPath&&this.rootPath.remove(),this.childrenPath&&this.childrenPath.remove(),this.childrenPathRoot&&(this.childrenPathRoot=null),this.rc=null},roundNumber:function(e){return parseInt(e)},redrawLines:function(){this.rc.vnode.node.isVisible()&&(this._redrawLinesForNode(this.rc.vnode),this.redrawRootLine())},translateLines:function(){if(this.childrenPathRoot){var e=this.rc.vnode.getContainerRCOffset(),t=this.rc.vnode._horizontalLine,n=Math.offset(t[0],e),o=this.rc.vnode.dcontainer.el.cumulativeOffset()[1]+n[1]-this.childrenPathRoot.y;this.childrenPath&&this.childrenPath.translate(0,o),this.childrenPathRoot.y+=o}return this.rootPath&&(this.rootPath.remove(),this.rootPath=null),this.redrawRootLine(),o},_redrawLinesForNode:function(e){for(var t=e;"undefined"!==typeof t&&t&&!t.node.isRootC()&&t.parent;)t=t.parent;var n,o,i,s,a,l=t.node.id,c=e.node.id,u=e.getContainerRCOffset(),f=e._horizontalLine,p=Math.offset(f[0],u),h=Math.offset(f[1],u),d=e.dopener.size()[0]/2,m=this.rc.vnode.dcontainer.el.cumulativeOffset(),v=0;switch(e.node.currentStyle().boxStyle){case Style.boxStraight:v=0;break;case Style.boxRound:v=8;break;case Style.boxVRound:v=12}if(a=m[0]+p[0],s=m[1]+h[1],i=h[0]-p[0],this.rc.orientation===App.Layouts.orientation.left?(n=p,o=h,0===e.children.length&&e.node.currentStyle().backgroundColor&&(a+=v,i-=v),t===e&&e.node.isFloating()&&"org_chart"!==App.config.layout.name&&(i-=v)):(n=App.config.layout.orientation===App.Layouts.orientation.down||App.config.layout.orientation===App.Layouts.orientation.up?p:h,o=p,!e.node.isRootC()||0!==e.children.length||App.config.layout.orientation!==App.Layouts.orientation.down&&App.config.layout.orientation!==App.Layouts.orientation.up||(a+=d,i-=d),t===e&&e.node.isFloating()&&"org_chart"!==App.config.layout.name&&(a+=d,i-=d)),a=this.roundNumber(a),s=this.roundNumber(s),i=this.roundNumber(i),this._partialChildrenPath+="M"+a+" "+s+" l"+i+" 0 ",!e.node.closed)for(var b=0,y=e.children.length;b<y;b++){var g=e.children[b],w=this._redrawLinesForNode(g),A=this.roundNumber(m[0]+w[0]),_=this.roundNumber(m[1]+w[1]),C=this.roundNumber(.8*(n[0]-w[0])),E=this.roundNumber(.2*(n[1]-w[1])),k=this.roundNumber(n[0]-w[0]),S=this.roundNumber(n[1]-w[1]);switch(App.config.layout.getLineStyle()){case MapTheme.lineStraight:this._partialChildrenPath+="M"+A+" "+_+" l"+k+" "+S+" ";break;case MapTheme.lineOrganicCurve:case MapTheme.lineCurve:this._partialChildrenPath+="M"+A+" "+_+" q"+C+" "+E+" "+k+" "+S+" ";break;case MapTheme.lineStraightCorner:this._partialChildrenPath+="M"+A+","+_+"l"+k+",0l0,"+S+" "}}return c===l&&(this.childrenPath&&this.childrenPath.remove(),this.childrenPath=r.drawPath(this._partialChildrenPath,!1),this.childrenPath.node.setAttribute("class","tk_line"),this.childrenPathRoot={y:s},this._partialChildrenPath=""),o},redrawRootLine:function(e,t){this.livePath&&(this.livePath.remove(),this.livePath=null),this.rootPath&&this.rootPath.remove();var n=this.rc.vnode.node;if("undefined"===typeof t&&n.isFloating()||t)this.rootPath=null;else{var i=this.rc.vnode.dcontent.getPosition(),s=this.rc.vnode.node.pos?this.rc.vnode.node.pos[0]:0,a=this.rc.vnode.lineCoordinates(e),l=this.rc.vnode.dcontainer.el.cumulativeOffset(),c=canvas.el.cumulativeOffset(),u=Math.negativeOffset(l,c);u=Math.offset(u,a);var f=canvas.root.getCenter(),p=[0,0],h=[f[0]-u[0],f[1]-u[1]],d=[Math.abs(u[0]-f[0]),Math.abs(u[1]-f[1])],m=[];u[0]>f[0]||App.config.layout.orientation===App.Layouts.orientation.down||App.config.layout.orientation===App.Layouts.orientation.up?(p[0]=u[0]-f[0],h[0]=0,u[0]=f[0],m[0]=parseInt(.2*d[0])):m[0]=-parseInt(.2*d[0]),u[1]>f[1]||App.config.layout.orientation===App.Layouts.orientation.down?(p[1]=u[1]-f[1],h[1]=0,u[1]=f[1],m[1]=d[1]):m[1]=-d[1];var v=[f[0],f[1]],b=[u[0]+p[0]-f[0],u[1]+p[1]-f[1]],y=[m[0],m[1]];if("live"===e){var g=this.rc.vnode.dcontent.el.clientWidth,w=0;(s+i[0]+g>=0&&s+i[0]+g/2<=0||s+i[0]<0&&s+i[0]+g/2>=0)&&(w=(s+i[0]+g)/-1,b[0]+=w)}var A=this.roundNumber(y[0]),_=this.roundNumber(y[1]),C=this.roundNumber(b[0]),E=this.roundNumber(b[1]),k=this.roundNumber(v[0]),S=this.roundNumber(v[1]);"undefined"!=App.config.is_embedded&&App.config.is_embedded&&MM.ua.isBrowser("Firefox")&&(E-=1);var O="M"+k+" "+S+" q"+A+" "+_+" "+C+" "+E+" ",x=!1,M=App.config.layout.getLineStyle();if(M===MapTheme.lineOrganicCurve){if("live"==e)return this.livePath&&this.livePath.remove(),this.livePath=r.drawPath(O,!1,.5),void this.livePath.node.setAttribute("class","tk_line live");x=!0;var P,j=new o.Line(new Point(p),new Point(h)).slope(),N=App.ui.Zoom.getZoomFactor(),I="M"+k+" "+S+" q"+A+" "+_+" "+C+" "+E+"  Q"+(k+A)+" "+(S+_)+" "+(k-(P=null==j||Math.abs(j)>2?[[1,0],[2,0],[3,0],[5,0]]:Math.abs(j)<.5?[[0,1],[0,2],[0,3],[0,5]]:j<0?[[-1,-1],[1,1],[2,1],[3,2]]:[[1,-1],[-1,1],[-2,1],[-3,2]])[3][0]*N)+" "+(S-P[3][1]*N)+" "}else if(M===MapTheme.lineStraight)I="M"+k+" "+S+" l"+C+" "+E+" ";else if(M===MapTheme.lineCurve)I=O;else{if(M!==MapTheme.lineStraightCorner)return;var T=canvas.root.dcontent.el.offsetHeight,B=parseInt(T/2+15);C+=parseInt(this.rc.vnode.dcontent.el.offsetWidth/2),[App.Layouts.orientation.down,App.Layouts.orientation.up].indexOf(App.config.layout.orientation)>=0&&(E-=this.rc.vnode.dcontent.el.offsetHeight,C+=8);I="M"+k+","+S+"l0,"+B+"l"+C+",0l0,"+(E-B)+" "}this.rootPath=r.drawPath(I,x),this.rootPath.node.setAttribute("class","tk_line root")}}});s.ZOOM_LINE_WIDTH=2,s.COLOR="#d6dbde"},oEzx:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var o=function(e){var t=!1;return{promise:new Promise((function(n,o){e.then((function(e){return t?o({isCanceled:!0}):n(e)}),(function(e){return o(t?{isCanceled:!0}:e)}))})),cancel:function(){t=!0}}}},"p+V3":function(e,t,n){"use strict";(function(e){var o=n("Fw71"),i=n("AGWK"),r=n("0qNx");function s(e){return(s="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function l(e,t){return!t||"object"!==s(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var f=function(t){function n(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(t=l(this,c(n).call(this,e))).height=0,t.stick=!0,t.stickToBottom=!0,t.state={loadingMessages:!0},t}var s,f,p;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(n,t),s=n,(f=[{key:"componentDidMount",value:function(){this.wrapper.scrollTop=this.chat.offsetHeight,this.scrollToBottom(),this.setState({loadingMessages:!1})}},{key:"componentDidUpdate",value:function(){if(this.stick){if(this.height!==this.chat.offsetHeight&&!this.state.loadingMessages){var e=this.chat.offsetHeight-this.height;this.wrapper.scrollTop=e,this.stick=!1}}else this.stickToBottom&&(this.wrapper.scrollTop=this.chat.offsetHeight,this.stickToBottom=!1);this.height=this.chat.offsetHeight}},{key:"UNSAFE_componentWillReceiveProps",value:function(){this.setState({loadingMessages:!1})}},{key:"scrollToBottom",value:function(){this.stickToBottom=!0}},{key:"render",value:function(){var t=this,n=this.props.loading?e.createElement(i.a,{size:24}):null;return e.createElement("div",{ref:function(e){return t.wrapper=e},className:"ph-5 bt-1 bb-1 bc-grey300  ph-12  h-overflow-y h-275"},e.createElement("div",{ref:function(e){return t.chat=e}},e.createElement(r.a,{onEnter:function(e){var n=e.previousPosition;e.currentPosition,e.event,null!==n&&"invisible"!==n&&(t.props.onScrollTop()?(t.stick=!0,t.setState({loadingMessages:!0})):t.setState({loadingMessages:!1}))}}),n,e.createElement(o.a,{resendMessage:this.props.resendMessage,messages:this.props.messages,height:275})))}}])&&a(s.prototype,f),p&&a(s,p),n}(e.Component);t.a=f}).call(this,n("q1tI"))},qinL:function(e,t,n){"use strict";(function(e){var o=n("X7v8"),i=n("lLo4"),r=n("ERGR"),s=n("GlCk"),a=n("UrGD"),l=n("x6O/");function c(e){return(c="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var d=function(t){function n(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t=function(e,t){return!t||"object"!==c(t)&&"function"!==typeof t?p(e):t}(this,f(n).call(this,e)),e.users.each((function(e){App.subscribe(CustomEvents.CHAT_UPDATE+"_"+e.id,(function(){t.forceUpdate()})),l.default.getOlderMessages(e.id)}),0),t.state={activeChat:0},t.setActiveChat=t.setActiveChat.bind(p(t)),t.unsetActiveChat=t.unsetActiveChat.bind(p(t)),t}var d,m,v;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}(n,t),d=n,(m=[{key:"setActiveChat",value:function(e,t){e.preventDefault(),e.stopPropagation(),this.setState({activeChat:t}),l.default.markAsRead(t)}},{key:"unsetActiveChat",value:function(){this.setState({activeChat:null})}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=this;this.props.users.each((function(e){App.unsubscribe(CustomEvents.CHAT_UPDATE+"_"+e.id,(function(){t.forceUpdate()}))}),0),e.users.each((function(e){App.subscribe(CustomEvents.CHAT_UPDATE+"_"+e.id,(function(){t.forceUpdate()}))}),0)}},{key:"componentWillUnmount",value:function(){var e=this;this.props.users.each((function(t){App.unsubscribe(CustomEvents.CHAT_UPDATE+"_"+t.id,(function(){e.forceUpdate()}))}),0)}},{key:"renderNotification",value:function(){var t=this.props.users.reduce((function(e,t){return e+l.default.getUnreadMessages(t.id).length}),0);return t>0?e.createElement("span",{className:"chat-alert"},t):null}},{key:"renderContent",value:function(){var t=this;if(this.state.activeChat){var n=l.default.getChat(this.state.activeChat);return e.createElement(a.a,{messages:n.messages,userID:this.state.activeChat})}var i=this.props.users.map((function(n){var i=n.id,r=l.default.getUnreadMessages(i).length;return{icon:e.createElement(o.a,{className:"mr-8px",unread:r,userId:i,enabled:t.props.enabled}),label:n.name,className:"ellipsis",onClick:function(e){return t.setActiveChat(e,i)}}}));return e.createElement(s.a,{inputClassName:"mh-15 mb-10",filterableAttribute:"label"},e.createElement(r.a,{items:i,closePopoverOnItemClick:!1,className:"minw-200px maxw-320px maxh-300px h-overflow-y"}))}},{key:"render",value:function(){return e.createElement(i.a,{position:"above",canAutoPosition:!1,className:"sections",opener:e.createElement("div",{className:"h-flex-row justify-center s-24 fs-xs b-1 rad-100% bc-grey300 c-grey500 mh-4px h-cp"},this.renderNotification(),"+"+this.props.users.length),onClose:this.unsetActiveChat},this.renderContent())}}])&&u(d.prototype,m),v&&u(d,v),n}(e.Component);t.a=d}).call(this,n("q1tI"))},quyA:function(e,t){var n=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");e.exports=function(e){return n.test(e)}},rJb1:function(e,t,n){"use strict";t.a={get:function(e,t){new Ajax.Request("/user_preferences/"+e,{method:"GET",onSuccess:function(e){t(e.responseJSON)},onFailure:function(){return t(null)}})},save:function(e){new Ajax.Request("/user_preferences",{parameters:e})}}},rW35:function(e,t,n){"use strict";(function(e){function o(e){return(o="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function r(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function a(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}n.d(t,"a",(function(){return c}));var c=function(t){function n(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(t=function(e,t){return!t||"object"!==o(t)&&"function"!==typeof t?a(e):t}(this,s(n).call(this,e))).index=-1,t.renderIndex=0,t.state={allItems:t._getAllItems(t.props.children)},t.unselectAll=t.unselectAll.bind(a(t)),t.onMouseLeave=t.onMouseLeave.bind(a(t)),t.updateSelection=t.updateSelection.bind(a(t)),t.disableKeyMap=t.disableKeyMap.bind(a(t)),t.enableKeyMap=t.enableKeyMap.bind(a(t)),t.onEnter=t.onEnter.bind(a(t)),t.onKeyNavigate=t.onKeyNavigate.bind(a(t)),t}var c,u,f;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(n,t),c=n,(u=[{key:"_getAllItems",value:function(t){var n=this,o=[];return e.Children.forEach(t,(function(e){e.props&&(o=[].concat(i(o),i(e.props.items||[]),i(n._getAllItems(e.props.children))))})),o}},{key:"unselectAll",value:function(){var e=this.state.allItems;return e[this.index]&&(e[this.index].highlighted=!1),e}},{key:"onMouseLeave",value:function(){this.updateSelection(-1)}},{key:"updateSelection",value:function(e){var t=this.unselectAll();this.index=e,t[this.index]&&(t[this.index].highlighted=!0),this.setState({allItems:t})}},{key:"disableKeyMap",value:function(){this.keymap.disable()}},{key:"enableKeyMap",value:function(){this.keymap.enable()}},{key:"onEnter",value:function(e){var t=this.state.allItems[this.index];t&&t.onClick&&(t.onClick(e),document.body.click())}},{key:"onKeyNavigate",value:function(e){var t=this.index+e;t<0&&(t=this.state.allItems.length-1),t>this.state.allItems.length-1&&(t=0),this.updateSelection(t)}},{key:"componentDidMount",value:function(){this.keymap=new MM.utils.KeyMap(document,"component_keymap_"+(new Date).getTime(),[{key:MM.utils.KeyEvent.UP,fn:this.onKeyNavigate.bind(this,-1)},{key:MM.utils.KeyEvent.DOWN,fn:this.onKeyNavigate.bind(this,1)},{key:MM.utils.KeyEvent.ENTER,fn:this.onEnter,withEvent:!0,stopEvent:!1}])}},{key:"UNSAFE_componentWillReceiveProps",value:function(){this.shouldUpdateChildren=!0,this.updateSelection(-1)}},{key:"componentDidUpdate",value:function(){if(this.shouldUpdateChildren){var e=this._getAllItems(this.props.children);e[this.index]&&(e[this.index].highlighted=!0),this.setState({allItems:e}),this.shouldUpdateChildren=!1}}},{key:"componentWillUnmount",value:function(){this.keymap.disable(),this.keymap=null,this.updateSelection(-1)}},{key:"renderChildren",value:function(t){var n=this;return e.Children.map(t,(function(t){var o={};if(t.props.items){var i=n.state.allItems.slice(n.renderIndex,n.renderIndex+t.props.items.length),r=n.renderIndex;n.renderIndex=n.renderIndex+t.props.items.length,o={key:r,items:i,indexStart:r,onMouseEnter:n.updateSelection,onMouseLeave:n.onMouseLeave,disableParentKeyMap:n.disableKeyMap,enableParentKeyMap:n.enableKeyMap}}return o.children=n.renderChildren(t.props.children),e.cloneElement(t,o)}))}},{key:"render",value:function(){return this.renderIndex=0,e.createElement("div",{className:this.props.className},this.renderChildren(this.props.children,this.renderIndex))}}])&&r(c.prototype,u),f&&r(c,f),n}(e.Component)}).call(this,n("q1tI"))},s7eh:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var o=/(auto|scroll)/,i=function(e,t){return window.getComputedStyle(e,null).getPropertyValue(t)},r=function(e){return o.test(function(e){return i(e,"overflow")+i(e,"overflow-y")}(e))}},tLB3:function(e,t,n){var o=n("GoyQ"),i=n("/9aa"),r=NaN,s=/^\s+|\s+$/g,a=/^[-+]0x[0-9a-f]+$/i,l=/^0b[01]+$/i,c=/^0o[0-7]+$/i,u=parseInt;e.exports=function(e){if("number"==typeof e)return e;if(i(e))return r;if(o(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=o(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(s,"");var n=l.test(e);return n||c.test(e)?u(e.slice(2),n?2:8):a.test(e)?r:+e}},"ut/Y":function(e,t,n){function o(e){return(o="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var i=n("ZCpW"),r=n("GDhZ"),s=n("zZ0H"),a=n("Z0cm"),l=n("+c4W");e.exports=function(e){return"function"==typeof e?e:null==e?s:"object"==o(e)?a(e)?r(e[0],e[1]):i(e):l(e)}},uvak:function(e,t,n){"use strict";n.r(t),n.d(t,"Point",(function(){return o})),n.d(t,"Line",(function(){return i})),n.d(t,"Rectangle",(function(){return r})),Object.extend(Math,{constrain:function(e,t,n){return e>n?n:e<t?t:e},slopeAngle:function(e){var t=e[0],n=-e[1],o=Math.atan(n/t);return t<0&&n>=0?o+=Math.PI:t<0&&n<0?o+=Math.PI:t>0&&n<0&&(o+=2*Math.PI),180/Math.PI*o},sqr:function(e){return e*e},diagonal:function(e){return parseInt(Math.sqrt(Math.sqr(e[0])+Math.sqr(e[1])))},offset:function(e,t){return[e[0]+t[0],e[1]+t[1]]},negativeOffset:function(e,t){return[e[0]-t[0],e[1]-t[1]]}});var o=Class.create({x:null,y:null,initialize:function(e,t){this.x="number"==typeof e?e:e[0],this.y="number"==typeof e?t:e[1],this.validate()},doOffset:function(e){this.x+=e.x,this.y+=e.y,this.validate()},validate:function(){var e=!1,t="";("number"!=typeof this.x||isNaN(this.x))&&(e=!0,t+=" x was not valid: "+this.x,this.x=100),("number"!=typeof this.y||isNaN(this.y))&&(e=!0,t+=" y was not valid: "+this.y,this.y=100),e&&MM.error.reportException({message:"Point validity failed: ".concat(t)})},getOffsetWith:function(e){return new o(this.x+e.x,this.y+e.y)},getOffsetFrom:function(e){return new o(this.x-e.x,this.y-e.y)},toArray:function(){return[this.x,this.y]},equals:function(e){return this.x==e.x&&this.y==e.y},toString:function(){return[this.x,this.y].toString()}});o.isValid=function(e){return!!e&&"number"==typeof e[0]&&!isNaN(e[0])&&"number"==typeof e[1]&&!isNaN(e[1])};var i=Class.create({p1:null,p2:null,initialize:function(e,t){this.p1=e,this.p2=t instanceof o?t:null==t?new o(this.p1.x,this.p1.y-1):new o(this.p1.x+1,this.p1.y+t)},length:function(){return Math.sqrt(Math.sqr(this.p1.x-this.p2.x)+Math.sqr(this.p1.y-this.p2.y))},slope:function(){return this.p2.x==this.p1.x?null:(this.p2.y-this.p1.y)/(this.p2.x-this.p1.x)},angle:function(){return Math.atan2(this.p2.y-this.p1.y,this.p2.x-this.p1.x)},intersection:function(e){var t,n,i=this.slope(),r=e.slope();if(i==r)return null;if(null!=i)null!=r?n=i*((t=(i*this.p1.x-r*e.p1.x-this.p1.y+e.p1.y)/(i-r))-this.p1.x)+this.p1.y:(t=e.p1.x,n=i*(e.p1.x-this.p1.x)+this.p1.y);else{if(null==r)return null;t=this.p1.x,n=r*(this.p1.x-e.p1.x)+e.p1.y}return new o(t,n)},onOppositeSides:function(e,t){var n=new i(e,t),o=this.intersection(n);return!o||n.isOnSegment(o)},isOnSegment:function(e){return[this.p1.x,this.p2.x].max()>=e.x-.02&&e.x>=[this.p1.x,this.p2.x].min()-.02&&[this.p1.y,this.p2.y].max()>=e.y-.02&&e.y>=[this.p1.y,this.p2.y].min()-.02},toString:function(){return[this.p1,this.p2].toString()},pointsAtDistance:function(e,t){var n=this.slope();if(null==n)return[new o(e.x,e.y-t),new o(e.x,e.y+t)];var i=t/Math.sqrt(1+Math.sqr(n));return[new o(e.x+i,e.y+n*i),new o(e.x-i,e.y-n*i)]},pointsAtInterval:function(e){for(var t,n=this.angle(),i=Math.cos(n),r=Math.sin(n),s=this.length(),a=0,l=[];a+e<s;)t=new o(i*(a+=e)+this.p1.x,r*a+this.p1.y),l.push(t);return l}}),r=Class.create({p1:null,p2:null,initialize:function(e,t){this.p1=e||new o(0,0),this.p2=t||new o(0,0)},isValid:function(){return this.p1.x<this.p2.x&&this.p1.y<this.p2.y},move:function(e){this.p2=this.size(),this.p2.doOffset(e),this.p1=e},shift:function(e){this.p1.doOffset(e),this.p2.doOffset(e)},mirror:function(){var e=this.p1;this.p1=this.p2,this.p2=e},size:function(){return new o(Math.abs(this.p2.x-this.p1.x),Math.abs(this.p2.y-this.p1.y))},dimensions:function(){return{width:Math.abs(this.p1.x-this.p2.x),height:Math.abs(this.p1.y-this.p2.y)}},center:function(){return new o(parseInt((this.p2.x+this.p1.x)/2),parseInt((this.p2.y+this.p1.y)/2))},within:function(e){return e.x>=this.p1.x&&e.x<=this.p2.x&&e.y>=this.p1.y&&e.y<=this.p2.y},intersection:function(e){var t=[],n=null;return this.sides().each((function(o){(n=e.intersection(o))&&o.isOnSegment(n)&&t.push(n)})),t},radialIntersection:function(e){var t=new i(e,this.center()),n=null;return this.sides().each((function(e){if((n=t.intersection(e))&&t.isOnSegment(n)&&e.isOnSegment(n))throw $break})),n},coords:function(){return[new o(this.p1.x,this.p1.y),new o(this.p2.x,this.p1.y),new o(this.p2.x,this.p2.y),new o(this.p1.x,this.p2.y)]},sides:function(){var e=this.coords();return[new i(e[0],e[1]),new i(e[1],e[2]),new i(e[2],e[3]),new i(e[3],e[0])]},overlaps:function(e){return!(this.p2.x<e.p1.x||this.p1.x>e.p2.x||this.p2.y<e.p1.y||this.p1.y>e.p2.y)},toString:function(){return[this.p1,this.p2].toString()},enlarge:function(e){this.p1.x-=e,this.p1.y-=e,this.p2.x+=e,this.p2.y+=e},addPadding:function(e){this.p1.x-=e.left||0,this.p1.y-=e.top||0,this.p2.x+=e.right||0,this.p2.y+=e.bottom||0}});r.fromPosSize=function(e,t){return new r(e,e.getOffsetWith(t))},r.max=function(e,t){return new r(new o(Math.min(e.p1.x,t.p1.x),Math.min(e.p1.y,t.p1.y)),new o(Math.max(e.p2.x,t.p2.x),Math.max(e.p2.y,t.p2.y)))}},wNWC:function(e,t,n){"use strict";n.r(t);var o=0,i=function(e){e.stop();var t=new Date;setTimeout((function(){t-o>100&&canvas.onRecenter(e,!0)}),100)},r=function(e){e.stop(),o=new Date,App.ui.Zoom.zoomTo(App.ui.Zoom.getZoomIndex(1),!0),canvas.onRecenter(e,!0)},s={elId:"map_options",init:function(e){if(this.el=$(this.elId),this.el){Element.bindOnClick("btn_zoomin",e.zoomIn),Element.bindOnClick("btn_zoomout",e.zoomOut);var t=mm$("btn_recenter");t.onclick=i,t.ondblclick=r,hasClassName(this.el,"no-viewport")||(this.viewportSpace={left:this.el.getWidth()+this.el.offsetLeft}),MM.ui.ToolTips.touchSafe({el:this.el,classes:"maxw-175px"}),UI.Registry.add(this),UI.Registry.notify(this,"show")}},show:function(e){CSS.set(this.el,{left:"20px",transitionDuration:e?"500ms":"0ms"}),UI.Registry.notify(this,"show")},hide:function(e){CSS.set(this.el,{left:-this.el.getWidth()+"px",transitionDuration:e?"500ms":"0ms"}),UI.Registry.notify(this,"hide")}};t.default=s},wOJ8:function(e,t){function n(){}n.prototype={on:function(e,t,n){var o=this.e||(this.e={});return(o[e]||(o[e]=[])).push({fn:t,ctx:n}),this},once:function(e,t,n){var o=this;function i(){o.off(e,i),t.apply(n,arguments)}return i._=t,this.on(e,i,n)},emit:function(e){for(var t=[].slice.call(arguments,1),n=((this.e||(this.e={}))[e]||[]).slice(),o=0,i=n.length;o<i;o++)n[o].fn.apply(n[o].ctx,t);return this},off:function(e,t){var n=this.e||(this.e={}),o=n[e],i=[];if(o&&t)for(var r=0,s=o.length;r<s;r++)o[r].fn!==t&&o[r].fn._!==t&&i.push(o[r]);return i.length?n[e]=i:delete n[e],this}},e.exports=n,e.exports.TinyEmitter=n},wy8a:function(e,t,n){var o=n("KxBF");e.exports=function(e,t,n){var i=e.length;return n=void 0===n?i:n,!t&&n>=i?e:o(e,t,n)}},"x6O/":function(e,t,n){"use strict";n.r(t);var o=n("UfWW"),i=n.n(o),r=n("/Fw/"),s=n.n(r),a=Class.create({initialize:function(){this.chats={}},getChat:function(e){var t=this.chats[e];return t||(t={messages:[],olderMessagesLoaded:!1,notifyObservers:function(e){App.trigger(CustomEvents.CHAT_UPDATE+"_"+e)},loading:!1},this.chats[e]=t),t},send:function(e,t){var n=this.chats[t];e.failed||this.push(e,t),new Ajax.Request("/chat_messages",{parameters:{target_id:t,text:e.text,map_id:App.config.map_id,timestamp:ServerConnection.timestamp},onSuccess:function(t){var n=t.responseJSON;e.timestamp=n.timestamp,e.id=n.chat.id,e.failed=!1},onFailure:function(o){e.failed=!0,n.notifyObservers(t)}})},push:function(e,t){var n=this.getChat(t),o=n.messages;-1===i()(o,(function(t){return!!e.id&&(t.id===e.id&&!t.failed)}))&&(o.push(e),n.notifyObservers(t))},getUnreadMessages:function(e){return this.getChat(e).messages.filter((function(e){return!e.received&&e.user_id!==users.selfUser.id}))},markAsRead:function(e){var t=[],n=this.getChat(e);n.messages=n.messages.map((function(e){return e.received||e.user_id===users.selfUser.id||(e.received=!0,t.push(e.id)),e})),new Ajax.Request("/chat_messages/read/",{method:"post",contentType:"application/json",parameters:JSON.stringify({ids:t})}),n.notifyObservers(e)},receive:function(e){e.target_id?this.push(e,e.user_id):this.push(e),this.postBrowserNotification(e)},getOlderMessages:function(e){var t=this.getChat(e),n=t.messages,o=null;return!t.olderMessagesLoaded&&(n[0]&&(o=n[0].timestamp),t.loading=!0,new Ajax.Request("/chat_messages",{method:"get",parameters:{older_than:o,map_id:App.config.map_id,target_id:e},onSuccess:function(o){var i=o.responseJSON;t.loading=!1,t.messages=i.messages.concat(n),i.messages.length<25&&(t.olderMessagesLoaded=!0),t.notifyObservers(e)}}),!0)},postBrowserNotification:function(e){if(window.Notification&&"denied"!==Notification.permission){var t=users.findByID(e.user_id);if(!t)return;if(e.user_id===users.selfUser.id)return;Notification.requestPermission((function(n){new Notification(t.name,{body:e.text,icon:s.a})}))}}});t.default=new a},yLpj:function(e,t){function n(e){return(n="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var o;o=function(){return this}();try{o=o||new Function("return this")()}catch(i){"object"===("undefined"===typeof window?"undefined":n(window))&&(o=window)}e.exports=o},zZ0H:function(e,t){e.exports=function(e){return e}},zoYe:function(e,t,n){var o=n("nmnc"),i=n("eUgh"),r=n("Z0cm"),s=n("/9aa"),a=1/0,l=o?o.prototype:void 0,c=l?l.toString:void 0;e.exports=function e(t){if("string"==typeof t)return t;if(r(t))return i(t,e)+"";if(s(t))return c?c.call(t):"";var n=t+"";return"0"==n&&1/t==-a?"-0":n}}},[["jRMI",5,0,1]]]);